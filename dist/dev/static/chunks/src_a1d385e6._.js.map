{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/UYI/Downloads/Journey/journey/src/lib/supabase.ts"],"sourcesContent":["import { createClient } from '@supabase/supabase-js';\r\n\r\nconst supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL || 'https://your-project.supabase.co';\r\nconst supabaseAnonKey = process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY || 'your-anon-key';\r\n\r\nexport const supabase = createClient(supabaseUrl, supabaseAnonKey, {\r\n  auth: {\r\n    autoRefreshToken: true,\r\n    persistSession: true,\r\n    detectSessionInUrl: true,\r\n    flowType: 'pkce', // Recommended for web apps\r\n  },\r\n  realtime: {\r\n    params: {\r\n      eventsPerSecond: 10,\r\n    },\r\n  },\r\n});\r\n\r\n// For server-side operations\r\nconst serviceRoleKey = process.env.SUPABASE_SERVICE_ROLE_KEY;\r\n\r\nexport const supabaseAdmin = serviceRoleKey \r\n  ? createClient(supabaseUrl, serviceRoleKey, {\r\n      auth: {\r\n        autoRefreshToken: false,\r\n        persistSession: false,\r\n      },\r\n      realtime: {\r\n        params: {\r\n          eventsPerSecond: 10,\r\n        },\r\n      },\r\n    })\r\n  : null;\r\n"],"names":[],"mappings":";;;;;;AAEoB;AAFpB;;AAEA,MAAM,cAAc,gFAAwC;AAC5D,MAAM,kBAAkB,wPAA6C;AAE9D,MAAM,WAAW,IAAA,0LAAY,EAAC,aAAa,iBAAiB;IACjE,MAAM;QACJ,kBAAkB;QAClB,gBAAgB;QAChB,oBAAoB;QACpB,UAAU;IACZ;IACA,UAAU;QACR,QAAQ;YACN,iBAAiB;QACnB;IACF;AACF;AAEA,6BAA6B;AAC7B,MAAM,iBAAiB,2KAAO,CAAC,GAAG,CAAC,yBAAyB;AAErD,MAAM,gBAAgB,iBACzB,IAAA,0LAAY,EAAC,aAAa,gBAAgB;IACxC,MAAM;QACJ,kBAAkB;QAClB,gBAAgB;IAClB;IACA,UAAU;QACR,QAAQ;YACN,iBAAiB;QACnB;IACF;AACF,KACA"}},
    {"offset": {"line": 48, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/UYI/Downloads/Journey/journey/src/services/supabaseService.ts"],"sourcesContent":["import { supabase } from '@/lib/supabase';\r\nimport { User, Session } from '@supabase/supabase-js';\r\nimport { RealtimeChannel } from '@supabase/supabase-js';\r\n\r\n// Add getClient method for the achievement service\r\nexport const supabaseClient = supabase;\r\n\r\nexport interface UserProfile {\r\n  id: string;\r\n  username: string;\r\n  email: string;\r\n  full_name: string;\r\n  avatar_url?: string;\r\n  points: number;\r\n  level: number;\r\n  streak: number;\r\n  longest_streak: number;\r\n  status: 'active' | 'inactive' | 'suspended';\r\n  created_at: string;\r\n  updated_at: string;\r\n}\r\n\r\nexport interface UserStats {\r\n  id: string;\r\n  user_id: string;\r\n  verses_read: number;\r\n  chapters_completed: number;\r\n  devotionals_created: number;\r\n  prayers_shared: number;\r\n  friends_count: number;\r\n  reading_time_minutes: number;\r\n  community_posts: number;\r\n  reading_plans_started: number;\r\n  reading_plans_completed: number;\r\n  created_at: string;\r\n  updated_at: string;\r\n}\r\n\r\nexport interface UserAchievement {\r\n  id: string;\r\n  user_id: string;\r\n  achievement_id: string;\r\n  unlocked_at: string;\r\n  points_awarded: number;\r\n  achievement?: any;\r\n}\r\n\r\nclass SupabaseService {\r\n  private channels: Map<string, RealtimeChannel> = new Map();\r\n\r\n  // Helper method to get supabase client\r\n  getClient() {\r\n    return supabase;\r\n  }\r\n\r\n  // Authentication\r\n  async getCurrentUser(): Promise<User | null> {\r\n    const { data: { user } } = await supabase.auth.getUser();\r\n    return user;\r\n  }\r\n\r\n  async getCurrentSession(): Promise<Session | null> {\r\n    const { data: { session } } = await supabase.auth.getSession();\r\n    return session;\r\n  }\r\n\r\n  // User Profile Management\r\n  async getUserProfile(userId: string): Promise<UserProfile | null> {\r\n    const { data, error } = await supabase\r\n      .from('users')\r\n      .select('*')\r\n      .eq('id', userId)\r\n      .single();\r\n\r\n    if (error) {\r\n      console.error('Error fetching user profile:', error);\r\n      return null;\r\n    }\r\n\r\n    return data;\r\n  }\r\n\r\n  async updateUserProfile(userId: string, updates: Partial<UserProfile>): Promise<UserProfile | null> {\r\n    try {\r\n      const { data, error } = await supabase\r\n        .from('users')\r\n        .update(updates)\r\n        .eq('id', userId)\r\n        .select()\r\n        .single();\r\n\r\n      if (error) {\r\n        console.error('Error updating user profile:', {\r\n          error: error,\r\n          message: error.message,\r\n          details: error.details,\r\n          hint: error.hint,\r\n          code: error.code,\r\n          userId: userId,\r\n          updates: updates\r\n        });\r\n        return null;\r\n      }\r\n\r\n      return data;\r\n    } catch (err) {\r\n      console.error('Unexpected error in updateUserProfile:', err);\r\n      return null;\r\n    }\r\n  }\r\n\r\n  async createUserProfile(user: User, additionalData?: { username?: string; full_name?: string }): Promise<UserProfile | null> {\r\n    const profileData = {\r\n      id: user.id,\r\n      email: user.email || '',\r\n      username: additionalData?.username || user.email?.split('@')[0] || 'user',\r\n      full_name: additionalData?.full_name || user.user_metadata?.full_name || '',\r\n      avatar_url: user.user_metadata?.avatar_url || '',\r\n      points: 0,\r\n      level: 1,\r\n      streak: 0,\r\n      longest_streak: 0,\r\n      status: 'active' as const,\r\n    };\r\n\r\n    try {\r\n      const { data, error } = await supabase\r\n        .from('users')\r\n        .insert(profileData)\r\n        .select()\r\n        .single();\r\n\r\n      if (error) {\r\n        console.error('Error creating user profile:', error);\r\n        \r\n        // If username column doesn't exist, try without it\r\n        if (error.message.includes('column') && error.message.includes('username')) {\r\n          const { data: dataWithoutUsername, error: errorWithoutUsername } = await supabase\r\n            .from('users')\r\n            .insert({\r\n              id: profileData.id,\r\n              email: profileData.email,\r\n              full_name: profileData.full_name,\r\n              avatar_url: profileData.avatar_url,\r\n              points: profileData.points,\r\n              level: profileData.level,\r\n              streak: profileData.streak,\r\n              longest_streak: profileData.longest_streak,\r\n              status: profileData.status,\r\n            })\r\n            .select()\r\n            .single();\r\n            \r\n          if (errorWithoutUsername) {\r\n            console.error('Error creating user profile without username:', errorWithoutUsername);\r\n            return null;\r\n          }\r\n          \r\n          // Create user stats\r\n          await this.createUserStats(user.id);\r\n          return dataWithoutUsername;\r\n        }\r\n        \r\n        return null;\r\n      }\r\n\r\n      // Create user stats\r\n      await this.createUserStats(user.id);\r\n      return data;\r\n    } catch (error) {\r\n      console.error('Error creating user profile:', error);\r\n      return null;\r\n    }\r\n  }\r\n\r\n  // User Stats Management\r\n  async getUserStats(userId: string): Promise<UserStats | null> {\r\n    const { data, error } = await supabase\r\n      .from('user_stats')\r\n      .select('*')\r\n      .eq('user_id', userId)\r\n      .single();\r\n\r\n    if (error) {\r\n      console.error('Error fetching user stats:', error);\r\n      return null;\r\n    }\r\n\r\n    return data;\r\n  }\r\n\r\n  async updateUserStats(userId: string, updates: Partial<UserStats>): Promise<UserStats | null> {\r\n    const { data, error } = await supabase\r\n      .from('user_stats')\r\n      .update(updates)\r\n      .eq('user_id', userId)\r\n      .select()\r\n      .single();\r\n\r\n    if (error) {\r\n      console.error('Error updating user stats:', error);\r\n      return null;\r\n    }\r\n\r\n    return data;\r\n  }\r\n\r\n  private async createUserStats(userId: string): Promise<UserStats | null> {\r\n    const statsData = {\r\n      user_id: userId,\r\n      verses_read: 0,\r\n      chapters_completed: 0,\r\n      devotionals_created: 0,\r\n      prayers_shared: 0,\r\n      friends_count: 0,\r\n      reading_time_minutes: 0,\r\n    };\r\n\r\n    const { data, error } = await supabase\r\n      .from('user_stats')\r\n      .insert(statsData)\r\n      .select()\r\n      .single();\r\n\r\n    if (error) {\r\n      console.error('Error creating user stats:', error);\r\n      return null;\r\n    }\r\n\r\n    return data;\r\n  }\r\n\r\n  // Points and Level Management\r\n  async addPoints(userId: string, points: number): Promise<UserProfile | null> {\r\n    try {\r\n      // Get current user profile\r\n      const profile = await this.getUserProfile(userId);\r\n      if (!profile) {\r\n        console.error('User profile not found for userId:', userId);\r\n        return null;\r\n      }\r\n\r\n      // Calculate new points and level\r\n      const newPoints = profile.points + points;\r\n      const newLevel = Math.floor(newPoints / 1000) + 1;\r\n\r\n      // Update profile with better error handling\r\n      const { data, error } = await supabase\r\n        .from('users')\r\n        .update({\r\n          points: newPoints,\r\n          level: newLevel,\r\n          updated_at: new Date().toISOString()\r\n        })\r\n        .eq('id', userId)\r\n        .select()\r\n        .single();\r\n\r\n      if (error) {\r\n        console.error('Error updating user profile:', {\r\n          error: error,\r\n          message: error.message,\r\n          details: error.details,\r\n          hint: error.hint,\r\n          code: error.code,\r\n          userId: userId,\r\n          newPoints: newPoints,\r\n          newLevel: newLevel\r\n        });\r\n        return null;\r\n      }\r\n\r\n      return data;\r\n    } catch (err) {\r\n      console.error('Unexpected error in addPoints:', err);\r\n      return null;\r\n    }\r\n  }\r\n\r\n  async updateStreak(userId: string, streak: number): Promise<UserProfile | null> {\r\n    const profile = await this.getUserProfile(userId);\r\n    if (!profile) return null;\r\n\r\n    // Update longest streak if current streak exceeds it\r\n    const newLongestStreak = Math.max(profile.longest_streak, streak);\r\n\r\n    return await this.updateUserProfile(userId, { \r\n      streak, \r\n      longest_streak: newLongestStreak \r\n    });\r\n  }\r\n\r\n  // Reading Progress\r\n  async updateReadingProgress(userId: string, book: string, chapter: number, versesRead: number = 1): Promise<UserStats | null> {\r\n    const stats = await this.getUserStats(userId);\r\n    if (!stats) return null;\r\n\r\n    return await this.updateUserStats(userId, {\r\n      verses_read: stats.verses_read + versesRead,\r\n      chapters_completed: stats.chapters_completed + (versesRead > 0 ? 1 : 0),\r\n    });\r\n  }\r\n\r\n  // Devotional Activities\r\n  async createDevotional(userId: string): Promise<UserStats | null> {\r\n    const stats = await this.getUserStats(userId);\r\n    if (!stats) return null;\r\n\r\n    return await this.updateUserStats(userId, {\r\n      devotionals_created: stats.devotionals_created + 1,\r\n    });\r\n  }\r\n\r\n  // Real Devotional Creation\r\n  async createDevotionalContent(userId: string, devotionalData: {\r\n    title: string;\r\n    content: string;\r\n    verse_reference?: string;\r\n    verse_text?: string;\r\n    author_name?: string;\r\n    tags?: string[];\r\n    is_public?: boolean;\r\n  }): Promise<any> {\r\n    try {\r\n      // Check if user is authenticated\r\n      const { data: authData } = await this.getClient().auth.getUser();\r\n      console.log('Auth check:', authData);\r\n      \r\n      if (!authData.user) {\r\n        console.error('User not authenticated');\r\n        return null;\r\n      }\r\n\r\n      console.log('Creating devotional with data:', {\r\n        userId,\r\n        devotionalData\r\n      });\r\n\r\n      const { data, error } = await this.getClient()\r\n        .from('devotionals')\r\n        .insert({\r\n          user_id: userId,\r\n          title: devotionalData.title,\r\n          content: devotionalData.content,\r\n          verse_reference: devotionalData.verse_reference,\r\n          verse_text: devotionalData.verse_text,\r\n          author_name: devotionalData.author_name || 'Anonymous',\r\n          tags: devotionalData.tags || [],\r\n          is_public: devotionalData.is_public !== false,\r\n        })\r\n        .select()\r\n        .single();\r\n\r\n      console.log('Supabase response:', { data, error });\r\n\r\n      if (error) {\r\n        console.error('Error creating devotional:', {\r\n          message: error.message,\r\n          details: error.details,\r\n          hint: error.hint,\r\n          code: error.code\r\n        });\r\n        return null;\r\n      }\r\n\r\n      // Award points for creating devotional\r\n      await this.addPoints(userId, 20); // 20 points for creating a devotional\r\n      await this.createDevotional(userId);\r\n\r\n      return data;\r\n    } catch (error) {\r\n      console.error('Error creating devotional (catch):', {\r\n        error: error,\r\n        message: error instanceof Error ? error.message : 'Unknown error',\r\n        stack: error instanceof Error ? error.stack : undefined\r\n      });\r\n      return null;\r\n    }\r\n  }\r\n\r\n  // Reading Plan Creation\r\n  async createReadingPlan(userId: string, planData: {\r\n    title: string;\r\n    description?: string;\r\n    duration: number;\r\n    difficulty?: 'beginner' | 'intermediate' | 'advanced';\r\n    category?: string;\r\n    verses_per_day?: number;\r\n    is_public?: boolean;\r\n  }): Promise<any> {\r\n    try {\r\n      const { data, error } = await this.getClient()\r\n        .from('reading_plans')\r\n        .insert({\r\n          user_id: userId,\r\n          title: planData.title,\r\n          description: planData.description,\r\n          duration: planData.duration,\r\n          difficulty: planData.difficulty || 'beginner',\r\n          category: planData.category,\r\n          verses_per_day: planData.verses_per_day || 3,\r\n          is_public: planData.is_public !== false,\r\n        })\r\n        .select()\r\n        .single();\r\n\r\n      if (error) {\r\n        console.error('Error creating reading plan:', error);\r\n        return null;\r\n      }\r\n\r\n      // Award points for creating reading plan\r\n      await this.addPoints(userId, 15); // 15 points for creating a reading plan\r\n\r\n      return data;\r\n    } catch (error) {\r\n      console.error('Error creating reading plan:', error);\r\n      return null;\r\n    }\r\n  }\r\n\r\n  // Start Reading Plan\r\n  async startReadingPlan(userId: string, planId: string): Promise<any> {\r\n    try {\r\n      const { data, error } = await this.getClient()\r\n        .from('user_reading_plans')\r\n        .insert({\r\n          user_id: userId,\r\n          plan_id: planId,\r\n          started_at: new Date().toISOString(),\r\n          current_day: 1,\r\n          is_active: true,\r\n        })\r\n        .select()\r\n        .single();\r\n\r\n      if (error) {\r\n        console.error('Error starting reading plan:', error);\r\n        return null;\r\n      }\r\n\r\n      // Award points for starting a reading plan\r\n      await this.addPoints(userId, 5); // 5 points for starting a plan\r\n\r\n      return data;\r\n    } catch (error) {\r\n      console.error('Error starting reading plan:', error);\r\n      return null;\r\n    }\r\n  }\r\n\r\n  // Prayer Activities\r\n  async sharePrayer(userId: string): Promise<UserStats | null> {\r\n    const stats = await this.getUserStats(userId);\r\n    if (!stats) return null;\r\n\r\n    return await this.updateUserStats(userId, {\r\n      prayers_shared: stats.prayers_shared + 1,\r\n    });\r\n  }\r\n\r\n  // Reading Time\r\n  async addReadingTime(userId: string, minutes: number): Promise<UserStats | null> {\r\n    const stats = await this.getUserStats(userId);\r\n    if (!stats) return null;\r\n\r\n    return await this.updateUserStats(userId, {\r\n      reading_time_minutes: stats.reading_time_minutes + minutes,\r\n    });\r\n  }\r\n\r\n  // User Achievements\r\n  async getUserAchievements(userId: string): Promise<UserAchievement[]> {\r\n    try {\r\n      // First get user achievements\r\n      const { data: userAchievements, error: userAchievementsError } = await this.getClient()\r\n        .from('user_achievements')\r\n        .select('*')\r\n        .eq('user_id', userId);\r\n\r\n      if (userAchievementsError) {\r\n        console.error('Error fetching user achievements:', userAchievementsError);\r\n        return [];\r\n      }\r\n\r\n      if (!userAchievements || userAchievements.length === 0) {\r\n        return [];\r\n      }\r\n\r\n      // Then get achievement details from local data\r\n      const { achievements } = await import('@/data/achievements');\r\n      const achievementIds = userAchievements.map((ua: any) => ua.achievement_id);\r\n      const achievementMap = new Map(achievements.map((a: any) => [a.id, a]));\r\n      \r\n      return userAchievements.map((ua: any) => ({\r\n        id: ua.id,\r\n        user_id: ua.user_id,\r\n        achievement_id: ua.achievement_id,\r\n        unlocked_at: ua.unlocked_at,\r\n        points_awarded: ua.points_awarded,\r\n        achievement: achievementMap.get(ua.achievement_id) || null,\r\n      }));\r\n    } catch (error) {\r\n      console.error('Error in getUserAchievements:', error);\r\n      return [];\r\n    }\r\n  }\r\n\r\n  async unlockAchievement(userId: string, achievementId: string): Promise<boolean> {\r\n    try {\r\n      // Check if achievement is already unlocked\r\n      const { data: existing } = await this.getClient()\r\n        .from('user_achievements')\r\n        .select('id')\r\n        .eq('user_id', userId)\r\n        .eq('achievement_id', achievementId)\r\n        .maybeSingle();\r\n\r\n      if (existing) {\r\n        // Achievement already unlocked, no need to insert again\r\n        return true;\r\n      }\r\n\r\n      // Insert new achievement\r\n      const { error } = await this.getClient()\r\n        .from('user_achievements')\r\n        .insert({\r\n          user_id: userId,\r\n          achievement_id: achievementId,\r\n          unlocked_at: new Date().toISOString(),\r\n        });\r\n\r\n      if (error) {\r\n        console.error('Error unlocking achievement:', error);\r\n        return false;\r\n      }\r\n\r\n      return true;\r\n    } catch (error) {\r\n      console.error('Error unlocking achievement:', error);\r\n      return false;\r\n    }\r\n  }\r\n\r\n  // Leaderboard methods\r\n  async getLeaderboard(limit: number = 50): Promise<UserProfile[]> {\r\n    try {\r\n      console.log('Fetching leaderboard data from optimized table...');\r\n      \r\n      const { data, error } = await supabase\r\n        .from('leaderboard_view')\r\n        .select('*')\r\n        .order('rank_position', { ascending: true })\r\n        .limit(limit);\r\n\r\n      console.log('Leaderboard query result:', { data, error, count: data?.length });\r\n\r\n      if (error) throw error;\r\n      \r\n      // Transform to UserProfile format\r\n      return data?.map(user => ({\r\n        id: user.user_id,\r\n        username: user.username,\r\n        email: user.email,\r\n        full_name: user.full_name,\r\n        avatar_url: user.avatar_url,\r\n        points: user.total_points,\r\n        level: user.level,\r\n        streak: user.streak,\r\n        longest_streak: user.longest_streak,\r\n        status: 'active' as const,\r\n        created_at: user.user_created_at,\r\n        updated_at: user.updated_at,\r\n      })) || [];\r\n    } catch (error) {\r\n      console.error('Error fetching leaderboard:', error);\r\n      // Fallback to original users table\r\n      return this.getLeaderboardFallback(limit);\r\n    }\r\n  }\r\n\r\n  private async getLeaderboardFallback(limit: number = 50): Promise<UserProfile[]> {\r\n    try {\r\n      console.log('Using fallback leaderboard query...');\r\n      \r\n      // First try with status filter, then fallback without it\r\n      let query = supabase.from('users').select('*');\r\n      \r\n      try {\r\n        query = query.eq('status', 'active');\r\n      } catch (statusError) {\r\n        console.log('Status column might not exist, skipping status filter');\r\n        // Continue without status filter\r\n      }\r\n      \r\n      const { data, error } = await query\r\n        .order('points', { ascending: false })\r\n        .limit(limit);\r\n      \r\n      console.log('Fallback leaderboard query result:', { data, error, count: data?.length });\r\n      \r\n      if (error) throw error;\r\n      return data || [];\r\n    } catch (fallbackError) {\r\n      console.error('Fallback query also failed:', fallbackError);\r\n      return [];\r\n    }\r\n  }\r\n\r\n  async getWeeklyLeaderboard(limit: number = 50): Promise<UserProfile[]> {\r\n    try {\r\n      console.log('Fetching weekly leaderboard data from optimized table...');\r\n      \r\n      const { data, error } = await supabase\r\n        .from('leaderboard')\r\n        .select('*')\r\n        .order('weekly_points', { ascending: false })\r\n        .limit(limit);\r\n\r\n      console.log('Weekly leaderboard query result:', { data, error, count: data?.length });\r\n\r\n      if (error) throw error;\r\n      \r\n      // Transform to UserProfile format\r\n      return data?.map(user => ({\r\n        id: user.user_id,\r\n        username: user.username,\r\n        email: '',\r\n        full_name: '',\r\n        avatar_url: user.avatar_url,\r\n        points: user.weekly_points, // Use weekly points\r\n        level: user.level,\r\n        streak: user.streak,\r\n        longest_streak: user.longest_streak,\r\n        status: 'active' as const,\r\n        created_at: user.created_at,\r\n        updated_at: user.updated_at,\r\n      })) || [];\r\n    } catch (error) {\r\n      console.error('Error fetching weekly leaderboard:', error);\r\n      // Fallback to original method\r\n      return this.getWeeklyLeaderboardFallback(limit);\r\n    }\r\n  }\r\n\r\n  private async getWeeklyLeaderboardFallback(limit: number = 50): Promise<UserProfile[]> {\r\n    try {\r\n      console.log('Using fallback weekly leaderboard query...');\r\n      // Get users with their points from the last 7 days\r\n      const sevenDaysAgo = new Date();\r\n      sevenDaysAgo.setDate(sevenDaysAgo.getDate() - 7);\r\n      \r\n      // First try with status filter, then fallback without it\r\n      let query = supabase\r\n        .from('users')\r\n        .select('*')\r\n        .gte('updated_at', sevenDaysAgo.toISOString());\r\n      \r\n      try {\r\n        query = query.eq('status', 'active');\r\n      } catch (statusError) {\r\n        console.log('Status column might not exist, skipping status filter for weekly leaderboard');\r\n        // Continue without status filter\r\n      }\r\n      \r\n      const { data, error } = await query\r\n        .order('points', { ascending: false })\r\n        .limit(limit);\r\n\r\n      console.log('Fallback weekly leaderboard query result:', { data, error, count: data?.length });\r\n\r\n      if (error) throw error;\r\n      return data || [];\r\n    } catch (fallbackError) {\r\n      console.error('Fallback weekly query also failed:', fallbackError);\r\n      return [];\r\n    }\r\n  }\r\n\r\n  async getStreakLeaderboard(limit: number = 50): Promise<UserProfile[]> {\r\n    try {\r\n      console.log('Fetching streak leaderboard data from optimized table...');\r\n      \r\n      const { data, error } = await supabase\r\n        .from('leaderboard')\r\n        .select('*')\r\n        .order('streak', { ascending: false })\r\n        .limit(limit);\r\n\r\n      console.log('Streak leaderboard query result:', { data, error, count: data?.length });\r\n\r\n      if (error) throw error;\r\n      \r\n      // Transform to UserProfile format\r\n      return data?.map(user => ({\r\n        id: user.user_id,\r\n        username: user.username,\r\n        email: '',\r\n        full_name: '',\r\n        avatar_url: user.avatar_url,\r\n        points: user.total_points,\r\n        level: user.level,\r\n        streak: user.streak,\r\n        longest_streak: user.longest_streak,\r\n        status: 'active' as const,\r\n        created_at: user.created_at,\r\n        updated_at: user.updated_at,\r\n      })) || [];\r\n    } catch (error) {\r\n      console.error('Error fetching streak leaderboard:', error);\r\n      // Fallback to original method\r\n      return this.getStreakLeaderboardFallback(limit);\r\n    }\r\n  }\r\n\r\n  private async getStreakLeaderboardFallback(limit: number = 50): Promise<UserProfile[]> {\r\n    try {\r\n      console.log('Using fallback streak leaderboard query...');\r\n      \r\n      // First try with status filter, then fallback without it\r\n      let query = supabase.from('users').select('*');\r\n      \r\n      try {\r\n        query = query.eq('status', 'active');\r\n      } catch (statusError) {\r\n        console.log('Status column might not exist, skipping status filter for streak leaderboard');\r\n        // Continue without status filter\r\n      }\r\n      \r\n      const { data, error } = await query\r\n        .order('streak', { ascending: false })\r\n        .limit(limit);\r\n\r\n      console.log('Fallback streak leaderboard query result:', { data, error, count: data?.length });\r\n\r\n      if (error) throw error;\r\n      return data || [];\r\n    } catch (fallbackError) {\r\n      console.error('Fallback streak query also failed:', fallbackError);\r\n      return [];\r\n    }\r\n  }\r\n\r\n  async getUserRank(userId: string): Promise<number> {\r\n    try {\r\n      // Try to get rank from optimized leaderboard table first\r\n      const { data: rankData, error: rankError } = await supabase\r\n        .from('leaderboard')\r\n        .select('rank_position')\r\n        .eq('user_id', userId)\r\n        .single();\r\n\r\n      if (!rankError && rankData) {\r\n        return rankData.rank_position;\r\n      }\r\n\r\n      // Fallback to calculating rank from users table\r\n      const { data: userData, error: userError } = await supabase\r\n        .from('users')\r\n        .select('points')\r\n        .eq('id', userId)\r\n        .single();\r\n\r\n      if (userError) throw userError;\r\n\r\n      const { count, error: rankError2 } = await supabase\r\n        .from('users')\r\n        .select('*', { count: 'exact', head: true })\r\n        .eq('status', 'active')\r\n        .gt('points', userData.points);\r\n\r\n      if (rankError2) throw rankError2;\r\n\r\n      return (count || 0) + 1;\r\n    } catch (error) {\r\n      console.error('Error fetching user rank:', error);\r\n      return 1;\r\n    }\r\n  }\r\n\r\n  // Real-time subscription methods for leaderboard\r\n  subscribeToLeaderboard(callback: (leaderboard: UserProfile[]) => void): RealtimeChannel {\r\n    const channelName = 'leaderboard_updates';\r\n    \r\n    if (this.channels.has(channelName)) {\r\n      return this.channels.get(channelName)!;\r\n    }\r\n\r\n    const channel = supabase\r\n      .channel(channelName)\r\n      .on(\r\n        'postgres_changes',\r\n        {\r\n          event: '*',\r\n          schema: 'public',\r\n          table: 'leaderboard',\r\n        },\r\n        async () => {\r\n          // Refresh leaderboard data when changes occur\r\n          const updatedLeaderboard = await this.getLeaderboard(50);\r\n          callback(updatedLeaderboard);\r\n        }\r\n      )\r\n      .subscribe();\r\n\r\n    this.channels.set(channelName, channel);\r\n    return channel;\r\n  }\r\n\r\n  subscribeToUserRanking(userId: string, callback: (ranking: any) => void): RealtimeChannel {\r\n    const channelName = `user_ranking_${userId}`;\r\n    \r\n    if (this.channels.has(channelName)) {\r\n      return this.channels.get(channelName)!;\r\n    }\r\n\r\n    const channel = supabase\r\n      .channel(channelName)\r\n      .on(\r\n        'postgres_changes',\r\n        {\r\n          event: '*',\r\n          schema: 'public',\r\n          table: 'leaderboard',\r\n          filter: `user_id=eq.${userId}`,\r\n        },\r\n        async (payload) => {\r\n          if (payload.eventType === 'UPDATE' && payload.new) {\r\n            callback(payload.new);\r\n          }\r\n        }\r\n      )\r\n      .subscribe();\r\n\r\n    this.channels.set(channelName, channel);\r\n    return channel;\r\n  }\r\n\r\n  // Realtime Subscriptions\r\n  subscribeToUser(userId: string, callback: (profile: UserProfile) => void): RealtimeChannel {\r\n    const channelName = `user_${userId}`;\r\n    \r\n    if (this.channels.has(channelName)) {\r\n      return this.channels.get(channelName)!;\r\n    }\r\n\r\n    const channel = supabase\r\n      .channel(channelName)\r\n      .on(\r\n        'postgres_changes',\r\n        {\r\n          event: '*',\r\n          schema: 'public',\r\n          table: 'users',\r\n          filter: `id=eq.${userId}`,\r\n        },\r\n        (payload) => {\r\n          if (payload.eventType === 'UPDATE' && payload.new) {\r\n            callback(payload.new as UserProfile);\r\n          }\r\n        }\r\n      )\r\n      .subscribe();\r\n\r\n    this.channels.set(channelName, channel);\r\n    return channel;\r\n  }\r\n\r\n  subscribeToUserStats(userId: string, callback: (stats: UserStats) => void): RealtimeChannel {\r\n    const channelName = `user_stats_${userId}`;\r\n    \r\n    if (this.channels.has(channelName)) {\r\n      return this.channels.get(channelName)!;\r\n    }\r\n\r\n    const channel = supabase\r\n      .channel(channelName)\r\n      .on(\r\n        'postgres_changes',\r\n        {\r\n          event: '*',\r\n          schema: 'public',\r\n          table: 'user_stats',\r\n          filter: `user_id=eq.${userId}`,\r\n        },\r\n        (payload) => {\r\n          if (payload.eventType === 'UPDATE' && payload.new) {\r\n            callback(payload.new as UserStats);\r\n          }\r\n        }\r\n      )\r\n      .subscribe();\r\n\r\n    this.channels.set(channelName, channel);\r\n    return channel;\r\n  }\r\n\r\n  // Cleanup\r\n  unsubscribe(channelName: string): void {\r\n    const channel = this.channels.get(channelName);\r\n    if (channel) {\r\n      supabase.removeChannel(channel);\r\n      this.channels.delete(channelName);\r\n    }\r\n  }\r\n\r\n  unsubscribeAll(): void {\r\n    this.channels.forEach((channel: any) => {\r\n      supabase.removeChannel(channel);\r\n    });\r\n    this.channels.clear();\r\n  }\r\n}\r\n\r\nexport const supabaseService = new SupabaseService();\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 715, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/UYI/Downloads/Journey/journey/src/services/referralService.ts"],"sourcesContent":["import { supabase } from '@/lib/supabase';\r\nimport { supabaseService } from './supabaseService';\r\n\r\nexport interface ReferralInfo {\r\n  referral_code: string;\r\n  referral_url: string;\r\n  total_referrals: number;\r\n  completed_referrals: number;\r\n  pending_referrals: number;\r\n  points_earned: number;\r\n}\r\n\r\nexport class ReferralService {\r\n  static async getReferralInfo(userId: string): Promise<ReferralInfo | null> {\r\n    try {\r\n      console.log('Getting referral info for userId:', userId);\r\n      \r\n      // Try to get username and referral_code, fallback to email if username doesn't exist\r\n      const { data: user, error: userError } = await supabase\r\n        .from('users')\r\n        .select('username, referral_code, email')\r\n        .eq('id', userId)\r\n        .single();\r\n\r\n      console.log('User data:', user);\r\n      console.log('User error:', userError);\r\n\r\n      if (userError) {\r\n        console.error('Error fetching user:', userError);\r\n        console.error('Error details:', JSON.stringify(userError, null, 2));\r\n        console.error('Error code:', userError.code);\r\n        console.error('Error message:', userError.message);\r\n        console.error('Error details:', userError.details);\r\n        \r\n        // If user doesn't exist, try to get their email from auth and create a basic referral code\r\n        const { data: authUser } = await supabase.auth.getUser();\r\n        if (authUser.user && authUser.user.email) {\r\n          const emailReferralCode = authUser.user.email.split('@')[0].toLowerCase().replace(/[^a-zA-Z0-9]/g, '');\r\n          console.log('Using auth email for referral code:', emailReferralCode);\r\n          \r\n          return {\r\n            referral_code: emailReferralCode,\r\n            referral_url: `${window.location.origin}/auth?ref=${emailReferralCode}`,\r\n            total_referrals: 0,\r\n            completed_referrals: 0,\r\n            pending_referrals: 0,\r\n            points_earned: 0\r\n          };\r\n        }\r\n        \r\n        return null;\r\n      }\r\n\r\n      if (!user) {\r\n        console.log('No user data found');\r\n        return null;\r\n      }\r\n\r\n      // Use username as referral code if referral_code is not set, fallback to email\r\n      const referralCode = user.referral_code || user.username || user.email.split('@')[0].toLowerCase();\r\n      console.log('Using referral code:', referralCode);\r\n\r\n      const { data: referrals, error: referralError } = await supabase\r\n        .from('referrals')\r\n        .select('status, points_awarded')\r\n        .eq('referrer_id', userId);\r\n\r\n      console.log('Referrals data:', referrals);\r\n      console.log('Referrals error:', referralError);\r\n\r\n      if (referralError) {\r\n        console.error('Error fetching referrals:', referralError);\r\n        // Return basic info if referrals table doesn't exist or has permission issues\r\n        return {\r\n          referral_code: referralCode,\r\n          referral_url: `${window.location.origin}/auth?ref=${referralCode}`,\r\n          total_referrals: 0,\r\n          completed_referrals: 0,\r\n          pending_referrals: 0,\r\n          points_earned: 0\r\n        };\r\n      }\r\n\r\n      const referralList = referrals || [];\r\n      const completed_referrals = referralList.filter(r => r.status === 'completed').length;\r\n      const pending_referrals = referralList.filter(r => r.status === 'pending').length;\r\n      const points_earned = referralList.reduce((sum, r) => sum + (r.points_awarded || 0), 0);\r\n\r\n      return {\r\n        referral_code: referralCode,\r\n        referral_url: `${window.location.origin}/auth?ref=${referralCode}`,\r\n        total_referrals: referralList.length,\r\n        completed_referrals,\r\n        pending_referrals,\r\n        points_earned\r\n      };\r\n    } catch (error) {\r\n      console.error('Error getting referral info:', error);\r\n      return null;\r\n    }\r\n  }\r\n\r\n  static async processReferral(referralCode: string, newUserId: string): Promise<boolean> {\r\n    try {\r\n      const { data: referrer, error: referrerError } = await supabase\r\n        .from('users')\r\n        .select('id')\r\n        .eq('referral_code', referralCode)\r\n        .single();\r\n\r\n      if (referrerError || !referrer) return false;\r\n\r\n      const { data: existingReferral } = await supabase\r\n        .from('referrals')\r\n        .select('id')\r\n        .eq('referred_id', newUserId)\r\n        .single();\r\n\r\n      if (existingReferral) return false;\r\n\r\n      await supabase\r\n        .from('users')\r\n        .update({ referred_by: referrer.id })\r\n        .eq('id', newUserId);\r\n\r\n      const { error: referralError } = await supabase\r\n        .from('referrals')\r\n        .insert({\r\n          referrer_id: referrer.id,\r\n          referred_id: newUserId,\r\n          referral_code: referralCode,\r\n          status: 'pending',\r\n          points_awarded: 0\r\n        });\r\n\r\n      if (referralError) throw referralError;\r\n      return true;\r\n    } catch (error) {\r\n      console.error('Error processing referral:', error);\r\n      return false;\r\n    }\r\n  }\r\n\r\n  static async completeReferral(referralId: string): Promise<void> {\r\n    try {\r\n      const { data: referral, error: fetchError } = await supabase\r\n        .from('referrals')\r\n        .select('*')\r\n        .eq('id', referralId)\r\n        .single();\r\n\r\n      if (fetchError || !referral) throw fetchError;\r\n\r\n      const { error: updateError } = await supabase\r\n        .from('referrals')\r\n        .update({\r\n          status: 'completed',\r\n          points_awarded: 100,\r\n          completed_at: new Date().toISOString()\r\n        })\r\n        .eq('id', referralId);\r\n\r\n      if (updateError) throw updateError;\r\n\r\n      await supabaseService.addPoints(referral.referrer_id, 100);\r\n\r\n      await supabase\r\n        .from('points_transactions')\r\n        .insert({\r\n          user_id: referral.referrer_id,\r\n          transaction_type: 'referral',\r\n          points: 100,\r\n          description: 'Referral bonus',\r\n          metadata: {\r\n            referred_user: referral.referred_id,\r\n            referral_code: referral.referral_code\r\n          }\r\n        });\r\n\r\n      await supabase\r\n        .from('user_stats')\r\n        .update({\r\n          referrals_completed: supabase.rpc('increment', { amount: 1 }),\r\n          total_points_earned: supabase.rpc('increment', { amount: 100 })\r\n        })\r\n        .eq('user_id', referral.referrer_id);\r\n\r\n      await supabaseService.addPoints(referral.referred_id, 50);\r\n\r\n      await supabase\r\n        .from('points_transactions')\r\n        .insert({\r\n          user_id: referral.referred_id,\r\n          transaction_type: 'referral',\r\n          points: 50,\r\n          description: 'Welcome bonus',\r\n          metadata: {\r\n            referred_by: referral.referrer_id,\r\n            referral_code: referral.referral_code\r\n          }\r\n        });\r\n\r\n      await supabase\r\n        .from('user_stats')\r\n        .update({\r\n          total_points_earned: supabase.rpc('increment', { amount: 50 })\r\n        })\r\n        .eq('user_id', referral.referred_id);\r\n    } catch (error) {\r\n      console.error('Error completing referral:', error);\r\n      throw error;\r\n    }\r\n  }\r\n\r\n  static generateReferralUrl(referralCode: string): string {\r\n    return `${window.location.origin}/auth?ref=${referralCode}`;\r\n  }\r\n\r\n  static async validateReferralCode(referralCode: string): Promise<boolean> {\r\n    try {\r\n      const { data, error } = await supabase\r\n        .from('users')\r\n        .select('id')\r\n        .eq('referral_code', referralCode)\r\n        .single();\r\n\r\n      return !error && !!data;\r\n    } catch (error) {\r\n      return false;\r\n    }\r\n  }\r\n\r\n  static async getReferralHistory(userId: string): Promise<any[]> {\r\n    try {\r\n      const { data, error } = await supabase\r\n        .from('referrals')\r\n        .select(`\r\n          *,\r\n          referred_user:referred_id(id, username, email, created_at)\r\n        `)\r\n        .eq('referrer_id', userId)\r\n        .order('created_at', { ascending: false });\r\n\r\n      if (error) throw error;\r\n      return data || [];\r\n    } catch (error) {\r\n      console.error('Error getting referral history:', error);\r\n      return [];\r\n    }\r\n  }\r\n\r\n  static async checkPendingReferrals(userId: string): Promise<void> {\r\n    try {\r\n      const userProfile = await supabaseService.getUserProfile(userId);\r\n      if (!userProfile) return;\r\n\r\n      const isActive = userProfile.points > 0 || userProfile.streak > 0;\r\n      \r\n      if (isActive) {\r\n        const { data: pendingReferrals } = await supabase\r\n          .from('referrals')\r\n          .select('id')\r\n          .eq('referred_id', userId)\r\n          .eq('status', 'pending');\r\n\r\n        if (pendingReferrals && pendingReferrals.length > 0) {\r\n          await this.completeReferral(pendingReferrals[0].id);\r\n        }\r\n      }\r\n    } catch (error) {\r\n      console.error('Error checking pending referrals:', error);\r\n    }\r\n  }\r\n}\r\n\r\nexport const referralService = ReferralService;\r\n"],"names":[],"mappings":";;;;;;AAAA;AACA;;;AAWO,MAAM;IACX,aAAa,gBAAgB,MAAc,EAAgC;QACzE,IAAI;YACF,QAAQ,GAAG,CAAC,qCAAqC;YAEjD,qFAAqF;YACrF,MAAM,EAAE,MAAM,IAAI,EAAE,OAAO,SAAS,EAAE,GAAG,MAAM,qIAAQ,CACpD,IAAI,CAAC,SACL,MAAM,CAAC,kCACP,EAAE,CAAC,MAAM,QACT,MAAM;YAET,QAAQ,GAAG,CAAC,cAAc;YAC1B,QAAQ,GAAG,CAAC,eAAe;YAE3B,IAAI,WAAW;gBACb,QAAQ,KAAK,CAAC,wBAAwB;gBACtC,QAAQ,KAAK,CAAC,kBAAkB,KAAK,SAAS,CAAC,WAAW,MAAM;gBAChE,QAAQ,KAAK,CAAC,eAAe,UAAU,IAAI;gBAC3C,QAAQ,KAAK,CAAC,kBAAkB,UAAU,OAAO;gBACjD,QAAQ,KAAK,CAAC,kBAAkB,UAAU,OAAO;gBAEjD,2FAA2F;gBAC3F,MAAM,EAAE,MAAM,QAAQ,EAAE,GAAG,MAAM,qIAAQ,CAAC,IAAI,CAAC,OAAO;gBACtD,IAAI,SAAS,IAAI,IAAI,SAAS,IAAI,CAAC,KAAK,EAAE;oBACxC,MAAM,oBAAoB,SAAS,IAAI,CAAC,KAAK,CAAC,KAAK,CAAC,IAAI,CAAC,EAAE,CAAC,WAAW,GAAG,OAAO,CAAC,iBAAiB;oBACnG,QAAQ,GAAG,CAAC,uCAAuC;oBAEnD,OAAO;wBACL,eAAe;wBACf,cAAc,GAAG,OAAO,QAAQ,CAAC,MAAM,CAAC,UAAU,EAAE,mBAAmB;wBACvE,iBAAiB;wBACjB,qBAAqB;wBACrB,mBAAmB;wBACnB,eAAe;oBACjB;gBACF;gBAEA,OAAO;YACT;YAEA,IAAI,CAAC,MAAM;gBACT,QAAQ,GAAG,CAAC;gBACZ,OAAO;YACT;YAEA,+EAA+E;YAC/E,MAAM,eAAe,KAAK,aAAa,IAAI,KAAK,QAAQ,IAAI,KAAK,KAAK,CAAC,KAAK,CAAC,IAAI,CAAC,EAAE,CAAC,WAAW;YAChG,QAAQ,GAAG,CAAC,wBAAwB;YAEpC,MAAM,EAAE,MAAM,SAAS,EAAE,OAAO,aAAa,EAAE,GAAG,MAAM,qIAAQ,CAC7D,IAAI,CAAC,aACL,MAAM,CAAC,0BACP,EAAE,CAAC,eAAe;YAErB,QAAQ,GAAG,CAAC,mBAAmB;YAC/B,QAAQ,GAAG,CAAC,oBAAoB;YAEhC,IAAI,eAAe;gBACjB,QAAQ,KAAK,CAAC,6BAA6B;gBAC3C,8EAA8E;gBAC9E,OAAO;oBACL,eAAe;oBACf,cAAc,GAAG,OAAO,QAAQ,CAAC,MAAM,CAAC,UAAU,EAAE,cAAc;oBAClE,iBAAiB;oBACjB,qBAAqB;oBACrB,mBAAmB;oBACnB,eAAe;gBACjB;YACF;YAEA,MAAM,eAAe,aAAa,EAAE;YACpC,MAAM,sBAAsB,aAAa,MAAM,CAAC,CAAA,IAAK,EAAE,MAAM,KAAK,aAAa,MAAM;YACrF,MAAM,oBAAoB,aAAa,MAAM,CAAC,CAAA,IAAK,EAAE,MAAM,KAAK,WAAW,MAAM;YACjF,MAAM,gBAAgB,aAAa,MAAM,CAAC,CAAC,KAAK,IAAM,MAAM,CAAC,EAAE,cAAc,IAAI,CAAC,GAAG;YAErF,OAAO;gBACL,eAAe;gBACf,cAAc,GAAG,OAAO,QAAQ,CAAC,MAAM,CAAC,UAAU,EAAE,cAAc;gBAClE,iBAAiB,aAAa,MAAM;gBACpC;gBACA;gBACA;YACF;QACF,EAAE,OAAO,OAAO;YACd,QAAQ,KAAK,CAAC,gCAAgC;YAC9C,OAAO;QACT;IACF;IAEA,aAAa,gBAAgB,YAAoB,EAAE,SAAiB,EAAoB;QACtF,IAAI;YACF,MAAM,EAAE,MAAM,QAAQ,EAAE,OAAO,aAAa,EAAE,GAAG,MAAM,qIAAQ,CAC5D,IAAI,CAAC,SACL,MAAM,CAAC,MACP,EAAE,CAAC,iBAAiB,cACpB,MAAM;YAET,IAAI,iBAAiB,CAAC,UAAU,OAAO;YAEvC,MAAM,EAAE,MAAM,gBAAgB,EAAE,GAAG,MAAM,qIAAQ,CAC9C,IAAI,CAAC,aACL,MAAM,CAAC,MACP,EAAE,CAAC,eAAe,WAClB,MAAM;YAET,IAAI,kBAAkB,OAAO;YAE7B,MAAM,qIAAQ,CACX,IAAI,CAAC,SACL,MAAM,CAAC;gBAAE,aAAa,SAAS,EAAE;YAAC,GAClC,EAAE,CAAC,MAAM;YAEZ,MAAM,EAAE,OAAO,aAAa,EAAE,GAAG,MAAM,qIAAQ,CAC5C,IAAI,CAAC,aACL,MAAM,CAAC;gBACN,aAAa,SAAS,EAAE;gBACxB,aAAa;gBACb,eAAe;gBACf,QAAQ;gBACR,gBAAgB;YAClB;YAEF,IAAI,eAAe,MAAM;YACzB,OAAO;QACT,EAAE,OAAO,OAAO;YACd,QAAQ,KAAK,CAAC,8BAA8B;YAC5C,OAAO;QACT;IACF;IAEA,aAAa,iBAAiB,UAAkB,EAAiB;QAC/D,IAAI;YACF,MAAM,EAAE,MAAM,QAAQ,EAAE,OAAO,UAAU,EAAE,GAAG,MAAM,qIAAQ,CACzD,IAAI,CAAC,aACL,MAAM,CAAC,KACP,EAAE,CAAC,MAAM,YACT,MAAM;YAET,IAAI,cAAc,CAAC,UAAU,MAAM;YAEnC,MAAM,EAAE,OAAO,WAAW,EAAE,GAAG,MAAM,qIAAQ,CAC1C,IAAI,CAAC,aACL,MAAM,CAAC;gBACN,QAAQ;gBACR,gBAAgB;gBAChB,cAAc,IAAI,OAAO,WAAW;YACtC,GACC,EAAE,CAAC,MAAM;YAEZ,IAAI,aAAa,MAAM;YAEvB,MAAM,wJAAe,CAAC,SAAS,CAAC,SAAS,WAAW,EAAE;YAEtD,MAAM,qIAAQ,CACX,IAAI,CAAC,uBACL,MAAM,CAAC;gBACN,SAAS,SAAS,WAAW;gBAC7B,kBAAkB;gBAClB,QAAQ;gBACR,aAAa;gBACb,UAAU;oBACR,eAAe,SAAS,WAAW;oBACnC,eAAe,SAAS,aAAa;gBACvC;YACF;YAEF,MAAM,qIAAQ,CACX,IAAI,CAAC,cACL,MAAM,CAAC;gBACN,qBAAqB,qIAAQ,CAAC,GAAG,CAAC,aAAa;oBAAE,QAAQ;gBAAE;gBAC3D,qBAAqB,qIAAQ,CAAC,GAAG,CAAC,aAAa;oBAAE,QAAQ;gBAAI;YAC/D,GACC,EAAE,CAAC,WAAW,SAAS,WAAW;YAErC,MAAM,wJAAe,CAAC,SAAS,CAAC,SAAS,WAAW,EAAE;YAEtD,MAAM,qIAAQ,CACX,IAAI,CAAC,uBACL,MAAM,CAAC;gBACN,SAAS,SAAS,WAAW;gBAC7B,kBAAkB;gBAClB,QAAQ;gBACR,aAAa;gBACb,UAAU;oBACR,aAAa,SAAS,WAAW;oBACjC,eAAe,SAAS,aAAa;gBACvC;YACF;YAEF,MAAM,qIAAQ,CACX,IAAI,CAAC,cACL,MAAM,CAAC;gBACN,qBAAqB,qIAAQ,CAAC,GAAG,CAAC,aAAa;oBAAE,QAAQ;gBAAG;YAC9D,GACC,EAAE,CAAC,WAAW,SAAS,WAAW;QACvC,EAAE,OAAO,OAAO;YACd,QAAQ,KAAK,CAAC,8BAA8B;YAC5C,MAAM;QACR;IACF;IAEA,OAAO,oBAAoB,YAAoB,EAAU;QACvD,OAAO,GAAG,OAAO,QAAQ,CAAC,MAAM,CAAC,UAAU,EAAE,cAAc;IAC7D;IAEA,aAAa,qBAAqB,YAAoB,EAAoB;QACxE,IAAI;YACF,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,MAAM,qIAAQ,CACnC,IAAI,CAAC,SACL,MAAM,CAAC,MACP,EAAE,CAAC,iBAAiB,cACpB,MAAM;YAET,OAAO,CAAC,SAAS,CAAC,CAAC;QACrB,EAAE,OAAO,OAAO;YACd,OAAO;QACT;IACF;IAEA,aAAa,mBAAmB,MAAc,EAAkB;QAC9D,IAAI;YACF,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,MAAM,qIAAQ,CACnC,IAAI,CAAC,aACL,MAAM,CAAC,CAAC;;;QAGT,CAAC,EACA,EAAE,CAAC,eAAe,QAClB,KAAK,CAAC,cAAc;gBAAE,WAAW;YAAM;YAE1C,IAAI,OAAO,MAAM;YACjB,OAAO,QAAQ,EAAE;QACnB,EAAE,OAAO,OAAO;YACd,QAAQ,KAAK,CAAC,mCAAmC;YACjD,OAAO,EAAE;QACX;IACF;IAEA,aAAa,sBAAsB,MAAc,EAAiB;QAChE,IAAI;YACF,MAAM,cAAc,MAAM,wJAAe,CAAC,cAAc,CAAC;YACzD,IAAI,CAAC,aAAa;YAElB,MAAM,WAAW,YAAY,MAAM,GAAG,KAAK,YAAY,MAAM,GAAG;YAEhE,IAAI,UAAU;gBACZ,MAAM,EAAE,MAAM,gBAAgB,EAAE,GAAG,MAAM,qIAAQ,CAC9C,IAAI,CAAC,aACL,MAAM,CAAC,MACP,EAAE,CAAC,eAAe,QAClB,EAAE,CAAC,UAAU;gBAEhB,IAAI,oBAAoB,iBAAiB,MAAM,GAAG,GAAG;oBACnD,MAAM,IAAI,CAAC,gBAAgB,CAAC,gBAAgB,CAAC,EAAE,CAAC,EAAE;gBACpD;YACF;QACF,EAAE,OAAO,OAAO;YACd,QAAQ,KAAK,CAAC,qCAAqC;QACrD;IACF;AACF;AAEO,MAAM,kBAAkB"}},
    {"offset": {"line": 917, "column": 0}, "map": {"version":3,"sources":["C:/Users/UYI/Downloads/Journey/journey/src/contexts/SupabaseAuthContext.tsx"],"sourcesContent":["'use client';\r\n\r\nimport React, { createContext, useContext, useEffect, useState } from 'react';\r\nimport { User, Session } from '@supabase/supabase-js';\r\nimport { supabase } from '@/lib/supabase';\r\nimport { referralService } from '@/services/referralService';\r\n\r\ninterface AuthContextType {\r\n  user: User | null;\r\n  session: Session | null;\r\n  loading: boolean;\r\n  signUp: (email: string, password: string, fullName?: string, referralCode?: string) => Promise<{ \r\n    success: boolean; \r\n    message?: string; \r\n    error?: string; \r\n    needsConfirmation?: boolean \r\n  }>;\r\n  signIn: (email: string, password: string) => Promise<{ error: any }>;\r\n  signOut: () => Promise<void>;\r\n  resetPassword: (email: string) => Promise<{ error: any }>;\r\n}\r\n\r\nconst AuthContext = createContext<AuthContextType | undefined>(undefined);\r\n\r\nexport function AuthProvider({ children }: { children: React.ReactNode }) {\r\n  const [user, setUser] = useState<User | null>(null);\r\n  const [session, setSession] = useState<Session | null>(null);\r\n  const [loading, setLoading] = useState(true);\r\n\r\n  useEffect(() => {\r\n    // Get initial session\r\n    const getInitialSession = async () => {\r\n      try {\r\n        const { data: { session }, error } = await supabase.auth.getSession();\r\n        \r\n        if (error) {\r\n          console.error('Error getting initial session:', error);\r\n          \r\n          // If refresh token is invalid, clear session and force re-auth\r\n          if (error.message?.includes('Refresh Token Not Found') || \r\n              error.message?.includes('Invalid Refresh Token')) {\r\n            console.log('Invalid refresh token, clearing session');\r\n            await supabase.auth.signOut();\r\n            setSession(null);\r\n            setUser(null);\r\n          }\r\n        } else {\r\n          console.log('Initial session:', session?.user?.email);\r\n          setSession(session);\r\n          setUser(session?.user ?? null);\r\n        }\r\n      } catch (error) {\r\n        console.error('Error getting initial session:', error);\r\n        setSession(null);\r\n        setUser(null);\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    };\r\n\r\n    getInitialSession();\r\n\r\n    // Listen for auth changes\r\n    const { data: { subscription } } = supabase.auth.onAuthStateChange(\r\n      async (event, session) => {\r\n        console.log('Auth state changed:', event, session?.user?.email);\r\n        \r\n        // Handle token refresh errors\r\n        if (event === 'TOKEN_REFRESHED' && !session) {\r\n          console.log('Token refresh failed, signing out');\r\n          await supabase.auth.signOut();\r\n        }\r\n        \r\n        setSession(session);\r\n        setUser(session?.user ?? null);\r\n        setLoading(false);\r\n      }\r\n    );\r\n\r\n    return () => subscription.unsubscribe();\r\n  }, []);\r\n\r\n  const signUp = async (email: string, password: string, fullName?: string, referralCode?: string) => {\r\n    try {\r\n      const emailRegex = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;\r\n      if (!emailRegex.test(email)) {\r\n        return { \r\n          success: false, \r\n          error: 'Please enter a valid email address',\r\n          message: 'Please enter a valid email address'\r\n        };\r\n      }\r\n\r\n      if (password.length < 6) {\r\n        return { \r\n          success: false, \r\n          error: 'Password must be at least 6 characters long',\r\n          message: 'Password must be at least 6 characters long'\r\n        };\r\n      }\r\n\r\n      console.log('Attempting sign up for:', email);\r\n      \r\n      const { data, error } = await supabase.auth.signUp({\r\n        email,\r\n        password,\r\n        options: {\r\n          data: {\r\n            full_name: fullName || email.split('@')[0],\r\n          },\r\n          emailRedirectTo: `${window.location.origin}/auth/callback`,\r\n        },\r\n      });\r\n\r\n      if (error) {\r\n        console.error('Supabase sign up error:', error);\r\n        return { \r\n          success: false, \r\n          error: error.message || 'Failed to create account',\r\n          message: error.message || 'Failed to create account'\r\n        };\r\n      }\r\n\r\n      console.log('Sign up response:', data);\r\n\r\n      // Process referral if provided and user was created\r\n      if (referralCode && data.user) {\r\n        console.log('Processing referral:', referralCode);\r\n        await referralService.processReferral(referralCode, data.user.id);\r\n      }\r\n\r\n      if (data.user && !data.user.email_confirmed_at) {\r\n        return { \r\n          success: true, \r\n          message: 'Please check your email to confirm your account.',\r\n          needsConfirmation: true \r\n        };\r\n      }\r\n\r\n      return { success: true, message: 'Account created successfully!' };\r\n    } catch (error: any) {\r\n      console.error('Unexpected sign up error:', error);\r\n      return { \r\n        success: false, \r\n        error: error.message || 'An unexpected error occurred',\r\n        message: error.message || 'An unexpected error occurred'\r\n      };\r\n    }\r\n  };\r\n\r\n  const signIn = async (email: string, password: string) => {\r\n    try {\r\n      const emailRegex = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;\r\n      if (!emailRegex.test(email)) {\r\n        return { error: { message: 'Please enter a valid email address' } };\r\n      }\r\n\r\n      if (!password) {\r\n        return { error: { message: 'Password is required' } };\r\n      }\r\n\r\n      console.log('Attempting sign in for:', email);\r\n      \r\n      const { data, error } = await supabase.auth.signInWithPassword({\r\n        email,\r\n        password,\r\n      });\r\n\r\n      if (error) {\r\n        console.error('Supabase sign in error:', error);\r\n        return { error };\r\n      }\r\n\r\n      // Award daily login points\r\n      if (data.user) {\r\n        console.log('Awarding daily login points to:', data.user.id);\r\n        try {\r\n          const { data: pointsData, error: pointsError } = await supabase\r\n            .rpc('award_daily_login_points', { user_uuid: data.user.id });\r\n          \r\n          if (pointsError) {\r\n            console.error('Error awarding daily points:', pointsError);\r\n          } else {\r\n            console.log('Daily login points awarded:', pointsData);\r\n          }\r\n        } catch (pointsError) {\r\n          console.error('Error calling daily points function:', pointsError);\r\n        }\r\n\r\n        // Check for pending referrals to complete\r\n        try {\r\n          await referralService.checkPendingReferrals(data.user.id);\r\n        } catch (referralError) {\r\n          console.error('Error checking pending referrals:', referralError);\r\n        }\r\n      }\r\n\r\n      console.log('Sign in successful:', data.user?.email);\r\n      return { error: null };\r\n    } catch (error: any) {\r\n      console.error('Unexpected sign in error:', error);\r\n      return { error: { message: 'An unexpected error occurred' } };\r\n    }\r\n  };\r\n\r\n  const signOut = async () => {\r\n    try {\r\n      await supabase.auth.signOut();\r\n      setSession(null);\r\n      setUser(null);\r\n      console.log('User signed out successfully');\r\n    } catch (error) {\r\n      console.error('Error signing out:', error);\r\n      // Force clear state even if signOut fails\r\n      setSession(null);\r\n      setUser(null);\r\n    }\r\n  };\r\n\r\n  const resetPassword = async (email: string) => {\r\n    const { error } = await supabase.auth.resetPasswordForEmail(email);\r\n    return { error };\r\n  };\r\n\r\n  const value = {\r\n    user,\r\n    session,\r\n    loading,\r\n    signUp,\r\n    signIn,\r\n    signOut,\r\n    resetPassword,\r\n  };\r\n\r\n  return <AuthContext.Provider value={value}>{children}</AuthContext.Provider>;\r\n}\r\n\r\nexport function useAuth() {\r\n  const context = useContext(AuthContext);\r\n  if (context === undefined) {\r\n    throw new Error('useAuth must be used within an AuthProvider');\r\n  }\r\n  return context;\r\n}\r\n"],"names":["c","_c","React","createContext","useContext","useEffect","useState","User","Session","supabase","referralService","AuthContextType","user","session","loading","signUp","email","password","fullName","referralCode","Promise","success","message","error","needsConfirmation","signIn","signOut","resetPassword","AuthContext","undefined","AuthProvider","children","ReactNode","setUser","setSession","setLoading","getInitialSession","data","auth","getSession","console","includes","log","subscription","onAuthStateChange","event","unsubscribe","emailRegex","test","length","options","full_name","split","emailRedirectTo","window","location","origin","processReferral","id","email_confirmed_at","signInWithPassword","pointsData","pointsError","rpc","user_uuid","checkPendingReferrals","referralError","resetPasswordForEmail","value","useAuth","$","$i","Symbol","for","context","Error"],"mappings":"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","ignoreList":[]}},
    {"offset": {"line": 1180, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/UYI/Downloads/Journey/journey/src/data/achievements.ts"],"sourcesContent":["import { Achievement } from '@/types';\r\n\r\nexport const achievements: Achievement[] = [\r\n  // Daily Login Achievements\r\n  {\r\n    id: 'daily-login-1',\r\n    name: 'First Day',\r\n    description: 'Log in for the first time',\r\n    icon: 'sun',\r\n    points: 5,\r\n    category: 'daily',\r\n    unlockedAt: new Date(),\r\n  },\r\n  {\r\n    id: 'daily-login-7',\r\n    name: 'Week Warrior',\r\n    description: 'Log in for 7 consecutive days',\r\n    icon: 'calendar',\r\n    points: 50,\r\n    category: 'daily',\r\n    unlockedAt: new Date(),\r\n  },\r\n  {\r\n    id: 'daily-login-30',\r\n    name: 'Monthly Master',\r\n    description: 'Log in for 30 consecutive days',\r\n    icon: 'calendar',\r\n    points: 200,\r\n    category: 'daily',\r\n    unlockedAt: new Date(),\r\n  },\r\n\r\n  // Reading Achievements\r\n  {\r\n    id: 'first-verse',\r\n    name: 'First Steps',\r\n    description: 'Read your first Bible verse',\r\n    icon: 'book-open',\r\n    points: 10,\r\n    category: 'reading',\r\n    unlockedAt: new Date(),\r\n  },\r\n  {\r\n    id: 'chapter-complete',\r\n    name: 'Chapter Reader',\r\n    description: 'Complete reading an entire chapter',\r\n    icon: 'book-open',\r\n    points: 25,\r\n    category: 'reading',\r\n    unlockedAt: new Date(),\r\n  },\r\n  {\r\n    id: 'book-complete',\r\n    name: 'Book Scholar',\r\n    description: 'Complete reading an entire book',\r\n    icon: 'book-open',\r\n    points: 100,\r\n    category: 'reading',\r\n    unlockedAt: new Date(),\r\n  },\r\n  {\r\n    id: 'testament-complete',\r\n    name: 'Testament Master',\r\n    description: 'Complete reading an entire testament',\r\n    icon: 'book-open',\r\n    points: 500,\r\n    category: 'reading',\r\n    unlockedAt: new Date(),\r\n  },\r\n  {\r\n    id: 'bible-complete',\r\n    name: 'Bible Scholar',\r\n    description: 'Complete reading the entire Bible',\r\n    icon: 'trophy',\r\n    points: 1000,\r\n    category: 'reading',\r\n    unlockedAt: new Date(),\r\n  },\r\n\r\n  // Streak Achievements\r\n  {\r\n    id: 'streak-3',\r\n    name: '3 Day Streak',\r\n    description: 'Maintain a 3-day reading streak',\r\n    icon: 'flame',\r\n    points: 30,\r\n    category: 'streak',\r\n    unlockedAt: new Date(),\r\n  },\r\n  {\r\n    id: 'streak-7',\r\n    name: 'Week Warrior',\r\n    description: 'Maintain a 7-day reading streak',\r\n    icon: 'flame',\r\n    points: 75,\r\n    category: 'streak',\r\n    unlockedAt: new Date(),\r\n  },\r\n  {\r\n    id: 'streak-30',\r\n    name: 'Monthly Master',\r\n    description: 'Maintain a 30-day reading streak',\r\n    icon: 'flame',\r\n    points: 300,\r\n    category: 'streak',\r\n    unlockedAt: new Date(),\r\n  },\r\n  {\r\n    id: 'streak-100',\r\n    name: 'Century Saint',\r\n    description: 'Maintain a 100-day reading streak',\r\n    icon: 'flame',\r\n    points: 1000,\r\n    category: 'streak',\r\n    unlockedAt: new Date(),\r\n  },\r\n\r\n  // Community Achievements\r\n  {\r\n    id: 'first-friend',\r\n    name: 'Friend Maker',\r\n    description: 'Add your first friend',\r\n    icon: 'users',\r\n    points: 15,\r\n    category: 'community',\r\n    unlockedAt: new Date(),\r\n  },\r\n  {\r\n    id: 'social-butterfly',\r\n    name: 'Social Butterfly',\r\n    description: 'Add 10 friends',\r\n    icon: 'users',\r\n    points: 50,\r\n    category: 'community',\r\n    unlockedAt: new Date(),\r\n  },\r\n  {\r\n    id: 'first-post',\r\n    name: 'Voice Heard',\r\n    description: 'Make your first community post',\r\n    icon: 'message-circle',\r\n    points: 20,\r\n    category: 'community',\r\n    unlockedAt: new Date(),\r\n  },\r\n  {\r\n    id: 'community-leader',\r\n    name: 'Community Leader',\r\n    description: 'Make 10 community posts',\r\n    icon: 'message-circle',\r\n    points: 100,\r\n    category: 'community',\r\n    unlockedAt: new Date(),\r\n  },\r\n\r\n  // Devotional Achievements\r\n  {\r\n    id: 'first-devotional',\r\n    name: 'First Devotional',\r\n    description: 'Create your first devotional',\r\n    icon: 'heart',\r\n    points: 20,\r\n    category: 'special',\r\n    unlockedAt: new Date(),\r\n  },\r\n  {\r\n    id: 'devotional-writer',\r\n    name: 'Devotional Writer',\r\n    description: 'Create 5 devotionals',\r\n    icon: 'heart',\r\n    points: 100,\r\n    category: 'special',\r\n    unlockedAt: new Date(),\r\n  },\r\n  {\r\n    id: 'devotional-author',\r\n    name: 'Devotional Author',\r\n    description: 'Create 20 devotionals',\r\n    icon: 'heart',\r\n    points: 300,\r\n    category: 'special',\r\n    unlockedAt: new Date(),\r\n  },\r\n\r\n  // Prayer Achievements\r\n  {\r\n    id: 'first-prayer',\r\n    name: 'First Prayer',\r\n    description: 'Share your first prayer',\r\n    icon: 'hands',\r\n    points: 15,\r\n    category: 'special',\r\n    unlockedAt: new Date(),\r\n  },\r\n  {\r\n    id: 'prayer-warrior',\r\n    name: 'Prayer Warrior',\r\n    description: 'Share 10 prayers',\r\n    icon: 'hands',\r\n    points: 75,\r\n    category: 'special',\r\n    unlockedAt: new Date(),\r\n  },\r\n  {\r\n    id: 'prayer-intercessor',\r\n    name: 'Prayer Intercessor',\r\n    description: 'Share 50 prayers',\r\n    icon: 'hands',\r\n    points: 200,\r\n    category: 'special',\r\n    unlockedAt: new Date(),\r\n  },\r\n\r\n  // Reading Plan Achievements\r\n  {\r\n    id: 'first-plan',\r\n    name: 'Plan Starter',\r\n    description: 'Start your first reading plan',\r\n    icon: 'calendar',\r\n    points: 10,\r\n    category: 'reading',\r\n    unlockedAt: new Date(),\r\n  },\r\n  {\r\n    id: 'plan-completer',\r\n    name: 'Plan Completer',\r\n    description: 'Complete your first reading plan',\r\n    icon: 'calendar',\r\n    points: 50,\r\n    category: 'reading',\r\n    unlockedAt: new Date(),\r\n  },\r\n  {\r\n    id: 'plan-enthusiast',\r\n    name: 'Plan Enthusiast',\r\n    description: 'Start 5 reading plans',\r\n    icon: 'calendar',\r\n    points: 100,\r\n    category: 'reading',\r\n    unlockedAt: new Date(),\r\n  },\r\n\r\n  // Point Achievements\r\n  {\r\n    id: 'point-collector',\r\n    name: 'Point Collector',\r\n    description: 'Earn 100 points',\r\n    icon: 'star',\r\n    points: 50,\r\n    category: 'special',\r\n    unlockedAt: new Date(),\r\n  },\r\n  {\r\n    id: 'point-master',\r\n    name: 'Point Master',\r\n    description: 'Earn 1000 points',\r\n    icon: 'star',\r\n    points: 100,\r\n    category: 'special',\r\n    unlockedAt: new Date(),\r\n  },\r\n  {\r\n    id: 'point-legend',\r\n    name: 'Point Legend',\r\n    description: 'Earn 10000 points',\r\n    icon: 'star',\r\n    points: 500,\r\n    category: 'special',\r\n    unlockedAt: new Date(),\r\n  },\r\n\r\n  // Special Achievements\r\n  {\r\n    id: 'early-bird',\r\n    name: 'Early Bird',\r\n    description: 'Read Bible verses before 6 AM for 7 days',\r\n    icon: 'sun',\r\n    points: 150,\r\n    category: 'special',\r\n    unlockedAt: new Date(),\r\n  },\r\n  {\r\n    id: 'night-owl',\r\n    name: 'Night Owl',\r\n    description: 'Read Bible verses after 10 PM for 7 days',\r\n    icon: 'moon',\r\n    points: 150,\r\n    category: 'special',\r\n    unlockedAt: new Date(),\r\n  },\r\n  {\r\n    id: 'explorer',\r\n    name: 'Bible Explorer',\r\n    description: 'Read from every book of the Bible',\r\n    icon: 'compass',\r\n    points: 750,\r\n    category: 'special',\r\n    unlockedAt: new Date(),\r\n  },\r\n];\r\n\r\nexport const getAchievementsByCategory = (category: string): Achievement[] => {\r\n  return achievements.filter(achievement => achievement.category === category);\r\n};\r\n\r\nexport const getAchievementById = (id: string): Achievement | undefined => {\r\n  return achievements.find(achievement => achievement.id === id);\r\n};\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1491, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/UYI/Downloads/Journey/journey/src/services/achievementService.ts"],"sourcesContent":["import { supabaseService } from './supabaseService';\r\nimport { achievements, getAchievementById } from '@/data/achievements';\r\nimport { Achievement } from '@/types';\r\n\r\nexport interface UserAchievement {\r\n  id: string;\r\n  user_id: string;\r\n  achievement_id: string;\r\n  unlocked_at: string;\r\n  points_awarded: number;\r\n}\r\n\r\nexport interface DailyLoginRecord {\r\n  id: string;\r\n  user_id: string;\r\n  login_date: string;\r\n  points_awarded: number;\r\n  created_at: string;\r\n}\r\n\r\nclass AchievementService {\r\n  // Daily Login Tracking\r\n  static async trackDailyLogin(userId: string): Promise<{\r\n    pointsAwarded: number;\r\n    newAchievements: Achievement[];\r\n    streakUpdated: boolean;\r\n  }> {\r\n    const now = new Date();\r\n    \r\n    try {\r\n      // Check if user has claimed in the last 24 hours\r\n      const existingLogin = await this.getRecentLoginRecord(userId);\r\n      \r\n      if (existingLogin) {\r\n        return {\r\n          pointsAwarded: 0,\r\n          newAchievements: [],\r\n          streakUpdated: false,\r\n        };\r\n      }\r\n\r\n      // Record today's login and award points\r\n      const pointsAwarded = await this.awardDailyLoginPoints(userId);\r\n      \r\n      // Update streak\r\n      const streakUpdated = await this.updateLoginStreak(userId);\r\n      \r\n      // Check for new achievements\r\n      const newAchievements = await this.checkDailyLoginAchievements(userId);\r\n\r\n      return {\r\n        pointsAwarded,\r\n        newAchievements,\r\n        streakUpdated,\r\n      };\r\n    } catch (error) {\r\n      console.error('Error tracking daily login:', error);\r\n      return {\r\n        pointsAwarded: 0,\r\n        newAchievements: [],\r\n        streakUpdated: false,\r\n      };\r\n    }\r\n  }\r\n\r\n  private static async getRecentLoginRecord(userId: string): Promise<DailyLoginRecord | null> {\r\n    try {\r\n      const now = new Date();\r\n      const { data, error } = await supabaseService.getClient()\r\n        .from('daily_login_rewards')\r\n        .select('*')\r\n        .eq('user_id', userId)\r\n        .gte('created_at', new Date(now.getTime() - 24 * 60 * 60 * 1000).toISOString())\r\n        .order('created_at', { ascending: false })\r\n        .limit(1)\r\n        .maybeSingle();\r\n\r\n      if (error) {\r\n        console.error('Error checking recent login:', error);\r\n        return null;\r\n      }\r\n\r\n      return data;\r\n    } catch (error) {\r\n      console.error('Error getting recent login record:', error);\r\n      return null;\r\n    }\r\n  }\r\n\r\n  private static async awardDailyLoginPoints(userId: string): Promise<number> {\r\n    const basePoints = 5;\r\n    const userProfile = await supabaseService.getUserProfile(userId);\r\n    \r\n    if (!userProfile) return 0;\r\n\r\n    // Bonus points for streak milestones\r\n    let bonusPoints = 0;\r\n    if (userProfile.streak === 7) bonusPoints = 10;\r\n    if (userProfile.streak === 30) bonusPoints = 25;\r\n    if (userProfile.streak === 100) bonusPoints = 100;\r\n\r\n    const totalPoints = basePoints + bonusPoints;\r\n    \r\n    // Add points to user profile\r\n    await supabaseService.addPoints(userId, totalPoints);\r\n    \r\n    // Record daily login\r\n    await this.recordDailyLogin(userId, totalPoints);\r\n    \r\n    return totalPoints;\r\n  }\r\n\r\n  private static async recordDailyLogin(userId: string, points: number): Promise<void> {\r\n    try {\r\n      await supabaseService.getClient()\r\n        .from('daily_login_rewards')\r\n        .insert({\r\n          user_id: userId,\r\n          points_awarded: points,\r\n        });\r\n    } catch (error) {\r\n      console.error('Error recording daily login:', error);\r\n    }\r\n  }\r\n\r\n  private static async updateLoginStreak(userId: string): Promise<boolean> {\r\n    try {\r\n      const userProfile = await supabaseService.getUserProfile(userId);\r\n      if (!userProfile) return false;\r\n\r\n      const now = new Date();\r\n      const lastActive = new Date(userProfile.updated_at);\r\n      \r\n      // Calculate hours difference\r\n      const hoursDiff = (now.getTime() - lastActive.getTime()) / (1000 * 60 * 60);\r\n      \r\n      let newStreak = userProfile.streak;\r\n      \r\n      if (hoursDiff < 24) {\r\n        // Already claimed within 24 hours, no change\r\n        return false;\r\n      } else if (hoursDiff <= 48) {\r\n        // Continue streak (within 48 hours)\r\n        newStreak += 1;\r\n      } else {\r\n        // Reset streak (more than 48 hours)\r\n        newStreak = 1;\r\n      }\r\n      \r\n      await supabaseService.updateStreak(userId, newStreak);\r\n      return true;\r\n    } catch (error) {\r\n      console.error('Error updating login streak:', error);\r\n      return false;\r\n    }\r\n  }\r\n\r\n  private static async checkDailyLoginAchievements(userId: string): Promise<Achievement[]> {\r\n    const userProfile = await supabaseService.getUserProfile(userId);\r\n    if (!userProfile) return [];\r\n\r\n    const newAchievements: Achievement[] = [];\r\n    const userAchievements = await this.getUserAchievements(userId);\r\n    const unlockedIds = new Set(userAchievements.map(ua => ua.achievement_id));\r\n\r\n    // Check daily login achievements\r\n    const dailyAchievements = achievements.filter(a => a.category === 'daily');\r\n    \r\n    for (const achievement of dailyAchievements) {\r\n      if (unlockedIds.has(achievement.id)) continue;\r\n      \r\n      let shouldUnlock = false;\r\n      \r\n      switch (achievement.id) {\r\n        case 'daily-login-1':\r\n          shouldUnlock = userProfile.streak >= 1;\r\n          break;\r\n        case 'daily-login-7':\r\n          shouldUnlock = userProfile.streak >= 7;\r\n          break;\r\n        case 'daily-login-30':\r\n          shouldUnlock = userProfile.streak >= 30;\r\n          break;\r\n      }\r\n      \r\n      if (shouldUnlock) {\r\n        await this.unlockAchievement(userId, achievement.id);\r\n        newAchievements.push(achievement);\r\n      }\r\n    }\r\n\r\n    return newAchievements;\r\n  }\r\n\r\n  // Achievement Management\r\n  static async unlockAchievement(userId: string, achievementId: string): Promise<boolean> {\r\n    try {\r\n      const achievement = getAchievementById(achievementId);\r\n      if (!achievement) return false;\r\n\r\n      // Check if already unlocked\r\n      const existing = await this.getUserAchievement(userId, achievementId);\r\n      if (existing) return false;\r\n\r\n      // Record achievement unlock\r\n      await supabaseService.getClient()\r\n        .from('user_achievements')\r\n        .insert({\r\n          user_id: userId,\r\n          achievement_id: achievementId,\r\n          unlocked_at: new Date().toISOString(),\r\n          points_awarded: achievement.points,\r\n        });\r\n\r\n      // Award achievement points\r\n      await supabaseService.addPoints(userId, achievement.points);\r\n\r\n      return true;\r\n    } catch (error) {\r\n      console.error('Error unlocking achievement:', error);\r\n      return false;\r\n    }\r\n  }\r\n\r\n  static async getUserAchievements(userId: string): Promise<UserAchievement[]> {\r\n    try {\r\n      const { data, error } = await supabaseService.getClient()\r\n        .from('user_achievements')\r\n        .select('*')\r\n        .eq('user_id', userId)\r\n        .order('unlocked_at', { ascending: false });\r\n\r\n      if (error) {\r\n        console.error('Error fetching user achievements:', error);\r\n        return [];\r\n      }\r\n\r\n      return data || [];\r\n    } catch (error) {\r\n      console.error('Error getting user achievements:', error);\r\n      return [];\r\n    }\r\n  }\r\n\r\n  static async getUserAchievement(userId: string, achievementId: string): Promise<UserAchievement | null> {\r\n    try {\r\n      const { data, error } = await supabaseService.getClient()\r\n        .from('user_achievements')\r\n        .select('*')\r\n        .eq('user_id', userId)\r\n        .eq('achievement_id', achievementId)\r\n        .single();\r\n\r\n      if (error) {\r\n        console.error('Error fetching user achievement:', error);\r\n        return null;\r\n      }\r\n\r\n      return data;\r\n    } catch (error) {\r\n      console.error('Error getting user achievement:', error);\r\n      return null;\r\n    }\r\n  }\r\n\r\n  // Enhanced Activity Tracking\r\n  static async trackActivityAndCheckAchievements(\r\n    userId: string, \r\n    activityType: string, \r\n    metadata?: Record<string, any>\r\n  ): Promise<{\r\n    pointsAwarded: number;\r\n    newAchievements: Achievement[];\r\n  }> {\r\n    const newAchievements: Achievement[] = [];\r\n    let pointsAwarded = 0;\r\n\r\n    try {\r\n      // Track the specific activity and award points\r\n      switch (activityType) {\r\n        case 'verse_read':\r\n          pointsAwarded = 1;\r\n          await this.checkReadingAchievements(userId);\r\n          break;\r\n        case 'chapter_completed':\r\n          pointsAwarded = 10;\r\n          await this.checkReadingAchievements(userId);\r\n          break;\r\n        case 'book_completed':\r\n          pointsAwarded = 50;\r\n          await this.checkReadingAchievements(userId);\r\n          break;\r\n        case 'post_created':\r\n          pointsAwarded = 20;\r\n          await this.checkCommunityAchievements(userId);\r\n          break;\r\n        case 'friend_added':\r\n          pointsAwarded = 15;\r\n          await this.checkCommunityAchievements(userId);\r\n          break;\r\n        default:\r\n          pointsAwarded = 0;\r\n      }\r\n\r\n      // Award points\r\n      if (pointsAwarded > 0) {\r\n        await supabaseService.addPoints(userId, pointsAwarded);\r\n      }\r\n\r\n      return { pointsAwarded, newAchievements };\r\n    } catch (error) {\r\n      console.error('Error tracking activity and achievements:', error);\r\n      return { pointsAwarded: 0, newAchievements: [] };\r\n    }\r\n  }\r\n\r\n  private static async checkReadingAchievements(userId: string): Promise<Achievement[]> {\r\n    // Implementation for checking reading achievements\r\n    // This would check verses read, chapters completed, etc.\r\n    return [];\r\n  }\r\n\r\n  private static async checkCommunityAchievements(userId: string): Promise<Achievement[]> {\r\n    // Implementation for checking community achievements\r\n    // This would check friends count, posts created, etc.\r\n    return [];\r\n  }\r\n\r\n  // Check and award achievements based on user activity\r\n  static async checkAndAwardAchievements(userId: string): Promise<{\r\n    newAchievements: Achievement[];\r\n    pointsAwarded: number;\r\n  }> {\r\n    try {\r\n      const newAchievements: Achievement[] = [];\r\n      let totalPointsAwarded = 0;\r\n\r\n      // Get user stats\r\n      const userStats = await supabaseService.getUserStats(userId);\r\n      if (!userStats) {\r\n        return { newAchievements, pointsAwarded: 0 };\r\n      }\r\n\r\n      // Get user profile for streak info\r\n      const userProfile = await supabaseService.getUserProfile(userId);\r\n      if (!userProfile) {\r\n        return { newAchievements, pointsAwarded: 0 };\r\n      }\r\n\r\n      // Get existing achievements to avoid duplicates\r\n      const existingAchievements = await supabaseService.getUserAchievements(userId);\r\n      const unlockedIds = new Set(existingAchievements.map(ua => ua.achievement_id));\r\n\r\n      // Check all achievements\r\n      for (const achievement of achievements) {\r\n        if (unlockedIds.has(achievement.id)) continue; // Skip if already unlocked\r\n\r\n        let shouldAward = false;\r\n\r\n        // Check based on achievement category and criteria\r\n        switch (achievement.id) {\r\n          // Daily Login Achievements\r\n          case 'daily-login-1':\r\n            shouldAward = true; // Awarded when user first logs in\r\n            break;\r\n          case 'daily-login-7':\r\n            shouldAward = userProfile.streak >= 7;\r\n            break;\r\n          case 'daily-login-30':\r\n            shouldAward = userProfile.streak >= 30;\r\n            break;\r\n\r\n          // Reading Achievements\r\n          case 'first-verse':\r\n            shouldAward = userStats.verses_read > 0;\r\n            break;\r\n          case 'chapter-complete':\r\n            shouldAward = userStats.chapters_completed >= 1;\r\n            break;\r\n          case 'book-complete':\r\n            shouldAward = userStats.chapters_completed >= 10; // Approximate\r\n            break;\r\n          case 'testament-complete':\r\n            shouldAward = userStats.chapters_completed >= 50; // Approximate\r\n            break;\r\n          case 'bible-complete':\r\n            shouldAward = userStats.chapters_completed >= 1189; // All chapters\r\n            break;\r\n\r\n          // Streak Achievements\r\n          case 'streak-3':\r\n            shouldAward = userProfile.streak >= 3;\r\n            break;\r\n          case 'streak-7':\r\n            shouldAward = userProfile.streak >= 7;\r\n            break;\r\n          case 'streak-30':\r\n            shouldAward = userProfile.streak >= 30;\r\n            break;\r\n          case 'streak-100':\r\n            shouldAward = userProfile.streak >= 100;\r\n            break;\r\n\r\n          // Devotional Achievements\r\n          case 'first-devotional':\r\n            shouldAward = userStats.devotionals_created >= 1;\r\n            break;\r\n          case 'devotional-writer':\r\n            shouldAward = userStats.devotionals_created >= 5;\r\n            break;\r\n          case 'devotional-author':\r\n            shouldAward = userStats.devotionals_created >= 20;\r\n            break;\r\n\r\n          // Prayer Achievements\r\n          case 'first-prayer':\r\n            shouldAward = userStats.prayers_shared >= 1;\r\n            break;\r\n          case 'prayer-warrior':\r\n            shouldAward = userStats.prayers_shared >= 10;\r\n            break;\r\n          case 'prayer-intercessor':\r\n            shouldAward = userStats.prayers_shared >= 50;\r\n            break;\r\n\r\n          // Reading Plan Achievements\r\n          case 'first-plan':\r\n            shouldAward = userStats.reading_plans_started >= 1;\r\n            break;\r\n          case 'plan-completer':\r\n            shouldAward = userStats.reading_plans_completed >= 1;\r\n            break;\r\n          case 'plan-enthusiast':\r\n            shouldAward = userStats.reading_plans_started >= 5;\r\n            break;\r\n\r\n          // Community Achievements\r\n          case 'first-friend':\r\n            shouldAward = userStats.friends_count >= 1;\r\n            break;\r\n          case 'social-butterfly':\r\n            shouldAward = userStats.friends_count >= 10;\r\n            break;\r\n          case 'first-post':\r\n            shouldAward = userStats.community_posts >= 1;\r\n            break;\r\n          case 'community-leader':\r\n            shouldAward = userStats.community_posts >= 10;\r\n            break;\r\n\r\n          // Special Achievements\r\n          case 'early-bird':\r\n            shouldAward = !!(userProfile.created_at && new Date(userProfile.created_at) < new Date('2024-01-01'));\r\n            break;\r\n          case 'point-collector':\r\n            shouldAward = userProfile.points >= 100;\r\n            break;\r\n          case 'point-master':\r\n            shouldAward = userProfile.points >= 1000;\r\n            break;\r\n          case 'point-legend':\r\n            shouldAward = userProfile.points >= 10000;\r\n            break;\r\n        }\r\n\r\n        if (shouldAward) {\r\n          // Award the achievement\r\n          const awarded = await supabaseService.unlockAchievement(userId, achievement.id);\r\n          if (awarded) {\r\n            newAchievements.push(achievement);\r\n            totalPointsAwarded += achievement.points;\r\n          }\r\n        }\r\n      }\r\n\r\n      // Award total points for new achievements\r\n      if (totalPointsAwarded > 0) {\r\n        await supabaseService.addPoints(userId, totalPointsAwarded);\r\n      }\r\n\r\n      return { newAchievements, pointsAwarded: totalPointsAwarded };\r\n    } catch (error) {\r\n      console.error('Error checking achievements:', error);\r\n      return { newAchievements: [], pointsAwarded: 0 };\r\n    }\r\n  }\r\n  static async getAchievementStats(userId: string): Promise<{\r\n    totalAchievements: number;\r\n    unlockedAchievements: number;\r\n    totalPoints: number;\r\n    categoryProgress: Record<string, { unlocked: number; total: number }>;\r\n  }> {\r\n    try {\r\n      const allAchievements = achievements;\r\n      const userAchievements = await this.getUserAchievements(userId);\r\n      const unlockedIds = new Set(userAchievements.map(ua => ua.achievement_id));\r\n\r\n      const categories = [...new Set(allAchievements.map(a => a.category))];\r\n      const categoryProgress: Record<string, { unlocked: number; total: number }> = {};\r\n\r\n      categories.forEach(category => {\r\n        const categoryAchievements = allAchievements.filter(a => a.category === category);\r\n        const unlockedInCategory = categoryAchievements.filter(a => unlockedIds.has(a.id));\r\n        \r\n        categoryProgress[category] = {\r\n          unlocked: unlockedInCategory.length,\r\n          total: categoryAchievements.length,\r\n        };\r\n      });\r\n\r\n      return {\r\n        totalAchievements: allAchievements.length,\r\n        unlockedAchievements: userAchievements.length,\r\n        totalPoints: userAchievements.reduce((sum, ua) => sum + ua.points_awarded, 0),\r\n        categoryProgress,\r\n      };\r\n    } catch (error) {\r\n      console.error('Error getting achievement stats:', error);\r\n      return {\r\n        totalAchievements: 0,\r\n        unlockedAchievements: 0,\r\n        totalPoints: 0,\r\n        categoryProgress: {},\r\n      };\r\n    }\r\n  }\r\n}\r\n\r\nexport const achievementService = AchievementService;\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1930, "column": 0}, "map": {"version":3,"sources":["C:/Users/UYI/Downloads/Journey/journey/src/contexts/UserDataContext.tsx"],"sourcesContent":["'use client';\r\n\r\nimport React, { createContext, useContext, useState, useEffect } from 'react';\r\nimport { User as SupabaseUser } from '@supabase/supabase-js';\r\nimport { useAuth } from '@/contexts/SupabaseAuthContext';\r\nimport { supabaseService, UserProfile, UserStats } from '@/services/supabaseService';\r\nimport { achievementService } from '@/services/achievementService';\r\nimport { User, Gamification, UserSettings } from '@/types';\r\n\r\ninterface UserDataContextType {\r\n  user: User | null;\r\n  stats: Gamification | null;\r\n  loading: boolean;\r\n  error: string | null;\r\n  updateUser: (user: Partial<User>) => void;\r\n  updateStats: (stats: Partial<Gamification>) => void;\r\n  updateSettings: (settings: Partial<UserSettings>) => void;\r\n  addPoints: (points: number) => void;\r\n  incrementStreak: () => void;\r\n  refreshData: () => Promise<void>;\r\n}\r\n\r\nconst UserDataContext = createContext<UserDataContextType | undefined>(undefined);\r\n\r\nexport function useUserData() {\r\n  const context = useContext(UserDataContext);\r\n  if (context === undefined) {\r\n    // Return fallback data during build time\r\n    return {\r\n      user: {\r\n        id: 'fallback',\r\n        username: 'Guest',\r\n        email: 'guest@example.com',\r\n        fullName: 'Guest User',\r\n        avatar: '',\r\n        level: 1,\r\n        points: 0,\r\n        streak: 0,\r\n        badges: [],\r\n        achievements: [],\r\n        joinedAt: new Date(),\r\n        lastActive: new Date(),\r\n        friends: [],\r\n        settings: {\r\n          theme: 'system',\r\n          notifications: {\r\n            email: true,\r\n            push: true,\r\n            dailyDevotional: true,\r\n            friendRequests: true,\r\n            messages: true,\r\n            achievementAlerts: true,\r\n            communityPosts: false,\r\n            readingReminders: true,\r\n            weeklyProgress: true,\r\n          },\r\n          privacy: {\r\n            profileVisibility: 'public',\r\n            showOnlineStatus: true,\r\n            showReadingProgress: true,\r\n            allowFriendRequests: true,\r\n            showAchievements: true,\r\n          },\r\n          reading: {\r\n            fontSize: 'medium',\r\n            translation: 'kjv',\r\n            dailyReminderTime: '08:00',\r\n            autoPlayAudio: false,\r\n            highlightVerses: true,\r\n            showNotes: true,\r\n          },\r\n          community: {\r\n            showInFeed: true,\r\n            allowMentions: true,\r\n            emailNotifications: true,\r\n            pushNotifications: true,\r\n            filterContent: true,\r\n            hideBlockedUsers: true,\r\n          },\r\n        },\r\n      },\r\n      stats: {\r\n        level: 1,\r\n        points: 0,\r\n        streak: 0,\r\n        badges: [],\r\n        leaderboard: [],\r\n      },\r\n      loading: false,\r\n      error: null,\r\n      updateUser: async () => {},\r\n      updateStats: async () => {},\r\n      updateSettings: async () => {},\r\n      addPoints: async () => {},\r\n      incrementStreak: async () => {},\r\n      refreshData: async () => {},\r\n    };\r\n  }\r\n  return context;\r\n}\r\n\r\nexport function UserDataProvider({ children }: { children: React.ReactNode }) {\r\n  const { user: authUser } = useAuth();\r\n  const [user, setUser] = useState<User | null>(null);\r\n  const [stats, setStats] = useState<Gamification | null>(null);\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState<string | null>(null);\r\n\r\n  useEffect(() => {\r\n    const initializeUserData = async () => {\r\n      if (!authUser) {\r\n        setUser(null);\r\n        setStats(null);\r\n        setLoading(false);\r\n        return;\r\n      }\r\n\r\n      try {\r\n        setLoading(true);\r\n        setError(null);\r\n\r\n        // Get or create user profile from Supabase\r\n        let userProfile = await supabaseService.getUserProfile(authUser.id);\r\n        \r\n        if (!userProfile) {\r\n          // Create profile if it doesn't exist\r\n          userProfile = await supabaseService.createUserProfile(authUser);\r\n          if (!userProfile) {\r\n            throw new Error('Failed to create user profile');\r\n          }\r\n        }\r\n\r\n        // Get user stats from Supabase\r\n        const userStats = await supabaseService.getUserStats(authUser.id);\r\n        if (!userStats) {\r\n          throw new Error('Failed to load user stats');\r\n        }\r\n\r\n        // Get user achievements from Supabase\r\n        const userAchievements = await supabaseService.getUserAchievements(authUser.id);\r\n\r\n        // Convert Supabase data to our User type\r\n        const userData: User = {\r\n          id: userProfile.id,\r\n          username: userProfile.username || userProfile.email?.split('@')[0] || 'user',\r\n          email: userProfile.email,\r\n          fullName: userProfile.full_name || '',\r\n          avatar: userProfile.avatar_url || '',\r\n          joinedAt: new Date(userProfile.created_at),\r\n          points: userProfile.points,\r\n          level: userProfile.level,\r\n          streak: userProfile.streak,\r\n          longestStreak: userProfile.longest_streak || 0,\r\n          friends: [],\r\n          achievements: userAchievements.map(ua => ua.achievement).filter(Boolean),\r\n          settings: {\r\n            theme: 'system',\r\n            notifications: {\r\n              email: true,\r\n              push: true,\r\n              dailyDevotional: true,\r\n              friendRequests: true,\r\n              messages: true,\r\n              achievementAlerts: true,\r\n              communityPosts: false,\r\n              readingReminders: true,\r\n              weeklyProgress: true,\r\n            },\r\n            privacy: {\r\n              profileVisibility: 'public',\r\n              showOnlineStatus: true,\r\n              showReadingProgress: true,\r\n              allowFriendRequests: true,\r\n              showAchievements: true,\r\n            },\r\n            reading: {\r\n              fontSize: 'medium',\r\n              translation: 'kjv',\r\n              dailyReminderTime: '08:00',\r\n              autoPlayAudio: false,\r\n              highlightVerses: true,\r\n              showNotes: true,\r\n            },\r\n            community: {\r\n              showInFeed: true,\r\n              allowMentions: true,\r\n              emailNotifications: true,\r\n              pushNotifications: true,\r\n              filterContent: true,\r\n              hideBlockedUsers: true,\r\n            },\r\n          },\r\n        };\r\n\r\n        // Convert stats to Gamification type\r\n        const gamificationData: Gamification = {\r\n          level: userProfile.level,\r\n          points: userProfile.points,\r\n          streak: userProfile.streak,\r\n          badges: [],\r\n          leaderboard: [], // Will be populated from a separate query\r\n        };\r\n\r\n        setUser(userData);\r\n        setStats(gamificationData);\r\n\r\n        // Check for new achievements based on current activity\r\n        try {\r\n          const { newAchievements, pointsAwarded } = await achievementService.checkAndAwardAchievements(authUser.id);\r\n          \r\n          if (newAchievements.length > 0) {\r\n            console.log('New achievements unlocked:', newAchievements);\r\n            console.log('Points awarded:', pointsAwarded);\r\n            \r\n            // Refresh user data to get updated achievements\r\n            const updatedUserAchievements = await supabaseService.getUserAchievements(authUser.id);\r\n            setUser(prev => prev ? {\r\n              ...prev,\r\n              achievements: updatedUserAchievements.map(ua => ua.achievement).filter(Boolean),\r\n            } : null);\r\n          }\r\n        } catch (achievementError) {\r\n          console.error('Error checking achievements:', achievementError);\r\n          // Don't fail the whole user data load if achievements fail\r\n        }\r\n\r\n        // Subscribe to real-time updates\r\n        const profileChannel = supabaseService.subscribeToUser(authUser.id, (profile) => {\r\n          setUser(prev => prev ? { ...prev, ...profile } : null);\r\n        });\r\n\r\n        const statsChannel = supabaseService.subscribeToUserStats(authUser.id, (newStats) => {\r\n          // Update user stats in background, but don't change the Gamification stats\r\n          // since they have a different structure\r\n          console.log('User stats updated:', newStats);\r\n        });\r\n\r\n      } catch (err) {\r\n        console.error('Error initializing user data:', err);\r\n        setError(err instanceof Error ? err.message : 'Failed to load user data');\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    };\r\n\r\n    initializeUserData();\r\n\r\n    return () => {\r\n      supabaseService.unsubscribeAll();\r\n    };\r\n  }, [authUser]);\r\n\r\n  const updateUser = async (userData: Partial<User>) => {\r\n    if (!authUser || !user) return;\r\n\r\n    try {\r\n      const profileUpdates: Partial<UserProfile> = {\r\n        username: userData.username,\r\n        full_name: userData.fullName,\r\n        avatar_url: userData.avatar,\r\n      };\r\n\r\n      const updatedProfile = await supabaseService.updateUserProfile(authUser.id, profileUpdates);\r\n      if (updatedProfile) {\r\n        setUser(prev => prev ? { ...prev, ...userData } : null);\r\n      }\r\n    } catch (err) {\r\n      console.error('Error updating user:', err);\r\n      setError(err instanceof Error ? err.message : 'Failed to update user');\r\n    }\r\n  };\r\n\r\n  const updateStats = (statsData: Partial<Gamification>) => {\r\n    if (stats) {\r\n      setStats({ ...stats, ...statsData });\r\n    }\r\n  };\r\n\r\n  const updateSettings = (settingsData: Partial<UserSettings>) => {\r\n    if (user) {\r\n      setUser({\r\n        ...user,\r\n        settings: { ...user.settings, ...settingsData },\r\n      });\r\n    }\r\n  };\r\n\r\n  const addPoints = async (points: number) => {\r\n    if (!authUser) return;\r\n\r\n    try {\r\n      const updatedProfile = await supabaseService.addPoints(authUser.id, points);\r\n      if (updatedProfile) {\r\n        setUser(prev => prev ? {\r\n          ...prev,\r\n          points: updatedProfile.points,\r\n          level: updatedProfile.level,\r\n        } : null);\r\n        setStats(prev => prev ? {\r\n          ...prev,\r\n          points: updatedProfile.points,\r\n          level: updatedProfile.level,\r\n        } : null);\r\n      }\r\n    } catch (err) {\r\n      console.error('Error adding points:', err);\r\n      setError(err instanceof Error ? err.message : 'Failed to add points');\r\n    }\r\n  };\r\n\r\n  const incrementStreak = async () => {\r\n    if (!authUser || !user) return;\r\n\r\n    try {\r\n      const newStreak = user.streak + 1;\r\n      const updatedProfile = await supabaseService.updateStreak(authUser.id, newStreak);\r\n      if (updatedProfile) {\r\n        setUser(prev => prev ? { ...prev, streak: newStreak } : null);\r\n        setStats(prev => prev ? { ...prev, streak: newStreak } : null);\r\n      }\r\n    } catch (err) {\r\n      console.error('Error updating streak:', err);\r\n      setError(err instanceof Error ? err.message : 'Failed to update streak');\r\n    }\r\n  };\r\n\r\n  const refreshData = async () => {\r\n    if (authUser) {\r\n      try {\r\n        setLoading(true);\r\n        const userProfile = await supabaseService.getUserProfile(authUser.id);\r\n        \r\n        if (userProfile) {\r\n          setUser(prev => prev ? {\r\n            ...prev,\r\n            points: userProfile.points,\r\n            level: userProfile.level,\r\n            streak: userProfile.streak,\r\n            fullName: userProfile.full_name,\r\n            avatar: userProfile.avatar_url || '',\r\n          } : null);\r\n          \r\n          setStats(prev => prev ? {\r\n            ...prev,\r\n            points: userProfile.points,\r\n            level: userProfile.level,\r\n            streak: userProfile.streak,\r\n          } : null);\r\n        }\r\n      } catch (err) {\r\n        console.error('Error refreshing data:', err);\r\n        setError(err instanceof Error ? err.message : 'Failed to refresh data');\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    }\r\n  };\r\n\r\n  const value = {\r\n    user,\r\n    stats,\r\n    loading,\r\n    error,\r\n    updateUser,\r\n    updateStats,\r\n    updateSettings,\r\n    addPoints,\r\n    incrementStreak,\r\n    refreshData,\r\n  };\r\n\r\n  return <UserDataContext.Provider value={value}>{children}</UserDataContext.Provider>;\r\n}\r\n"],"names":["c","_c","React","createContext","useContext","useState","useEffect","User","SupabaseUser","useAuth","supabaseService","UserProfile","UserStats","achievementService","Gamification","UserSettings","UserDataContextType","user","stats","loading","error","updateUser","Partial","updateStats","updateSettings","settings","addPoints","points","incrementStreak","refreshData","Promise","UserDataContext","undefined","useUserData","$","$i","Symbol","for","context","t0","t1","t2","t3","t4","Date","t5","id","username","email","fullName","avatar","level","streak","badges","achievements","joinedAt","lastActive","friends","theme","notifications","push","dailyDevotional","friendRequests","messages","achievementAlerts","communityPosts","readingReminders","weeklyProgress","privacy","profileVisibility","showOnlineStatus","showReadingProgress","allowFriendRequests","showAchievements","reading","fontSize","translation","dailyReminderTime","autoPlayAudio","highlightVerses","showNotes","community","showInFeed","allowMentions","emailNotifications","pushNotifications","filterContent","hideBlockedUsers","t6","leaderboard","_temp","_temp2","_temp3","_temp4","_temp5","_temp6","UserDataProvider","children","ReactNode","authUser","setUser","setStats","setLoading","setError","initializeUserData","userProfile","getUserProfile","createUserProfile","Error","userStats","getUserStats","userAchievements","getUserAchievements","userData","split","full_name","avatar_url","created_at","longestStreak","longest_streak","map","ua","achievement","filter","Boolean","gamificationData","newAchievements","pointsAwarded","checkAndAwardAchievements","length","console","log","updatedUserAchievements","prev","achievementError","profileChannel","subscribeToUser","profile","statsChannel","subscribeToUserStats","newStats","err","message","unsubscribeAll","profileUpdates","updatedProfile","updateUserProfile","statsData","settingsData","newStreak","updateStreak","value"],"mappings":"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","ignoreList":[]}},
    {"offset": {"line": 2380, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/UYI/Downloads/Journey/journey/src/lib/utils.ts"],"sourcesContent":["import { type ClassValue, clsx } from \"clsx\"\r\nimport { twMerge } from \"tailwind-merge\"\r\n\r\nexport function cn(...inputs: ClassValue[]) {\r\n  return twMerge(clsx(inputs))\r\n}\r\n\r\nexport function formatPoints(points: number): string {\r\n  if (points >= 1000000) {\r\n    return `${(points / 1000000).toFixed(1)}M`;\r\n  } else if (points >= 1000) {\r\n    return `${(points / 1000).toFixed(1)}K`;\r\n  }\r\n  return points.toString();\r\n}\r\n\r\nexport function formatDate(date: Date): string {\r\n  return new Intl.DateTimeFormat('en-US', {\r\n    year: 'numeric',\r\n    month: 'long',\r\n    day: 'numeric'\r\n  }).format(date);\r\n}\r\n\r\nexport function formatTimeAgo(date: Date): string {\r\n  const now = new Date();\r\n  const diffInSeconds = Math.floor((now.getTime() - date.getTime()) / 1000);\r\n  \r\n  if (diffInSeconds < 60) {\r\n    return 'just now';\r\n  } else if (diffInSeconds < 3600) {\r\n    const minutes = Math.floor(diffInSeconds / 60);\r\n    return `${minutes} minute${minutes > 1 ? 's' : ''} ago`;\r\n  } else if (diffInSeconds < 86400) {\r\n    const hours = Math.floor(diffInSeconds / 3600);\r\n    return `${hours} hour${hours > 1 ? 's' : ''} ago`;\r\n  } else if (diffInSeconds < 2592000) {\r\n    const days = Math.floor(diffInSeconds / 86400);\r\n    return `${days} day${days > 1 ? 's' : ''} ago`;\r\n  } else {\r\n    return formatDate(date);\r\n  }\r\n}\r\n"],"names":[],"mappings":";;;;;;;;;;AAAA;AACA;;;AAEO,SAAS,GAAG,GAAG,MAAoB;IACxC,OAAO,IAAA,yKAAO,EAAC,IAAA,gJAAI,EAAC;AACtB;AAEO,SAAS,aAAa,MAAc;IACzC,IAAI,UAAU,SAAS;QACrB,OAAO,GAAG,CAAC,SAAS,OAAO,EAAE,OAAO,CAAC,GAAG,CAAC,CAAC;IAC5C,OAAO,IAAI,UAAU,MAAM;QACzB,OAAO,GAAG,CAAC,SAAS,IAAI,EAAE,OAAO,CAAC,GAAG,CAAC,CAAC;IACzC;IACA,OAAO,OAAO,QAAQ;AACxB;AAEO,SAAS,WAAW,IAAU;IACnC,OAAO,IAAI,KAAK,cAAc,CAAC,SAAS;QACtC,MAAM;QACN,OAAO;QACP,KAAK;IACP,GAAG,MAAM,CAAC;AACZ;AAEO,SAAS,cAAc,IAAU;IACtC,MAAM,MAAM,IAAI;IAChB,MAAM,gBAAgB,KAAK,KAAK,CAAC,CAAC,IAAI,OAAO,KAAK,KAAK,OAAO,EAAE,IAAI;IAEpE,IAAI,gBAAgB,IAAI;QACtB,OAAO;IACT,OAAO,IAAI,gBAAgB,MAAM;QAC/B,MAAM,UAAU,KAAK,KAAK,CAAC,gBAAgB;QAC3C,OAAO,GAAG,QAAQ,OAAO,EAAE,UAAU,IAAI,MAAM,GAAG,IAAI,CAAC;IACzD,OAAO,IAAI,gBAAgB,OAAO;QAChC,MAAM,QAAQ,KAAK,KAAK,CAAC,gBAAgB;QACzC,OAAO,GAAG,MAAM,KAAK,EAAE,QAAQ,IAAI,MAAM,GAAG,IAAI,CAAC;IACnD,OAAO,IAAI,gBAAgB,SAAS;QAClC,MAAM,OAAO,KAAK,KAAK,CAAC,gBAAgB;QACxC,OAAO,GAAG,KAAK,IAAI,EAAE,OAAO,IAAI,MAAM,GAAG,IAAI,CAAC;IAChD,OAAO;QACL,OAAO,WAAW;IACpB;AACF"}},
    {"offset": {"line": 2437, "column": 0}, "map": {"version":3,"sources":["C:/Users/UYI/Downloads/Journey/journey/src/components/layout/ResponsiveLayout.tsx"],"sourcesContent":["'use client'\r\n\r\nimport React from 'react'\r\nimport { cn } from '@/lib/utils'\r\n\r\ninterface ResponsiveLayoutProps {\r\n  children: React.ReactNode\r\n  className?: string\r\n  maxWidth?: 'sm' | 'md' | 'lg' | 'xl' | '2xl' | 'full'\r\n  padding?: 'none' | 'sm' | 'md' | 'lg'\r\n}\r\n\r\nexport function ResponsiveLayout({\r\n  children,\r\n  className,\r\n  maxWidth = '2xl',\r\n  padding = 'md'\r\n}: ResponsiveLayoutProps) {\r\n  const getMaxWidthClass = () => {\r\n    switch (maxWidth) {\r\n      case 'sm': return 'max-w-sm'\r\n      case 'md': return 'max-w-md'\r\n      case 'lg': return 'max-w-lg'\r\n      case 'xl': return 'max-w-xl'\r\n      case '2xl': return 'max-w-2xl'\r\n      case 'full': return 'max-w-full'\r\n      default: return 'max-w-2xl'\r\n    }\r\n  }\r\n\r\n  const getPaddingClass = () => {\r\n    switch (padding) {\r\n      case 'none': return 'px-0'\r\n      case 'sm': return 'px-4 sm:px-6'\r\n      case 'md': return 'px-4 sm:px-6 lg:px-8'\r\n      case 'lg': return 'px-6 sm:px-8 lg:px-12'\r\n      default: return 'px-4 sm:px-6 lg:px-8'\r\n    }\r\n  }\r\n\r\n  return (\r\n    <div className={cn(\r\n      'w-full mx-auto',\r\n      getMaxWidthClass(),\r\n      getPaddingClass(),\r\n      className\r\n    )}>\r\n      {children}\r\n    </div>\r\n  )\r\n}\r\n\r\n// Grid system for responsive layouts\r\ninterface ResponsiveGridProps {\r\n  children: React.ReactNode\r\n  className?: string\r\n  cols?: {\r\n    mobile?: 1 | 2 | 3 | 4\r\n    tablet?: 1 | 2 | 3 | 4\r\n    desktop?: 1 | 2 | 3 | 4 | 5 | 6\r\n  }\r\n  gap?: 'sm' | 'md' | 'lg'\r\n}\r\n\r\nexport function ResponsiveGrid({\r\n  children,\r\n  className,\r\n  cols = { mobile: 1, tablet: 2, desktop: 3 },\r\n  gap = 'md'\r\n}: ResponsiveGridProps) {\r\n  const getColsClass = () => {\r\n    const mobileClass = cols.mobile ? `grid-cols-${cols.mobile}` : 'grid-cols-1'\r\n    const tabletClass = cols.tablet ? `sm:grid-cols-${cols.tablet}` : 'sm:grid-cols-2'\r\n    const desktopClass = cols.desktop ? `lg:grid-cols-${cols.desktop}` : 'lg:grid-cols-3'\r\n    \r\n    return `${mobileClass} ${tabletClass} ${desktopClass}`\r\n  }\r\n\r\n  const getGapClass = () => {\r\n    switch (gap) {\r\n      case 'sm': return 'gap-2 sm:gap-3'\r\n      case 'md': return 'gap-4 sm:gap-6'\r\n      case 'lg': return 'gap-6 sm:gap-8'\r\n      default: return 'gap-4 sm:gap-6'\r\n    }\r\n  }\r\n\r\n  return (\r\n    <div className={cn(\r\n      'grid',\r\n      getColsClass(),\r\n      getGapClass(),\r\n      className\r\n    )}>\r\n      {children}\r\n    </div>\r\n  )\r\n}\r\n\r\n// Mobile-first container\r\nexport function MobileContainer({\r\n  children,\r\n  className\r\n}: {\r\n  children: React.ReactNode\r\n  className?: string\r\n}) {\r\n  return (\r\n    <div className={cn(\r\n      'min-h-screen bg-background',\r\n      // Mobile safe areas\r\n      'pb-safe-or-4',\r\n      // Touch-friendly spacing\r\n      'touch-manipulation',\r\n      className\r\n    )}>\r\n      {children}\r\n    </div>\r\n  )\r\n}\r\n\r\n// Responsive text component\r\ninterface ResponsiveTextProps {\r\n  children: React.ReactNode\r\n  className?: string\r\n  size?: 'xs' | 'sm' | 'md' | 'lg' | 'xl' | '2xl' | '3xl'\r\n  weight?: 'normal' | 'medium' | 'semibold' | 'bold'\r\n  color?: 'primary' | 'secondary' | 'muted' | 'accent'\r\n}\r\n\r\nexport function ResponsiveText({\r\n  children,\r\n  className,\r\n  size = 'md',\r\n  weight = 'normal',\r\n  color = 'primary'\r\n}: ResponsiveTextProps) {\r\n  const getSizeClass = () => {\r\n    switch (size) {\r\n      case 'xs': return 'text-xs sm:text-sm'\r\n      case 'sm': return 'text-sm sm:text-base'\r\n      case 'md': return 'text-base sm:text-lg'\r\n      case 'lg': return 'text-lg sm:text-xl'\r\n      case 'xl': return 'text-xl sm:text-2xl'\r\n      case '2xl': return 'text-2xl sm:text-3xl'\r\n      case '3xl': return 'text-3xl sm:text-4xl'\r\n      default: return 'text-base sm:text-lg'\r\n    }\r\n  }\r\n\r\n  const getWeightClass = () => {\r\n    switch (weight) {\r\n      case 'normal': return 'font-normal'\r\n      case 'medium': return 'font-medium'\r\n      case 'semibold': return 'font-semibold'\r\n      case 'bold': return 'font-bold'\r\n      default: return 'font-normal'\r\n    }\r\n  }\r\n\r\n  const getColorClass = () => {\r\n    switch (color) {\r\n      case 'primary': return 'text-foreground'\r\n      case 'secondary': return 'text-muted-foreground'\r\n      case 'muted': return 'text-gray-500'\r\n      case 'accent': return 'text-primary'\r\n      default: return 'text-foreground'\r\n    }\r\n  }\r\n\r\n  return (\r\n    <span className={cn(\r\n      'leading-relaxed',\r\n      getSizeClass(),\r\n      getWeightClass(),\r\n      getColorClass(),\r\n      className\r\n    )}>\r\n      {children}\r\n    </span>\r\n  )\r\n}\r\n"],"names":["c","_c","React","cn","ResponsiveLayoutProps","children","ReactNode","className","maxWidth","padding","ResponsiveLayout","t0","$","$i","Symbol","for","t1","t2","undefined","t3","ResponsiveLayout[getMaxWidthClass]","getMaxWidthClass","t4","ResponsiveLayout[getPaddingClass]","getPaddingClass","t5","t6","ResponsiveGridProps","cols","mobile","tablet","desktop","gap","ResponsiveGrid","ResponsiveGrid[getColsClass]","mobileClass","tabletClass","desktopClass","getColsClass","ResponsiveGrid[getGapClass]","getGapClass","t7","MobileContainer","ResponsiveTextProps","size","weight","color","ResponsiveText","ResponsiveText[getSizeClass]","getSizeClass","ResponsiveText[getWeightClass]","getWeightClass","ResponsiveText[getColorClass]","getColorClass","t8"],"mappings":"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","ignoreList":[]}}]
}