(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,41071,e=>{"use strict";let s=(0,e.i(75254).default)("ellipsis",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]]);e.s(["MoreHorizontal",()=>s],41071)},24687,e=>{"use strict";var s=e.i(43476),t=e.i(71645),a=e.i(75157);let r=t.forwardRef(({className:e,...t},r)=>(0,s.jsx)("textarea",{className:(0,a.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),ref:r,...t}));r.displayName="Textarea",e.s(["Textarea",()=>r])},94983,e=>{"use strict";let s=(0,e.i(75254).default)("message-circle",[["path",{d:"M2.992 16.342a2 2 0 0 1 .094 1.167l-1.065 3.29a1 1 0 0 0 1.236 1.168l3.413-.998a2 2 0 0 1 1.099.092 10 10 0 1 0-4.777-4.719",key:"1sd12s"}]]);e.s(["MessageCircle",()=>s],94983)},14764,e=>{"use strict";let s=(0,e.i(75254).default)("send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]);e.s(["Send",()=>s],14764)},62031,e=>{"use strict";let s=(0,e.i(75254).default)("share-2",[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]]);e.s(["Share2",()=>s],62031)},48,e=>{"use strict";var s=e.i(43476),t=e.i(71645),a=e.i(90597),r=e.i(94983),i=e.i(62031),l=e.i(14764),n=e.i(19455),c=e.i(24687),d=e.i(99676),o=e.i(46462),m=e.i(27142);class u{static instance;static getInstance(){return u.instance||(u.instance=new u),u.instance}async toggleLike(e,s,t){try{let{data:a}=await m.supabaseService.getClient().from("likes").select("id").eq("user_id",t).eq("target_id",e).eq("target_type",s).maybeSingle();if(a)return await m.supabaseService.getClient().from("likes").delete().eq("user_id",t).eq("target_id",e).eq("target_type",s),await this.updateCount(e,s,"likes_count",-1),{liked:!1,count:await this.getCount(e,s,"likes_count")};return await m.supabaseService.getClient().from("likes").insert({user_id:t,target_id:e,target_type:s}),await this.updateCount(e,s,"likes_count",1),{liked:!0,count:await this.getCount(e,s,"likes_count")}}catch(e){throw console.error("Error toggling like:",e),e}}async hasUserLiked(e,s,t){try{let{data:a}=await m.supabaseService.getClient().from("likes").select("id").eq("user_id",t).eq("target_id",e).eq("target_type",s).maybeSingle();return!!a}catch(e){return console.error("Error checking like status:",e),!1}}async addComment(e,s,t,a){try{let{data:r,error:i}=await m.supabaseService.getClient().from("comments").insert({user_id:t,target_id:e,target_type:s,content:a.trim()}).select(`
          *,
          user:users(id, username, full_name, avatar_url)
        `).single();if(i)throw i;return await this.updateCount(e,s,"comments_count",1),r}catch(e){throw console.error("Error adding comment:",e),e}}async getComments(e,s){try{let{data:t,error:a}=await m.supabaseService.getClient().from("comments").select(`
          *,
          user:users(id, username, full_name, avatar_url)
        `).eq("target_id",e).eq("target_type",s).order("created_at",{ascending:!0});if(a)throw a;return t||[]}catch(e){return console.error("Error fetching comments:",e),[]}}async share(e,s,t){try{return await m.supabaseService.getClient().from("shares").insert({user_id:t,target_id:e,target_type:s}),await this.updateCount(e,s,"shares_count",1),{count:await this.getCount(e,s,"shares_count")}}catch(e){throw console.error("Error recording share:",e),e}}async getCount(e,s,t){try{let a="";switch(s){case"post":a="community_posts";break;case"devotional":a="devotionals";break;case"prayer":a="prayer_requests";break;default:return 0}let{data:r}=await m.supabaseService.getClient().from(a).select(t).eq("id",e).single();return r?.[t]||0}catch(e){return console.error("Error getting count:",e),0}}async updateCount(e,s,t,a){try{let r="";switch(s){case"post":r="community_posts";break;case"devotional":r="devotionals";break;case"prayer":r="prayer_requests";break;default:return}let{error:i}=await m.supabaseService.getClient().rpc("increment_count",{table_name:r,record_id:e,column_name:t,increment_value:a});if(i){let{data:s}=await m.supabaseService.getClient().from(r).select(t).eq("id",e).single();if(s){let i=Math.max(0,(s[t]||0)+a);await m.supabaseService.getClient().from(r).update({[t]:i}).eq("id",e)}}}catch(e){console.error("Error updating count:",e)}}async getUserSocialActivity(e){try{let[s,t,a]=await Promise.all([m.supabaseService.getClient().from("likes").select(`
            *,
            target:community_posts(id, content, created_at)
          `).eq("user_id",e).order("created_at",{ascending:!1}).limit(10),m.supabaseService.getClient().from("comments").select(`
            *,
            target:community_posts(id, content, created_at)
          `).eq("user_id",e).order("created_at",{ascending:!1}).limit(10),m.supabaseService.getClient().from("shares").select(`
            *,
            target:community_posts(id, content, created_at)
          `).eq("user_id",e).order("created_at",{ascending:!1}).limit(10)]);return{likes:s.data||[],comments:t.data||[],shares:a.data||[]}}catch(e){return console.error("Error fetching user social activity:",e),{likes:[],comments:[],shares:[]}}}}let x=u.getInstance();var h=e.i(75157);function f({targetId:e,targetType:m,initialLikes:u=0,initialComments:f=0,initialShares:g=0,showComments:p=!0,className:j=""}){let{user:v}=(0,o.useAuth)(),[y,N]=(0,t.useState)(!1),[b,w]=(0,t.useState)(u),[C,_]=(0,t.useState)(f),[S,k]=(0,t.useState)(g),[A,T]=(0,t.useState)(!1),[q,B]=(0,t.useState)(!1),[F,E]=(0,t.useState)(!1),[P,z]=(0,t.useState)([]),[L,M]=(0,t.useState)(!1),[D,I]=(0,t.useState)(""),[O,U]=(0,t.useState)(!1);(0,t.useEffect)(()=>{N(!0)},[]),(0,t.useEffect)(()=>{v&&y&&x.hasUserLiked(e,m,v.id).then(T)},[e,m,v,y]),(0,t.useEffect)(()=>{L&&p&&y&&H()},[L,e,m,p,y]);let H=async()=>{try{let s=await x.getComments(e,m);z(s),_(s.length)}catch(e){console.error("Error loading comments:",e)}},R=async()=>{if(!v||q||!y)return;B(!0);let s=!A,t=s?b+1:Math.max(0,b-1);T(s),w(t);try{let s=await x.toggleLike(e,m,v.id);w(s.count),T(s.liked)}catch(e){console.error("Error toggling like:",e),T(!s),w(b)}finally{B(!1)}},$=async()=>{if(v&&!F&&y){E(!0);try{let s=await x.share(e,m,v.id);k(s.count),navigator.share&&await navigator.share({title:`Check out this ${m}`,text:`Found this amazing ${m} on Journey!`,url:window.location.href})}catch(e){console.error("Error sharing:",e)}finally{E(!1)}}},V=async()=>{if(v&&D.trim()&&!O&&y){U(!0);try{let s=await x.addComment(e,m,v.id,D);z([s,...P]),_(e=>e+1),I("")}catch(e){console.error("Error adding comment:",e)}finally{U(!1)}}};return(0,s.jsxs)("div",{className:`space-y-4 ${j}`,children:[(0,s.jsx)("div",{className:"flex items-center justify-between pt-4 border-t",children:(0,s.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,s.jsxs)(n.Button,{variant:"ghost",size:"sm",className:`text-muted-foreground hover:text-red-500 transition-colors ${A?"text-red-500":""}`,onClick:R,disabled:!v||q,children:[(0,s.jsx)(a.Heart,{className:`h-4 w-4 mr-1 ${A?"fill-current":""}`}),b]}),p&&(0,s.jsxs)(n.Button,{variant:"ghost",size:"sm",className:"text-muted-foreground hover:text-blue-500 transition-colors",onClick:()=>M(!L),children:[(0,s.jsx)(r.MessageCircle,{className:"h-4 w-4 mr-1"}),C]}),(0,s.jsxs)(n.Button,{variant:"ghost",size:"sm",className:"text-muted-foreground hover:text-green-500 transition-colors",onClick:$,disabled:!v||F,children:[(0,s.jsx)(i.Share2,{className:"h-4 w-4 mr-1"}),S]})]})}),p&&L&&(0,s.jsxs)("div",{className:"space-y-4 border-t pt-4",children:[v&&(0,s.jsxs)("div",{className:"flex space-x-3",children:[(0,s.jsxs)(d.Avatar,{className:"h-8 w-8",children:[(0,s.jsx)(d.AvatarImage,{src:v.user_metadata?.avatar_url}),(0,s.jsx)(d.AvatarFallback,{children:v.email?.charAt(0)})]}),(0,s.jsxs)("div",{className:"flex-1 space-y-2",children:[(0,s.jsx)(c.Textarea,{placeholder:"Share your thoughts...",value:D,onChange:e=>I(e.target.value),className:"min-h-[60px] resize-none"}),(0,s.jsx)("div",{className:"flex justify-end",children:(0,s.jsxs)(n.Button,{size:"sm",onClick:V,disabled:!D.trim()||O,children:[(0,s.jsx)(l.Send,{className:"h-4 w-4 mr-1"}),O?"Posting...":"Post"]})})]})]}),(0,s.jsx)("div",{className:"space-y-3",children:0===P.length?(0,s.jsx)("div",{className:"text-center py-4 text-muted-foreground",children:"No comments yet. Be the first to share your thoughts!"}):P.map(e=>(0,s.jsxs)("div",{className:"flex space-x-3",children:[(0,s.jsxs)(d.Avatar,{className:"h-8 w-8",children:[(0,s.jsx)(d.AvatarImage,{src:e.user?.avatar_url}),(0,s.jsx)(d.AvatarFallback,{children:e.user?.full_name?.charAt(0)||e.user?.username?.charAt(0)||"U"})]}),(0,s.jsxs)("div",{className:"flex-1 space-y-1",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)("span",{className:"font-medium text-sm",children:e.user?.full_name||e.user?.username||"Anonymous"}),(0,s.jsx)("span",{className:"text-xs text-muted-foreground",children:(0,h.formatTimeAgo)(new Date(e.created_at))})]}),(0,s.jsx)("p",{className:"text-sm text-gray-700",children:e.content})]})]},e.id))})]})]})}e.s(["SocialInteraction",()=>f],48)},7233,87130,e=>{"use strict";var s=e.i(75254);let t=(0,s.default)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);e.s(["Plus",()=>t],7233);let a=(0,s.default)("funnel",[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]]);e.s(["Filter",()=>a],87130)},58709,e=>{"use strict";var s=e.i(43476),t=e.i(932),a=e.i(46462),r=e.i(19455),i=e.i(15288),l=e.i(22016),n=e.i(4997),c=e.i(90597),d=e.i(94983),o=e.i(79002);let m=(0,e.i(75254).default)("pen-tool",[["path",{d:"M15.707 21.293a1 1 0 0 1-1.414 0l-1.586-1.586a1 1 0 0 1 0-1.414l5.586-5.586a1 1 0 0 1 1.414 0l1.586 1.586a1 1 0 0 1 0 1.414z",key:"nt11vn"}],["path",{d:"m18 13-1.375-6.874a1 1 0 0 0-.746-.776L3.235 2.028a1 1 0 0 0-1.207 1.207L5.35 15.879a1 1 0 0 0 .776.746L13 18",key:"15qc1e"}],["path",{d:"m2.3 2.3 7.286 7.286",key:"1wuzzi"}],["circle",{cx:"11",cy:"11",r:"2",key:"xmgehs"}]]);function u(e){let u,x,h,f,g,p,j=(0,t.c)(16),{children:v,action:y,fallback:N}=e,{user:b}=(0,a.useAuth)();if(b){let e;return j[0]!==v?(e=(0,s.jsx)(s.Fragment,{children:v}),j[0]=v,j[1]=e):e=j[1],e}if(N){let e;return j[2]!==N?(e=(0,s.jsx)(s.Fragment,{children:N}),j[2]=N,j[3]=e):e=j[3],e}j[4]===Symbol.for("react.memo_cache_sentinel")?(u={post:{title:"Sign in to Post",description:"Join our community to share your thoughts and devotionals",icon:m},comment:{title:"Sign in to Comment",description:"Share your thoughts and engage with the community",icon:d.MessageCircle},like:{title:"Sign in to Like",description:"Show appreciation for posts that inspire you",icon:c.Heart},friend:{title:"Sign in to Add Friends",description:"Connect with others on their spiritual journey",icon:o.UserPlus},devotional:{title:"Sign in to Create Devotionals",description:"Share your insights and inspire others",icon:m}},j[4]=u):u=j[4];let w=u[y],C=w.icon;return j[5]!==C?(x=(0,s.jsx)("div",{className:"mx-auto w-12 h-12 bg-primary/10 rounded-full flex items-center justify-center mb-4",children:(0,s.jsx)(C,{className:"h-6 w-6 text-primary"})}),j[5]=C,j[6]=x):x=j[6],j[7]!==w.title?(h=(0,s.jsx)(i.CardTitle,{className:"text-lg mb-2",children:w.title}),j[7]=w.title,j[8]=h):h=j[8],j[9]!==w.description?(f=(0,s.jsx)(i.CardDescription,{className:"mb-4",children:w.description}),j[9]=w.description,j[10]=f):f=j[10],j[11]===Symbol.for("react.memo_cache_sentinel")?(g=(0,s.jsx)(l.default,{href:"/auth",children:(0,s.jsxs)(r.Button,{className:"w-full",children:[(0,s.jsx)(n.LogIn,{className:"mr-2 h-4 w-4"}),"Sign In to Continue"]})}),j[11]=g):g=j[11],j[12]!==x||j[13]!==h||j[14]!==f?(p=(0,s.jsx)(i.Card,{className:"border-dashed border-muted-foreground/30 bg-muted/30",children:(0,s.jsxs)(i.CardContent,{className:"p-6 text-center",children:[x,h,f,g]})}),j[12]=x,j[13]=h,j[14]=f,j[15]=p):p=j[15],p}e.s(["AuthGuard",()=>u],58709)},97960,e=>{"use strict";let s=(0,e.i(75254).default)("smile",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 14s1.5 2 4 2 4-2 4-2",key:"1y1vjs"}],["line",{x1:"9",x2:"9.01",y1:"9",y2:"9",key:"yxxnd0"}],["line",{x1:"15",x2:"15.01",y1:"9",y2:"9",key:"1p4y9e"}]]);e.s(["Smile",()=>s],97960)},76639,e=>{"use strict";var s=e.i(43476),t=e.i(932),a=e.i(71645),r=e.i(26999),i=e.i(37727),l=e.i(75157);let n=r.Root,c=r.Trigger,d=r.Portal;r.Close;let o=a.forwardRef((e,a)=>{let i,n,c,d,o=(0,t.c)(9);return o[0]!==e?({className:i,...n}=e,o[0]=e,o[1]=i,o[2]=n):(i=o[1],n=o[2]),o[3]!==i?(c=(0,l.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",i),o[3]=i,o[4]=c):c=o[4],o[5]!==n||o[6]!==a||o[7]!==c?(d=(0,s.jsx)(r.Overlay,{ref:a,className:c,...n}),o[5]=n,o[6]=a,o[7]=c,o[8]=d):d=o[8],d});o.displayName=r.Overlay.displayName;let m=a.forwardRef((e,a)=>{let n,c,m,u,x,h,f,g=(0,t.c)(13);return g[0]!==e?({className:c,children:n,...m}=e,g[0]=e,g[1]=n,g[2]=c,g[3]=m):(n=g[1],c=g[2],m=g[3]),g[4]===Symbol.for("react.memo_cache_sentinel")?(u=(0,s.jsx)(o,{}),g[4]=u):u=g[4],g[5]!==c?(x=(0,l.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",c),g[5]=c,g[6]=x):x=g[6],g[7]===Symbol.for("react.memo_cache_sentinel")?(h=(0,s.jsxs)(r.Close,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,s.jsx)(i.X,{className:"h-4 w-4"}),(0,s.jsx)("span",{className:"sr-only",children:"Close"})]}),g[7]=h):h=g[7],g[8]!==n||g[9]!==m||g[10]!==a||g[11]!==x?(f=(0,s.jsxs)(d,{children:[u,(0,s.jsxs)(r.Content,{ref:a,className:x,...m,children:[n,h]})]}),g[8]=n,g[9]=m,g[10]=a,g[11]=x,g[12]=f):f=g[12],f});m.displayName=r.Content.displayName;let u=e=>{let a,r,i,n,c=(0,t.c)(8);return c[0]!==e?({className:a,...r}=e,c[0]=e,c[1]=a,c[2]=r):(a=c[1],r=c[2]),c[3]!==a?(i=(0,l.cn)("flex flex-col space-y-1.5 text-center sm:text-left",a),c[3]=a,c[4]=i):i=c[4],c[5]!==r||c[6]!==i?(n=(0,s.jsx)("div",{className:i,...r}),c[5]=r,c[6]=i,c[7]=n):n=c[7],n};u.displayName="DialogHeader";let x=a.forwardRef((e,a)=>{let i,n,c,d,o=(0,t.c)(9);return o[0]!==e?({className:i,...n}=e,o[0]=e,o[1]=i,o[2]=n):(i=o[1],n=o[2]),o[3]!==i?(c=(0,l.cn)("text-lg font-semibold leading-none tracking-tight",i),o[3]=i,o[4]=c):c=o[4],o[5]!==n||o[6]!==a||o[7]!==c?(d=(0,s.jsx)(r.Title,{ref:a,className:c,...n}),o[5]=n,o[6]=a,o[7]=c,o[8]=d):d=o[8],d});x.displayName=r.Title.displayName,a.forwardRef((e,a)=>{let i,n,c,d,o=(0,t.c)(9);return o[0]!==e?({className:i,...n}=e,o[0]=e,o[1]=i,o[2]=n):(i=o[1],n=o[2]),o[3]!==i?(c=(0,l.cn)("text-sm text-muted-foreground",i),o[3]=i,o[4]=c):c=o[4],o[5]!==n||o[6]!==a||o[7]!==c?(d=(0,s.jsx)(r.Description,{ref:a,className:c,...n}),o[5]=n,o[6]=a,o[7]=c,o[8]=d):d=o[8],d}).displayName=r.Description.displayName,e.s(["Dialog",()=>n,"DialogContent",()=>m,"DialogHeader",()=>u,"DialogTitle",()=>x,"DialogTrigger",()=>c])},79110,e=>{"use strict";var s=e.i(43476),t=e.i(932),a=e.i(15288),r=e.i(19455),i=e.i(99676),l=e.i(87486),n=e.i(41071),c=e.i(75157),d=e.i(48);function o(e){let l,o,u,x,h,f,g,p,j,v,y,N,b,w,C,_,S,k=(0,t.c)(44),{post:A,authorName:T,authorAvatar:q}=e;k[0]!==q?(l=(0,s.jsx)(i.AvatarImage,{src:q}),k[0]=q,k[1]=l):l=k[1],k[2]!==T?(o=T.charAt(0),k[2]=T,k[3]=o):o=k[3],k[4]!==o?(u=(0,s.jsx)(i.AvatarFallback,{children:o}),k[4]=o,k[5]=u):u=k[5],k[6]!==l||k[7]!==u?(x=(0,s.jsxs)(i.Avatar,{className:"h-10 w-10",children:[l,u]}),k[6]=l,k[7]=u,k[8]=x):x=k[8],k[9]!==T?(h=(0,s.jsx)("div",{className:"font-medium",children:T}),k[9]=T,k[10]=h):h=k[10],k[11]!==A.created_at?(f=A.created_at?(0,c.formatTimeAgo)(new Date(A.created_at)):"Just now",k[11]=A.created_at,k[12]=f):f=k[12],k[13]!==f?(g=(0,s.jsx)("div",{className:"text-sm text-muted-foreground",children:f}),k[13]=f,k[14]=g):g=k[14],k[15]!==h||k[16]!==g?(p=(0,s.jsxs)("div",{children:[h,g]}),k[15]=h,k[16]=g,k[17]=p):p=k[17],k[18]!==x||k[19]!==p?(j=(0,s.jsxs)("div",{className:"flex items-center space-x-3",children:[x,p]}),k[18]=x,k[19]=p,k[20]=j):j=k[20],k[21]===Symbol.for("react.memo_cache_sentinel")?(v=(0,s.jsx)(r.Button,{variant:"ghost",size:"icon",children:(0,s.jsx)(n.MoreHorizontal,{className:"h-4 w-4"})}),k[21]=v):v=k[21],k[22]!==j?(y=(0,s.jsxs)("div",{className:"flex items-start justify-between mb-4",children:[j,v]}),k[22]=j,k[23]=y):y=k[23],k[24]!==A.content?(N=(0,s.jsx)("p",{className:"text-sm leading-relaxed",children:A.content}),k[24]=A.content,k[25]=N):N=k[25],k[26]!==A.verse_reference||k[27]!==A.verse_text?(b=A.verse_reference&&A.verse_text&&(0,s.jsx)("div",{className:"bg-muted/50 p-3 rounded-lg border-l-4 border-primary",children:(0,s.jsxs)("p",{className:"text-sm italic text-muted-foreground",children:['"',A.verse_text,'" - ',A.verse_reference]})}),k[26]=A.verse_reference,k[27]=A.verse_text,k[28]=b):b=k[28],k[29]!==A.tags?(w=A.tags&&A.tags.length>0&&(0,s.jsx)("div",{className:"flex flex-wrap gap-2",children:A.tags.map(m)}),k[29]=A.tags,k[30]=w):w=k[30],k[31]!==N||k[32]!==b||k[33]!==w?(C=(0,s.jsxs)("div",{className:"space-y-3",children:[N,b,w]}),k[31]=N,k[32]=b,k[33]=w,k[34]=C):C=k[34];let B=A.likes_count||0,F=A.comments_count||0,E=A.shares_count||0;return k[35]!==A.id||k[36]!==B||k[37]!==F||k[38]!==E?(_=(0,s.jsx)(d.SocialInteraction,{targetId:A.id,targetType:"post",initialLikes:B,initialComments:F,initialShares:E,showComments:!0}),k[35]=A.id,k[36]=B,k[37]=F,k[38]=E,k[39]=_):_=k[39],k[40]!==y||k[41]!==C||k[42]!==_?(S=(0,s.jsx)(a.Card,{className:"w-full",children:(0,s.jsxs)(a.CardContent,{className:"p-6",children:[y,C,_]})}),k[40]=y,k[41]=C,k[42]=_,k[43]=S):S=k[43],S}function m(e,t){return(0,s.jsxs)(l.Badge,{variant:"secondary",className:"text-xs",children:["#",e]},t)}e.s(["CommunityPost",()=>o])},39584,e=>{"use strict";var s=e.i(43476),t=e.i(71645),a=e.i(85665),r=e.i(79110),i=e.i(19455),l=e.i(93479),n=e.i(15288),c=e.i(99676),d=e.i(58709),o=e.i(61911),m=e.i(79002),u=e.i(55436),x=e.i(94983),h=e.i(46462),f=e.i(27142);function g(){let{user:e}=(0,h.useAuth)(),[a,r]=(0,t.useState)(""),[g,p]=(0,t.useState)(!1),[j,v]=(0,t.useState)("all"),[y,N]=(0,t.useState)([]),[b,w]=(0,t.useState)([]),[C,_]=(0,t.useState)([]),[S,k]=(0,t.useState)(!1),A=async()=>{if(e)try{let{data:s}=await f.supabaseService.getClient().from("friends").select(`
          *,
          friend:users(id, username, full_name, avatar_url, points, level, streak)
        `).or(`user_id.eq.${e.id},friend_id.eq.${e.id}`).eq("status","accepted"),{data:t}=await f.supabaseService.getClient().from("friends").select(`
          *,
          user:users(id, username, full_name, avatar_url, points, level, streak)
        `).eq("friend_id",e.id).eq("status","pending");N(s||[]),w(t||[])}catch(e){console.error("Error fetching friends:",e)}},T=async s=>{if(!s.trim()||!e)return void _([]);try{k(!0);let{data:t}=await f.supabaseService.getClient().from("users").select("id, username, full_name, avatar_url, points, level, streak").ilike("username",`%${s}%`).neq("id",e.id).limit(10);_(t||[])}catch(e){console.error("Error searching users:",e)}finally{k(!1)}},q=async s=>{if(e)try{let{error:t}=await f.supabaseService.getClient().from("friends").insert({user_id:e.id,friend_id:s,status:"pending"});if(t)throw t;_(e=>e.filter(e=>e.id!==s))}catch(e){console.error("Error sending friend request:",e)}},B=async e=>{try{let{error:s}=await f.supabaseService.getClient().from("friends").update({status:"accepted"}).eq("id",e);if(s)throw s;A()}catch(e){console.error("Error accepting friend request:",e)}};return(0,t.useEffect)(()=>{e&&A()},[e]),(0,t.useEffect)(()=>{let e=setTimeout(()=>{T(a)},300);return()=>clearTimeout(e)},[a]),(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{className:"text-2xl font-bold",children:"Friends"}),(0,s.jsx)("p",{className:"text-muted-foreground",children:"Connect with fellow believers on their spiritual journey"})]}),(0,s.jsx)(d.AuthGuard,{action:"friend",children:(0,s.jsxs)(i.Button,{children:[(0,s.jsx)(m.UserPlus,{className:"mr-2 h-4 w-4"}),"Find Friends"]})})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[(0,s.jsx)(n.Card,{children:(0,s.jsxs)(n.CardContent,{className:"p-4 text-center",children:[(0,s.jsx)("div",{className:"text-2xl font-bold text-blue-500",children:y.length}),(0,s.jsx)("div",{className:"text-sm text-muted-foreground",children:"Total Friends"})]})}),(0,s.jsx)(n.Card,{children:(0,s.jsxs)(n.CardContent,{className:"p-4 text-center",children:[(0,s.jsx)("div",{className:"text-2xl font-bold text-green-500",children:b.length}),(0,s.jsx)("div",{className:"text-sm text-muted-foreground",children:"Friend Requests"})]})}),(0,s.jsx)(n.Card,{children:(0,s.jsxs)(n.CardContent,{className:"p-4 text-center",children:[(0,s.jsx)("div",{className:"text-2xl font-bold text-purple-500",children:"0"}),(0,s.jsx)("div",{className:"text-sm text-muted-foreground",children:"Online Now"})]})})]}),(0,s.jsxs)(n.Card,{children:[(0,s.jsx)(n.CardHeader,{children:(0,s.jsx)(n.CardTitle,{children:"Find Friends"})}),(0,s.jsxs)(n.CardContent,{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)(u.Search,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),(0,s.jsx)(l.Input,{placeholder:"Search for users by username...",value:a,onChange:e=>r(e.target.value),className:"pl-10"})]}),S&&(0,s.jsx)("div",{className:"text-center py-4",children:(0,s.jsx)("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-primary mx-auto"})}),C.length>0&&(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("h4",{className:"font-medium",children:"Search Results"}),C.map(e=>(0,s.jsxs)("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,s.jsxs)(c.Avatar,{className:"h-8 w-8",children:[(0,s.jsx)(c.AvatarImage,{src:e.avatar_url}),(0,s.jsx)(c.AvatarFallback,{children:e.username?.charAt(0)||"U"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"font-medium",children:e.full_name||e.username}),(0,s.jsxs)("div",{className:"text-sm text-muted-foreground",children:["Level ",e.level," • ",e.points," points"]})]})]}),(0,s.jsxs)(i.Button,{size:"sm",onClick:()=>q(e.id),children:[(0,s.jsx)(m.UserPlus,{className:"h-4 w-4 mr-1"}),"Add Friend"]})]},e.id))]})]})]}),b.length>0&&(0,s.jsxs)(n.Card,{children:[(0,s.jsx)(n.CardHeader,{children:(0,s.jsx)(n.CardTitle,{children:"Friend Requests"})}),(0,s.jsx)(n.CardContent,{className:"space-y-2",children:b.map(e=>(0,s.jsxs)("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,s.jsxs)(c.Avatar,{className:"h-8 w-8",children:[(0,s.jsx)(c.AvatarImage,{src:e.user?.avatar_url}),(0,s.jsx)(c.AvatarFallback,{children:e.user?.username?.charAt(0)||"U"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"font-medium",children:e.user?.full_name||e.user?.username}),(0,s.jsxs)("div",{className:"text-sm text-muted-foreground",children:["Level ",e.user?.level," • ",e.user?.points," points"]})]})]}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)(i.Button,{size:"sm",onClick:()=>B(e.id),children:"Accept"}),(0,s.jsx)(i.Button,{size:"sm",variant:"outline",children:"Decline"})]})]},e.id))})]}),y.length>0&&(0,s.jsxs)(n.Card,{children:[(0,s.jsx)(n.CardHeader,{children:(0,s.jsx)(n.CardTitle,{children:"Your Friends"})}),(0,s.jsx)(n.CardContent,{className:"space-y-2",children:y.map(e=>{let t=e.user||e.friend;return(0,s.jsxs)("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,s.jsxs)(c.Avatar,{className:"h-8 w-8",children:[(0,s.jsx)(c.AvatarImage,{src:t?.avatar_url}),(0,s.jsx)(c.AvatarFallback,{children:t?.username?.charAt(0)||"U"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"font-medium",children:t?.full_name||t?.username}),(0,s.jsxs)("div",{className:"text-sm text-muted-foreground",children:["Level ",t?.level," • ",t?.points," points"]})]})]}),(0,s.jsxs)(i.Button,{size:"sm",variant:"outline",children:[(0,s.jsx)(x.MessageCircle,{className:"h-4 w-4 mr-1"}),"Message"]})]},e.id)})})]}),0===y.length&&0===b.length&&0===C.length&&(0,s.jsx)(n.Card,{children:(0,s.jsxs)(n.CardContent,{className:"text-center py-12",children:[(0,s.jsx)(o.Users,{className:"h-12 w-12 mx-auto mb-4 text-muted-foreground"}),(0,s.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"No friends yet"}),(0,s.jsx)("p",{className:"text-muted-foreground",children:"Start searching for users above to build your spiritual community!"})]})})]})}var p=e.i(932),j=e.i(87486),v=e.i(14764),y=e.i(75254);let N=(0,y.default)("phone",[["path",{d:"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384",key:"9njp5v"}]]),b=(0,y.default)("video",[["path",{d:"m16 13 5.223 3.482a.5.5 0 0 0 .777-.416V7.87a.5.5 0 0 0-.752-.432L16 10.5",key:"ftymec"}],["rect",{x:"2",y:"6",width:"14",height:"12",rx:"2",key:"158x01"}]]),w=(0,y.default)("ellipsis-vertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]]);var C=e.i(97960);let _=(0,y.default)("paperclip",[["path",{d:"m16 6-8.414 8.586a2 2 0 0 0 2.829 2.829l8.414-8.586a4 4 0 1 0-5.657-5.657l-8.379 8.551a6 6 0 1 0 8.485 8.485l8.379-8.551",key:"1miecu"}]]);function S(){let e,a,r,n,d,o,m,x=(0,p.c)(9),[h,f]=(0,t.useState)(null),[g,y]=(0,t.useState)(""),[S,A]=(0,t.useState)(""),T=(0,t.useRef)(null),q=[],B=q.filter(e=>e.participantName.toLowerCase().includes(S.toLowerCase())),F=q.find(e=>e.id===h),E=[];x[0]===Symbol.for("react.memo_cache_sentinel")?(e=()=>{T.current?.scrollIntoView({behavior:"smooth"})},x[0]=e):e=x[0];let P=e;x[1]===Symbol.for("react.memo_cache_sentinel")?(a=()=>{P()},x[1]=a):a=x[1],(0,t.useEffect)(a,[E]);let z=k;x[2]!==g?(r=()=>{g.trim()&&(console.log("Sending message:",g),y(""))},x[2]=g,x[3]=r):r=x[3];let L=r;return x[4]===Symbol.for("react.memo_cache_sentinel")?(n=(0,s.jsx)("h3",{className:"font-semibold mb-3",children:"Messages"}),x[4]=n):n=x[4],x[5]===Symbol.for("react.memo_cache_sentinel")?(d=(0,s.jsx)(u.Search,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),x[5]=d):d=x[5],x[6]===Symbol.for("react.memo_cache_sentinel")?(o=e=>A(e.target.value),x[6]=o):o=x[6],x[7]!==S?(m=(0,s.jsxs)("div",{className:"p-4 border-b",children:[n,(0,s.jsxs)("div",{className:"relative",children:[d,(0,s.jsx)(l.Input,{placeholder:"Search conversations...",value:S,onChange:o,className:"pl-10"})]})]}),x[7]=S,x[8]=m):m=x[8],(0,s.jsxs)("div",{className:"flex h-[600px] border rounded-lg overflow-hidden",children:[(0,s.jsxs)("div",{className:"w-80 border-r flex flex-col",children:[m,(0,s.jsx)("div",{className:"flex-1 overflow-y-auto",children:B.map(e=>(0,s.jsx)("div",{onClick:()=>f(e.id),className:`p-4 border-b cursor-pointer hover:bg-muted/50 transition-colors ${h===e.id?"bg-muted":""}`,children:(0,s.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsxs)(c.Avatar,{className:"h-10 w-10",children:[(0,s.jsx)(c.AvatarImage,{src:e.participantAvatar}),(0,s.jsx)(c.AvatarFallback,{children:e.participantName.charAt(0)})]}),e.isOnline&&(0,s.jsx)("div",{className:"absolute -bottom-1 -right-1 w-3 h-3 bg-green-500 rounded-full border-2 border-background"})]}),(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("h4",{className:"font-medium truncate",children:e.participantName}),(0,s.jsx)("span",{className:"text-xs text-muted-foreground",children:z(e.lastMessageTime)})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("p",{className:"text-sm text-muted-foreground truncate",children:e.lastMessage}),e.unreadCount>0&&(0,s.jsx)(j.Badge,{variant:"destructive",className:"ml-2 h-5 w-5 rounded-full p-0 flex items-center justify-center text-xs",children:e.unreadCount})]})]})]})},e.id))})]}),h?(0,s.jsxs)("div",{className:"flex-1 flex flex-col",children:[(0,s.jsxs)("div",{className:"p-4 border-b flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsxs)(c.Avatar,{className:"h-8 w-8",children:[(0,s.jsx)(c.AvatarImage,{src:F?.participantAvatar}),(0,s.jsx)(c.AvatarFallback,{children:F?.participantName.charAt(0)})]}),F?.isOnline&&(0,s.jsx)("div",{className:"absolute -bottom-1 -right-1 w-2 h-2 bg-green-500 rounded-full border-2 border-background"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h4",{className:"font-medium",children:F?.participantName}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:F?.isOnline?"Active now":"Offline"})]})]}),(0,s.jsxs)("div",{className:"flex space-x-2",children:[(0,s.jsx)(i.Button,{variant:"ghost",size:"icon",children:(0,s.jsx)(N,{className:"h-4 w-4"})}),(0,s.jsx)(i.Button,{variant:"ghost",size:"icon",children:(0,s.jsx)(b,{className:"h-4 w-4"})}),(0,s.jsx)(i.Button,{variant:"ghost",size:"icon",children:(0,s.jsx)(w,{className:"h-4 w-4"})})]})]}),(0,s.jsxs)("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[E.map(e=>(0,s.jsx)("div",{className:`flex ${e.isOwn?"justify-end":"justify-start"}`,children:(0,s.jsxs)("div",{className:`flex space-x-2 max-w-[70%] ${e.isOwn?"flex-row-reverse space-x-reverse":""}`,children:[!e.isOwn&&(0,s.jsxs)(c.Avatar,{className:"h-8 w-8",children:[(0,s.jsx)(c.AvatarImage,{src:e.senderAvatar}),(0,s.jsx)(c.AvatarFallback,{children:e.senderName.charAt(0)})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:`rounded-lg px-3 py-2 ${e.isOwn?"bg-primary text-primary-foreground":"bg-muted"}`,children:(0,s.jsx)("p",{className:"text-sm",children:e.content})}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground mt-1 px-1",children:z(e.timestamp)})]})]})},e.id)),(0,s.jsx)("div",{ref:T})]}),(0,s.jsx)("div",{className:"p-4 border-t",children:(0,s.jsxs)("div",{className:"flex space-x-2",children:[(0,s.jsx)(i.Button,{variant:"ghost",size:"icon",children:(0,s.jsx)(_,{className:"h-4 w-4"})}),(0,s.jsxs)("div",{className:"flex-1 relative",children:[(0,s.jsx)(l.Input,{placeholder:"Type a message...",value:g,onChange:e=>y(e.target.value),onKeyPress:e=>"Enter"===e.key&&L(),className:"pr-10"}),(0,s.jsx)(i.Button,{variant:"ghost",size:"icon",className:"absolute right-1 top-1",children:(0,s.jsx)(C.Smile,{className:"h-4 w-4"})})]}),(0,s.jsx)(i.Button,{onClick:L,disabled:!g.trim(),children:(0,s.jsx)(v.Send,{className:"h-4 w-4"})})]})})]}):(0,s.jsx)("div",{className:"flex-1 flex items-center justify-center",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"h-16 w-16 bg-muted rounded-full flex items-center justify-center mx-auto mb-4",children:(0,s.jsx)(v.Send,{className:"h-8 w-8 text-muted-foreground"})}),(0,s.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"Select a conversation"}),(0,s.jsx)("p",{className:"text-muted-foreground",children:"Choose a friend from the list to start chatting"})]})})]})}function k(e){let s=Math.floor((new Date().getTime()-e.getTime())/36e5);return s<1?"just now":s<24?`${s}h ago`:e.toLocaleDateString()}var A=e.i(76639),T=e.i(24687),q=e.i(10204),B=e.i(69908),F=e.i(7233),E=e.i(10980);let P=(0,y.default)("hash",[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]]);function z({children:e,onPostCreated:a}){let{user:r}=(0,h.useAuth)(),{user:n}=(0,B.useUserData)(),[c,d]=(0,t.useState)(!1),[o,m]=(0,t.useState)(""),[u,x]=(0,t.useState)(""),[g,p]=(0,t.useState)(""),[v,y]=(0,t.useState)([]),[N,b]=(0,t.useState)(""),[w,C]=(0,t.useState)(!1),_=()=>{N.trim()&&!v.includes(N.trim())&&(y([...v,N.trim()]),b(""))},S=async e=>{if(e.preventDefault(),r&&o.trim()){C(!0);try{let{data:e,error:s}=await f.supabaseService.getClient().from("community_posts").insert({user_id:r.id,content:o.trim(),verse_reference:u.trim()||null,verse_text:g.trim()||null,tags:v.length>0?v:null,likes_count:0,comments_count:0,shares_count:0}).select().single();if(s)throw console.error("Error creating post:",s),s;let t=await f.supabaseService.getUserStats(r.id);await f.supabaseService.updateUserStats(r.id,{community_posts:(t?.community_posts||0)+1}),await f.supabaseService.addPoints(r.id,5),m(""),x(""),p(""),y([]),b(""),d(!1),a?.(),console.log("Post created successfully:",e)}catch(e){console.error("Error creating post:",e)}finally{C(!1)}}};return(0,s.jsxs)(A.Dialog,{open:c,onOpenChange:d,children:[(0,s.jsx)(A.DialogTrigger,{asChild:!0,children:e}),(0,s.jsxs)(A.DialogContent,{className:"sm:max-w-[500px]",children:[(0,s.jsx)(A.DialogHeader,{children:(0,s.jsxs)(A.DialogTitle,{className:"flex items-center gap-2",children:[(0,s.jsx)(F.Plus,{className:"h-5 w-5"}),"Create New Post"]})}),(0,s.jsxs)("form",{onSubmit:S,className:"space-y-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(q.Label,{htmlFor:"content",children:"Share your thoughts..."}),(0,s.jsx)(T.Textarea,{id:"content",placeholder:"What's on your mind? Share your spiritual journey, insights, or prayer requests...",value:o,onChange:e=>m(e.target.value),className:"min-h-[100px]",required:!0})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)(q.Label,{htmlFor:"verse-reference",children:[(0,s.jsx)(E.BookOpen,{className:"inline h-4 w-4 mr-1"}),"Verse Reference (Optional)"]}),(0,s.jsx)(l.Input,{id:"verse-reference",placeholder:"e.g., John 3:16",value:u,onChange:e=>x(e.target.value)})]}),u&&(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(q.Label,{htmlFor:"verse-text",children:"Verse Text (Optional)"}),(0,s.jsx)(T.Textarea,{id:"verse-text",placeholder:"Enter the verse text...",value:g,onChange:e=>p(e.target.value),className:"min-h-[60px]"})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)(q.Label,{htmlFor:"tags",children:[(0,s.jsx)(P,{className:"inline h-4 w-4 mr-1"}),"Tags (Optional)"]}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)(l.Input,{id:"tags",placeholder:"Add a tag...",value:N,onChange:e=>b(e.target.value),onKeyPress:e=>"Enter"===e.key&&(e.preventDefault(),_())}),(0,s.jsx)(i.Button,{type:"button",variant:"outline",onClick:_,children:"Add"})]}),v.length>0&&(0,s.jsx)("div",{className:"flex flex-wrap gap-1 mt-2",children:v.map(e=>(0,s.jsxs)(j.Badge,{variant:"secondary",className:"cursor-pointer",children:["#",e,(0,s.jsx)("button",{type:"button",onClick:()=>{y(v.filter(s=>s!==e))},className:"ml-1 text-xs hover:text-destructive",children:"×"})]},e))})]}),(0,s.jsxs)("div",{className:"flex justify-end gap-2 pt-4",children:[(0,s.jsx)(i.Button,{type:"button",variant:"outline",onClick:()=>d(!1),children:"Cancel"}),(0,s.jsx)(i.Button,{type:"submit",disabled:!o.trim()||w,children:w?"Posting...":"Share Post"})]})]})]})]})}var L=e.i(77572),M=e.i(87130),D=e.i(45423);function I(){let{user:e}=(0,h.useAuth)(),[c,m]=(0,t.useState)(""),[x,p]=(0,t.useState)(null),[v,y]=(0,t.useState)([]),[N,b]=(0,t.useState)(!1),[w,C]=(0,t.useState)(!1);(0,t.useEffect)(()=>{C(!0)},[]);let _=async()=>{if(e&&w)try{b(!0);let{data:e,error:s}=await f.supabaseService.getClient().from("community_posts").select(`
          *,
          user:users(id, username, full_name, avatar_url)
        `).order("created_at",{ascending:!1}).limit(50);if(s)return void console.error("Error fetching posts:",s);y(e||[])}catch(e){console.error("Error fetching posts:",e)}finally{b(!1)}};(0,t.useEffect)(()=>{e&&w&&_()},[e,w]);let k=v.filter(e=>e.content.toLowerCase().includes(c.toLowerCase()));return(0,s.jsx)(a.Layout,{children:(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-3xl font-bold",children:"Community"}),(0,s.jsx)("p",{className:"text-muted-foreground",children:"Connect with fellow believers, share insights, and grow together"})]}),(0,s.jsx)(d.AuthGuard,{action:"post",children:(0,s.jsx)(z,{onPostCreated:_,children:(0,s.jsxs)(i.Button,{children:[(0,s.jsx)(F.Plus,{className:"mr-2 h-4 w-4"}),"New Post"]})})})]}),(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4",children:[(0,s.jsxs)("div",{className:"relative flex-1",children:[(0,s.jsx)(u.Search,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),(0,s.jsx)(l.Input,{placeholder:"Search posts...",value:c,onChange:e=>m(e.target.value),className:"pl-10"})]}),(0,s.jsxs)(i.Button,{variant:"outline",children:[(0,s.jsx)(M.Filter,{className:"mr-2 h-4 w-4"}),"Filters"]})]}),(0,s.jsx)("div",{className:"flex flex-wrap gap-2",children:["Recent","Popular","Following","My Posts"].map(e=>(0,s.jsx)(j.Badge,{variant:x===e?"default":"secondary",className:"cursor-pointer",onClick:()=>p(e),children:e},e))}),(0,s.jsxs)(L.Tabs,{defaultValue:"posts",className:"space-y-4",children:[(0,s.jsxs)(L.TabsList,{className:"grid w-full grid-cols-4",children:[(0,s.jsx)(L.TabsTrigger,{value:"posts",children:"Posts"}),(0,s.jsx)(L.TabsTrigger,{value:"friends",children:"Friends"}),(0,s.jsx)(L.TabsTrigger,{value:"messages",children:"Messages"}),(0,s.jsx)(L.TabsTrigger,{value:"notifications",children:"Notifications"})]}),(0,s.jsx)(L.TabsContent,{value:"posts",className:"space-y-4",children:(0,s.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,s.jsx)("div",{className:"lg:col-span-2 space-y-4",children:w?N?(0,s.jsxs)("div",{className:"text-center py-12",children:[(0,s.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto mb-4"}),(0,s.jsx)("p",{className:"text-muted-foreground",children:"Loading posts..."})]}):0===k.length?(0,s.jsxs)("div",{className:"text-center py-12",children:[(0,s.jsx)(o.Users,{className:"h-12 w-12 mx-auto mb-4 text-muted-foreground"}),(0,s.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"No posts yet"}),(0,s.jsx)("p",{className:"text-muted-foreground",children:"Be the first to share your thoughts with the community!"})]}):k.map(e=>(0,s.jsx)("div",{children:(0,s.jsx)(r.CommunityPost,{post:e,authorName:e.user?.full_name||e.user?.username||"Unknown",authorAvatar:e.user?.avatar_url})},e.id)):(0,s.jsxs)("div",{className:"text-center py-12",children:[(0,s.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto mb-4"}),(0,s.jsx)("p",{className:"text-muted-foreground",children:"Loading..."})]})}),(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)(n.Card,{children:[(0,s.jsx)(n.CardHeader,{children:(0,s.jsx)(n.CardTitle,{className:"text-lg",children:"Community Stats"})}),(0,s.jsx)(n.CardContent,{className:"space-y-3",children:(0,s.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("span",{children:"Members"}),(0,s.jsx)("span",{className:"font-medium",children:"1"})]}),(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("span",{children:"Online Now"}),(0,s.jsx)("span",{className:"font-medium",children:"0"})]}),(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("span",{children:"Posts Today"}),(0,s.jsx)("span",{className:"font-medium",children:"0"})]}),(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("span",{children:"Prayers Shared"}),(0,s.jsx)("span",{className:"font-medium",children:"0"})]})]})})]}),(0,s.jsxs)(n.Card,{children:[(0,s.jsx)(n.CardHeader,{children:(0,s.jsx)(n.CardTitle,{className:"text-lg",children:"Trending Topics"})}),(0,s.jsx)(n.CardContent,{className:"space-y-2",children:["#Prayer","#YouthMinistry","#BibleStudy","#Faith","#Community"].map(e=>(0,s.jsxs)("div",{className:"flex items-center justify-between p-2 rounded hover:bg-muted cursor-pointer",children:[(0,s.jsx)("span",{className:"text-sm font-medium",children:e}),(0,s.jsx)(j.Badge,{variant:"secondary",className:"text-xs",children:Math.floor(50*Math.random())+10})]},e))})]})]})]})}),(0,s.jsx)(L.TabsContent,{value:"friends",children:(0,s.jsx)(g,{})}),(0,s.jsx)(L.TabsContent,{value:"messages",children:(0,s.jsx)(S,{})}),(0,s.jsx)(L.TabsContent,{value:"notifications",children:(0,s.jsxs)(n.Card,{children:[(0,s.jsx)(n.CardHeader,{children:(0,s.jsx)(n.CardTitle,{children:"Notifications"})}),(0,s.jsx)(n.CardContent,{children:(0,s.jsxs)("div",{className:"text-center py-12",children:[(0,s.jsx)(D.Bell,{className:"h-12 w-12 mx-auto mb-4 text-muted-foreground"}),(0,s.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"No new notifications"}),(0,s.jsx)("p",{className:"text-muted-foreground",children:"You're all caught up! Check back later for updates."})]})})]})})]})]})})}e.s(["default",()=>I],39584)}]);