module.exports=[16588,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(65402),e=a.i(99570),f=a.i(91119),g=a.i(86304),h=a.i(72233),i=a.i(75083),j=a.i(73390),k=a.i(66718),l=a.i(24348),m=a.i(43897),n=a.i(71641),o=a.i(58),p=a.i(86130),q=a.i(83077),r=a.i(16106),s=a.i(50429),t=a.i(60246),u=a.i(86520);let v=(0,a.i(70106).default)("medal",[["path",{d:"M7.21 15 2.66 7.14a2 2 0 0 1 .13-2.2L4.4 2.8A2 2 0 0 1 6 2h12a2 2 0 0 1 1.6.8l1.6 2.14a2 2 0 0 1 .14 2.2L16.79 15",key:"143lza"}],["path",{d:"M11 12 5.12 2.2",key:"qhuxz6"}],["path",{d:"m13 12 5.88-9.8",key:"hbye0f"}],["path",{d:"M8 7h8",key:"i86dvs"}],["circle",{cx:"12",cy:"17",r:"5",key:"qbz8iq"}],["path",{d:"M12 18v-2h-.5",key:"fawc4q"}]]);var w=a.i(93518),x=a.i(24669),y=a.i(78138),z=a.i(5151),A=a.i(16201);function B(){let{user:a}=(0,m.useAuth)(),B=(0,n.useUserData)();a&&B.user;let C=a?B.stats:null,[D,E]=(0,c.useState)(null),[F,G]=(0,c.useState)(!1),[H,I]=(0,c.useState)(!1),[J,K]=(0,c.useState)([]),[L,M]=(0,c.useState)([]),[N,O]=(0,c.useState)([]),[P,Q]=(0,c.useState)(null),[R,S]=(0,c.useState)(!0);(0,c.useEffect)(()=>((async()=>{try{S(!0);let[b,c,d]=await Promise.all([p.supabaseService.getLeaderboard(50),p.supabaseService.getWeeklyLeaderboard(50),p.supabaseService.getStreakLeaderboard(50)]),e=(a,b=1)=>a.map((a,c)=>({id:a.id,username:a.username||"Anonymous",avatar:a.avatar_url||"",points:a.points||0,level:a.level||1,streak:a.streak||0,rank:b+c,change:a.rank_change||0,badges:[],weeklyPoints:a.points||0}));if(K(e(b)),M(e(c)),O(e(d)),a){let b=await p.supabaseService.getUserRank(a.id);Q(b)}else Q(null)}catch(a){console.error("Error loading leaderboard data:",a)}finally{S(!1)}})(),p.supabaseService.subscribeToLeaderboard(b=>{K(((a,b=1)=>a.map((a,c)=>({id:a.id,username:a.username||"Anonymous",avatar:a.avatar_url||"",points:a.points||0,level:a.level||1,streak:a.streak||0,rank:b+c,change:a.rank_change||0,badges:[],weeklyPoints:a.points||0})))(b)),a&&p.supabaseService.getUserRank(a.id).then(Q)}),a&&p.supabaseService.subscribeToUserRanking(a.id,a=>{Q(a.rank_position)}),()=>{p.supabaseService.unsubscribe("leaderboard_updates"),a&&p.supabaseService.unsubscribe(`user_ranking_${a.id}`)}),[a]);let T=a=>{switch(a){case 1:return(0,b.jsx)(u.Crown,{className:"h-6 w-6 text-yellow-500"});case 2:return(0,b.jsx)(v,{className:"h-6 w-6 text-gray-400"});case 3:return(0,b.jsx)(w.Award,{className:"h-6 w-6 text-orange-600"});default:return(0,b.jsxs)("span",{className:"text-lg font-bold text-muted-foreground",children:["#",a]})}},U=a=>a>0?(0,b.jsx)(x.TrendingUp,{className:"h-4 w-4 text-green-500"}):a<0?(0,b.jsx)(x.TrendingUp,{className:"h-4 w-4 text-red-500 rotate-180"}):(0,b.jsx)("div",{className:"h-4 w-4"}),V=async()=>{if(a)try{I(!0);let b=await o.referralService.getReferralInfo(a.id);E(b)}catch(a){console.error("Error generating referral link:",a)}finally{I(!1)}},W=async()=>{if(D?.referral_url)try{await navigator.clipboard.writeText(D.referral_url),G(!0),setTimeout(()=>G(!1),2e3)}catch(a){console.error("Error copying link:",a)}},X=a&&P?{rank:P,points:C?.points||0,level:C?.level||1,streak:C?.streak||0,change:0}:null;return(0,b.jsx)(d.Layout,{children:(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-3xl font-bold",children:"Leaderboard"}),(0,b.jsx)("p",{className:"text-muted-foreground",children:"See how you rank among the Journey community"})]}),(0,b.jsxs)(g.Badge,{className:"px-3 py-1.5 bg-linear-to-r from-purple-100 to-blue-100 text-purple-800 border-purple-200",children:[(0,b.jsx)(t.Users,{className:"mr-1 h-3 w-3"}),R?"Loading...":`${J.length} Members`]})]}),R&&(0,b.jsx)(f.Card,{children:(0,b.jsx)(f.CardContent,{className:"p-6",children:(0,b.jsxs)("div",{className:"flex items-center justify-center space-x-2",children:[(0,b.jsx)("div",{className:"w-4 h-4 border-2 border-primary border-t-transparent rounded-full animate-spin"}),(0,b.jsx)("span",{children:"Loading leaderboard data..."})]})})}),X&&(0,b.jsx)(f.Card,{className:"bg-linear-to-r from-blue-50 to-purple-50 border-blue-200",children:(0,b.jsx)(f.CardContent,{className:"p-6",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,b.jsxs)("div",{className:"text-3xl font-bold text-blue-600",children:["#",X.rank]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"font-semibold",children:"Your Ranking"}),(0,b.jsxs)("div",{className:"text-sm text-muted-foreground",children:["Level ",X.level," • ",X.points.toLocaleString()," points"]})]})]}),(0,b.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,b.jsxs)("div",{className:"text-right",children:[(0,b.jsxs)("div",{className:"flex items-center space-x-1 text-green-600",children:[U(X.change),(0,b.jsx)("span",{className:"text-sm font-medium",children:X.change>0?`+${X.change}`:X.change})]}),(0,b.jsx)("div",{className:"text-xs text-muted-foreground",children:"vs last week"})]}),(0,b.jsxs)("div",{className:"text-right",children:[(0,b.jsxs)("div",{className:"flex items-center space-x-1 text-orange-600",children:[(0,b.jsx)(r.Flame,{className:"h-4 w-4"}),(0,b.jsx)("span",{className:"font-medium",children:X.streak})]}),(0,b.jsx)("div",{className:"text-xs text-muted-foreground",children:"day streak"})]})]})]})})}),!a&&!R&&(0,b.jsx)(f.Card,{className:"bg-linear-to-r from-gray-50 to-slate-50 border-gray-200",children:(0,b.jsx)(f.CardContent,{className:"p-6",children:(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)(q.Trophy,{className:"h-12 w-12 text-yellow-500 mx-auto mb-4"}),(0,b.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"Join the Competition!"}),(0,b.jsx)("p",{className:"text-muted-foreground mb-4",children:"Sign up to see your ranking on the leaderboard and start earning points"}),(0,b.jsx)(e.Button,{className:"bg-linear-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700",children:"Sign Up to Join"})]})})}),a&&(0,b.jsxs)(f.Card,{className:"bg-linear-to-r from-green-50 to-emerald-50 border-green-200",children:[(0,b.jsxs)(f.CardHeader,{children:[(0,b.jsxs)(f.CardTitle,{className:"flex items-center space-x-2",children:[(0,b.jsx)(y.Gift,{className:"h-5 w-5 text-green-600"}),(0,b.jsx)("span",{children:"Invite Friends & Earn Points"})]}),(0,b.jsx)(f.CardDescription,{children:"Share your referral link and earn 100 points for each friend who joins"})]}),(0,b.jsx)(f.CardContent,{className:"space-y-4",children:D?(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsxs)("div",{className:"flex space-x-2",children:[(0,b.jsx)(k.Input,{value:D.referral_url,readOnly:!0,className:"flex-1"}),(0,b.jsx)(e.Button,{onClick:W,variant:"outline",size:"sm",children:F?(0,b.jsx)(A.CheckCircle,{className:"h-4 w-4 text-green-600"}):(0,b.jsx)(z.Copy,{className:"h-4 w-4"})})]}),(0,b.jsxs)("div",{className:"grid grid-cols-3 gap-4 text-center",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-lg font-bold text-green-600",children:D.total_referrals}),(0,b.jsx)("div",{className:"text-xs text-muted-foreground",children:"Total Referrals"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-lg font-bold text-blue-600",children:D.completed_referrals}),(0,b.jsx)("div",{className:"text-xs text-muted-foreground",children:"Completed"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-lg font-bold text-purple-600",children:D.points_earned}),(0,b.jsx)("div",{className:"text-xs text-muted-foreground",children:"Points Earned"})]})]}),(0,b.jsxs)(l.Alert,{children:[(0,b.jsx)(y.Gift,{className:"h-4 w-4"}),(0,b.jsxs)(l.AlertDescription,{children:["Your referral code: ",(0,b.jsx)("strong",{children:D.referral_code})]})]})]}):(0,b.jsxs)(e.Button,{onClick:V,disabled:H,className:"w-full",children:[H?(0,b.jsx)("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin mr-2"}):(0,b.jsx)(y.Gift,{className:"h-4 w-4 mr-2"}),"Generate Referral Link"]})})]}),(0,b.jsxs)(i.Tabs,{defaultValue:"overall",className:"space-y-6",children:[(0,b.jsxs)(i.TabsList,{className:"grid w-full grid-cols-3",children:[(0,b.jsx)(i.TabsTrigger,{value:"overall",children:"Overall"}),(0,b.jsx)(i.TabsTrigger,{value:"weekly",children:"Weekly"}),(0,b.jsx)(i.TabsTrigger,{value:"streaks",children:"Streaks"})]}),(0,b.jsx)(i.TabsContent,{value:"overall",className:"space-y-4",children:(0,b.jsx)("div",{className:"grid gap-4",children:J.map(c=>(0,b.jsx)(f.Card,{className:`hover:shadow-md transition-shadow ${a?.id===c.id?"ring-2 ring-primary":""}`,children:(0,b.jsxs)(f.CardContent,{className:"p-6",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,b.jsx)("div",{className:"flex items-center justify-center w-12 h-12",children:T(c.rank)}),(0,b.jsxs)(h.Avatar,{className:"h-12 w-12",children:[(0,b.jsx)(h.AvatarImage,{src:c.avatar}),(0,b.jsx)(h.AvatarFallback,{children:c.username.charAt(0)})]}),(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,b.jsx)("h3",{className:"font-semibold",children:c.username}),(0,b.jsxs)(g.Badge,{className:(a=>{switch(a){case 1:return"bg-linear-to-r from-yellow-400 to-yellow-600 text-white border-yellow-500";case 2:return"bg-linear-to-r from-gray-300 to-gray-500 text-white border-gray-400";case 3:return"bg-linear-to-r from-orange-400 to-orange-600 text-white border-orange-500";default:return"bg-muted text-muted-foreground"}})(c.rank),children:["Level ",c.level]})]}),(0,b.jsxs)("div",{className:"flex items-center space-x-4 text-sm text-muted-foreground",children:[(0,b.jsxs)("span",{children:[c.points.toLocaleString()," points"]}),(0,b.jsx)("span",{children:"•"}),(0,b.jsxs)("span",{className:"flex items-center space-x-1",children:[(0,b.jsx)(r.Flame,{className:"h-3 w-3 text-orange-500"}),(0,b.jsxs)("span",{children:[c.streak," day streak"]})]})]}),(0,b.jsx)("div",{className:"flex flex-wrap gap-1",children:c.badges.map(a=>(0,b.jsx)(g.Badge,{variant:"outline",className:"text-xs",children:a},a))})]})]}),(0,b.jsxs)("div",{className:"text-right",children:[(0,b.jsxs)("div",{className:"flex items-center space-x-1",children:[U(c.change),(0,b.jsx)("span",{className:`text-sm font-medium ${c.change>0?"text-green-600":c.change<0?"text-red-600":"text-muted-foreground"}`,children:c.change>0?`+${c.change}`:0===c.change?"—":c.change})]}),(0,b.jsx)("div",{className:"text-xs text-muted-foreground",children:"vs last week"})]})]}),(0,b.jsxs)("div",{className:"mt-4",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between text-sm mb-1",children:[(0,b.jsxs)("span",{className:"text-muted-foreground",children:["Progress to Level ",c.level+1]}),(0,b.jsxs)("span",{className:"text-muted-foreground",children:[1e3-c.points%1e3," pts"]})]}),(0,b.jsx)(j.Progress,{value:c.points%1e3/10,className:"h-2"})]})]})},c.id))})}),(0,b.jsxs)(i.TabsContent,{value:"weekly",className:"space-y-4",children:[(0,b.jsx)(f.Card,{className:"bg-linear-to-r from-green-50 to-emerald-50 border-green-200",children:(0,b.jsxs)(f.CardHeader,{children:[(0,b.jsxs)(f.CardTitle,{className:"flex items-center space-x-2",children:[(0,b.jsx)(q.Trophy,{className:"h-5 w-5 text-green-600"}),(0,b.jsx)("span",{children:"Weekly Champions"})]}),(0,b.jsx)(f.CardDescription,{children:"Top performers this week"})]})}),(0,b.jsx)("div",{className:"grid gap-4",children:L.map(a=>(0,b.jsx)(f.Card,{className:"hover:shadow-md transition-shadow",children:(0,b.jsx)(f.CardContent,{className:"p-6",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,b.jsx)("div",{className:"flex items-center justify-center w-12 h-12",children:T(a.rank)}),(0,b.jsxs)(h.Avatar,{className:"h-12 w-12",children:[(0,b.jsx)(h.AvatarImage,{src:a.avatar}),(0,b.jsx)(h.AvatarFallback,{children:a.username.charAt(0)})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"font-semibold",children:a.username}),(0,b.jsxs)("div",{className:"text-sm text-muted-foreground",children:[a.weeklyPoints.toLocaleString()," points this week"]})]})]}),(0,b.jsxs)("div",{className:"text-right",children:[(0,b.jsx)("div",{className:"text-2xl font-bold text-green-600",children:a.weeklyPoints.toLocaleString()}),(0,b.jsx)("div",{className:"text-xs text-muted-foreground",children:"weekly points"})]})]})})},a.id))})]}),(0,b.jsxs)(i.TabsContent,{value:"streaks",className:"space-y-4",children:[(0,b.jsx)(f.Card,{className:"bg-linear-to-r from-orange-50 to-red-50 border-orange-200",children:(0,b.jsxs)(f.CardHeader,{children:[(0,b.jsxs)(f.CardTitle,{className:"flex items-center space-x-2",children:[(0,b.jsx)(r.Flame,{className:"h-5 w-5 text-orange-600"}),(0,b.jsx)("span",{children:"Streak Masters"})]}),(0,b.jsx)(f.CardDescription,{children:"Users with the longest reading streaks"})]})}),(0,b.jsx)("div",{className:"grid gap-4",children:N.map(a=>(0,b.jsx)(f.Card,{className:"hover:shadow-md transition-shadow",children:(0,b.jsx)(f.CardContent,{className:"p-6",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,b.jsx)("div",{className:"flex items-center justify-center w-12 h-12",children:T(a.rank)}),(0,b.jsxs)(h.Avatar,{className:"h-12 w-12",children:[(0,b.jsx)(h.AvatarImage,{src:a.avatar}),(0,b.jsx)(h.AvatarFallback,{children:a.username.charAt(0)})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"font-semibold",children:a.username}),(0,b.jsxs)("div",{className:"text-sm text-muted-foreground",children:["Level ",a.level," • ",a.points.toLocaleString()," points"]})]})]}),(0,b.jsxs)("div",{className:"text-right",children:[(0,b.jsxs)("div",{className:"flex items-center space-x-1 text-2xl font-bold text-orange-600",children:[(0,b.jsx)(r.Flame,{className:"h-6 w-6"}),(0,b.jsx)("span",{children:a.streak})]}),(0,b.jsx)("div",{className:"text-xs text-muted-foreground",children:"day streak"})]})]})})},a.id))})]})]}),(0,b.jsxs)(f.Card,{children:[(0,b.jsx)(f.CardHeader,{children:(0,b.jsxs)(f.CardTitle,{className:"flex items-center space-x-2",children:[(0,b.jsx)(s.Target,{className:"h-5 w-5 text-blue-600"}),(0,b.jsx)("span",{children:"Community Statistics"})]})}),(0,b.jsx)(f.CardContent,{children:(0,b.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[(0,b.jsxs)("div",{className:"text-center p-4 bg-blue-50 rounded-lg",children:[(0,b.jsx)("div",{className:"text-2xl font-bold text-blue-600",children:J.length}),(0,b.jsx)("div",{className:"text-sm text-blue-500",children:"Total Members"})]}),(0,b.jsxs)("div",{className:"text-center p-4 bg-green-50 rounded-lg",children:[(0,b.jsx)("div",{className:"text-2xl font-bold text-green-600",children:J.filter(a=>a.streak>0).length}),(0,b.jsx)("div",{className:"text-sm text-green-500",children:"Active Today"})]}),(0,b.jsxs)("div",{className:"text-center p-4 bg-purple-50 rounded-lg",children:[(0,b.jsx)("div",{className:"text-2xl font-bold text-purple-600",children:J.reduce((a,b)=>a+b.points,0).toLocaleString()}),(0,b.jsx)("div",{className:"text-sm text-purple-500",children:"Total Points"})]}),(0,b.jsxs)("div",{className:"text-center p-4 bg-orange-50 rounded-lg",children:[(0,b.jsx)("div",{className:"text-2xl font-bold text-orange-600",children:Math.max(...J.map(a=>a.streak),0)}),(0,b.jsx)("div",{className:"text-sm text-orange-500",children:"Longest Streak"})]})]})})]})]})})}a.s(["default",()=>B,"dynamic",0,"force-dynamic"],16588)}];

//# sourceMappingURL=src_app_leaderboard_page_tsx_deae5a5a._.js.map