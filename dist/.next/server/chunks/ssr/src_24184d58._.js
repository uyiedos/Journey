module.exports=[23496,a=>{"use strict";let b=[{id:"daily-login-1",name:"First Day",description:"Log in for the first time",icon:"sun",points:5,category:"daily",unlockedAt:new Date},{id:"daily-login-7",name:"Week Warrior",description:"Log in for 7 consecutive days",icon:"calendar",points:50,category:"daily",unlockedAt:new Date},{id:"daily-login-30",name:"Monthly Master",description:"Log in for 30 consecutive days",icon:"calendar",points:200,category:"daily",unlockedAt:new Date},{id:"first-verse",name:"First Steps",description:"Read your first Bible verse",icon:"book-open",points:10,category:"reading",unlockedAt:new Date},{id:"chapter-complete",name:"Chapter Reader",description:"Complete reading an entire chapter",icon:"book-open",points:25,category:"reading",unlockedAt:new Date},{id:"book-complete",name:"Book Scholar",description:"Complete reading an entire book",icon:"book-open",points:100,category:"reading",unlockedAt:new Date},{id:"testament-complete",name:"Testament Master",description:"Complete reading an entire testament",icon:"book-open",points:500,category:"reading",unlockedAt:new Date},{id:"bible-complete",name:"Bible Scholar",description:"Complete reading the entire Bible",icon:"trophy",points:1e3,category:"reading",unlockedAt:new Date},{id:"streak-3",name:"3 Day Streak",description:"Maintain a 3-day reading streak",icon:"flame",points:30,category:"streak",unlockedAt:new Date},{id:"streak-7",name:"Week Warrior",description:"Maintain a 7-day reading streak",icon:"flame",points:75,category:"streak",unlockedAt:new Date},{id:"streak-30",name:"Monthly Master",description:"Maintain a 30-day reading streak",icon:"flame",points:300,category:"streak",unlockedAt:new Date},{id:"streak-100",name:"Century Saint",description:"Maintain a 100-day reading streak",icon:"flame",points:1e3,category:"streak",unlockedAt:new Date},{id:"first-friend",name:"Friend Maker",description:"Add your first friend",icon:"users",points:15,category:"community",unlockedAt:new Date},{id:"social-butterfly",name:"Social Butterfly",description:"Add 10 friends",icon:"users",points:50,category:"community",unlockedAt:new Date},{id:"first-post",name:"Voice Heard",description:"Make your first community post",icon:"message-circle",points:20,category:"community",unlockedAt:new Date},{id:"community-leader",name:"Community Leader",description:"Make 10 community posts",icon:"message-circle",points:100,category:"community",unlockedAt:new Date},{id:"first-devotional",name:"First Devotional",description:"Create your first devotional",icon:"heart",points:20,category:"special",unlockedAt:new Date},{id:"devotional-writer",name:"Devotional Writer",description:"Create 5 devotionals",icon:"heart",points:100,category:"special",unlockedAt:new Date},{id:"devotional-author",name:"Devotional Author",description:"Create 20 devotionals",icon:"heart",points:300,category:"special",unlockedAt:new Date},{id:"first-prayer",name:"First Prayer",description:"Share your first prayer",icon:"hands",points:15,category:"special",unlockedAt:new Date},{id:"prayer-warrior",name:"Prayer Warrior",description:"Share 10 prayers",icon:"hands",points:75,category:"special",unlockedAt:new Date},{id:"prayer-intercessor",name:"Prayer Intercessor",description:"Share 50 prayers",icon:"hands",points:200,category:"special",unlockedAt:new Date},{id:"first-plan",name:"Plan Starter",description:"Start your first reading plan",icon:"calendar",points:10,category:"reading",unlockedAt:new Date},{id:"plan-completer",name:"Plan Completer",description:"Complete your first reading plan",icon:"calendar",points:50,category:"reading",unlockedAt:new Date},{id:"plan-enthusiast",name:"Plan Enthusiast",description:"Start 5 reading plans",icon:"calendar",points:100,category:"reading",unlockedAt:new Date},{id:"point-collector",name:"Point Collector",description:"Earn 100 points",icon:"star",points:50,category:"special",unlockedAt:new Date},{id:"point-master",name:"Point Master",description:"Earn 1000 points",icon:"star",points:100,category:"special",unlockedAt:new Date},{id:"point-legend",name:"Point Legend",description:"Earn 10000 points",icon:"star",points:500,category:"special",unlockedAt:new Date},{id:"early-bird",name:"Early Bird",description:"Read Bible verses before 6 AM for 7 days",icon:"sun",points:150,category:"special",unlockedAt:new Date},{id:"night-owl",name:"Night Owl",description:"Read Bible verses after 10 PM for 7 days",icon:"moon",points:150,category:"special",unlockedAt:new Date},{id:"explorer",name:"Bible Explorer",description:"Read from every book of the Bible",icon:"compass",points:750,category:"special",unlockedAt:new Date}];a.s(["achievements",0,b,"getAchievementById",0,a=>b.find(b=>b.id===a),"getAchievementsByCategory",0,a=>b.filter(b=>b.category===a)])},71641,3749,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(43897),e=a.i(86130),f=a.i(23496);let g=class{static async trackDailyLogin(a){try{if(await this.getRecentLoginRecord(a))return{pointsAwarded:0,newAchievements:[],streakUpdated:!1};let b=await this.awardDailyLoginPoints(a),c=await this.updateLoginStreak(a),d=await this.checkDailyLoginAchievements(a);return{pointsAwarded:b,newAchievements:d,streakUpdated:c}}catch(a){return console.error("Error tracking daily login:",a),{pointsAwarded:0,newAchievements:[],streakUpdated:!1}}}static async getRecentLoginRecord(a){try{let b=new Date,{data:c,error:d}=await e.supabaseService.getClient().from("daily_login_rewards").select("*").eq("user_id",a).gte("created_at",new Date(b.getTime()-864e5).toISOString()).order("created_at",{ascending:!1}).limit(1).maybeSingle();if(d)return console.error("Error checking recent login:",d),null;return c}catch(a){return console.error("Error getting recent login record:",a),null}}static async awardDailyLoginPoints(a){let b=await e.supabaseService.getUserProfile(a);if(!b)return 0;let c=0;7===b.streak&&(c=10),30===b.streak&&(c=25),100===b.streak&&(c=100);let d=5+c;return await e.supabaseService.addPoints(a,d),await this.recordDailyLogin(a,d),d}static async recordDailyLogin(a,b){try{await e.supabaseService.getClient().from("daily_login_rewards").insert({user_id:a,points_awarded:b})}catch(a){console.error("Error recording daily login:",a)}}static async updateLoginStreak(a){try{let b=await e.supabaseService.getUserProfile(a);if(!b)return!1;let c=new Date,d=new Date(b.updated_at),f=(c.getTime()-d.getTime())/36e5,g=b.streak;if(f<24)return!1;return f<=48?g+=1:g=1,await e.supabaseService.updateStreak(a,g),!0}catch(a){return console.error("Error updating login streak:",a),!1}}static async checkDailyLoginAchievements(a){let b=await e.supabaseService.getUserProfile(a);if(!b)return[];let c=[],d=new Set((await this.getUserAchievements(a)).map(a=>a.achievement_id));for(let e of f.achievements.filter(a=>"daily"===a.category)){if(d.has(e.id))continue;let f=!1;switch(e.id){case"daily-login-1":f=b.streak>=1;break;case"daily-login-7":f=b.streak>=7;break;case"daily-login-30":f=b.streak>=30}f&&(await this.unlockAchievement(a,e.id),c.push(e))}return c}static async unlockAchievement(a,b){try{let c=(0,f.getAchievementById)(b);if(!c||await this.getUserAchievement(a,b))return!1;return await e.supabaseService.getClient().from("user_achievements").insert({user_id:a,achievement_id:b,unlocked_at:new Date().toISOString(),points_awarded:c.points}),await e.supabaseService.addPoints(a,c.points),!0}catch(a){return console.error("Error unlocking achievement:",a),!1}}static async getUserAchievements(a){try{let{data:b,error:c}=await e.supabaseService.getClient().from("user_achievements").select("*").eq("user_id",a).order("unlocked_at",{ascending:!1});if(c)return console.error("Error fetching user achievements:",c),[];return b||[]}catch(a){return console.error("Error getting user achievements:",a),[]}}static async getUserAchievement(a,b){try{let{data:c,error:d}=await e.supabaseService.getClient().from("user_achievements").select("*").eq("user_id",a).eq("achievement_id",b).single();if(d)return console.error("Error fetching user achievement:",d),null;return c}catch(a){return console.error("Error getting user achievement:",a),null}}static async trackActivityAndCheckAchievements(a,b,c){let d=0;try{switch(b){case"verse_read":d=1,await this.checkReadingAchievements(a);break;case"chapter_completed":d=10,await this.checkReadingAchievements(a);break;case"book_completed":d=50,await this.checkReadingAchievements(a);break;case"post_created":d=20,await this.checkCommunityAchievements(a);break;case"friend_added":d=15,await this.checkCommunityAchievements(a);break;default:d=0}return d>0&&await e.supabaseService.addPoints(a,d),{pointsAwarded:d,newAchievements:[]}}catch(a){return console.error("Error tracking activity and achievements:",a),{pointsAwarded:0,newAchievements:[]}}}static async checkReadingAchievements(a){return[]}static async checkCommunityAchievements(a){return[]}static async checkAndAwardAchievements(a){try{let b=[],c=0,d=await e.supabaseService.getUserStats(a);if(!d)return{newAchievements:b,pointsAwarded:0};let g=await e.supabaseService.getUserProfile(a);if(!g)return{newAchievements:b,pointsAwarded:0};let h=await e.supabaseService.getUserAchievements(a),i=new Set(h.map(a=>a.achievement_id));for(let h of f.achievements){if(i.has(h.id))continue;let f=!1;switch(h.id){case"daily-login-1":f=!0;break;case"daily-login-7":case"streak-7":f=g.streak>=7;break;case"daily-login-30":case"streak-30":f=g.streak>=30;break;case"first-verse":f=d.verses_read>0;break;case"chapter-complete":f=d.chapters_completed>=1;break;case"book-complete":f=d.chapters_completed>=10;break;case"testament-complete":f=d.chapters_completed>=50;break;case"bible-complete":f=d.chapters_completed>=1189;break;case"streak-3":f=g.streak>=3;break;case"streak-100":f=g.streak>=100;break;case"first-devotional":f=d.devotionals_created>=1;break;case"devotional-writer":f=d.devotionals_created>=5;break;case"devotional-author":f=d.devotionals_created>=20;break;case"first-prayer":f=d.prayers_shared>=1;break;case"prayer-warrior":f=d.prayers_shared>=10;break;case"prayer-intercessor":f=d.prayers_shared>=50;break;case"first-plan":f=d.reading_plans_started>=1;break;case"plan-completer":f=d.reading_plans_completed>=1;break;case"plan-enthusiast":f=d.reading_plans_started>=5;break;case"first-friend":f=d.friends_count>=1;break;case"social-butterfly":f=d.friends_count>=10;break;case"first-post":f=d.community_posts>=1;break;case"community-leader":f=d.community_posts>=10;break;case"early-bird":f=!!(g.created_at&&new Date(g.created_at)<new Date("2024-01-01"));break;case"point-collector":f=g.points>=100;break;case"point-master":f=g.points>=1e3;break;case"point-legend":f=g.points>=1e4}f&&await e.supabaseService.unlockAchievement(a,h.id)&&(b.push(h),c+=h.points)}return c>0&&await e.supabaseService.addPoints(a,c),{newAchievements:b,pointsAwarded:c}}catch(a){return console.error("Error checking achievements:",a),{newAchievements:[],pointsAwarded:0}}}static async getAchievementStats(a){try{let b=f.achievements,c=await this.getUserAchievements(a),d=new Set(c.map(a=>a.achievement_id)),e=[...new Set(b.map(a=>a.category))],g={};return e.forEach(a=>{let c=b.filter(b=>b.category===a),e=c.filter(a=>d.has(a.id));g[a]={unlocked:e.length,total:c.length}}),{totalAchievements:b.length,unlockedAchievements:c.length,totalPoints:c.reduce((a,b)=>a+b.points_awarded,0),categoryProgress:g}}catch(a){return console.error("Error getting achievement stats:",a),{totalAchievements:0,unlockedAchievements:0,totalPoints:0,categoryProgress:{}}}}};a.s(["achievementService",0,g],3749);let h=(0,c.createContext)(void 0);function i(){let a=(0,c.useContext)(h);return void 0===a?{user:{id:"fallback",username:"Guest",email:"guest@example.com",fullName:"Guest User",avatar:"",level:1,points:0,streak:0,badges:[],achievements:[],joinedAt:new Date,lastActive:new Date,friends:[],settings:{theme:"system",notifications:{email:!0,push:!0,dailyDevotional:!0,friendRequests:!0,messages:!0,achievementAlerts:!0,communityPosts:!1,readingReminders:!0,weeklyProgress:!0},privacy:{profileVisibility:"public",showOnlineStatus:!0,showReadingProgress:!0,allowFriendRequests:!0,showAchievements:!0},reading:{fontSize:"medium",translation:"kjv",dailyReminderTime:"08:00",autoPlayAudio:!1,highlightVerses:!0,showNotes:!0},community:{showInFeed:!0,allowMentions:!0,emailNotifications:!0,pushNotifications:!0,filterContent:!0,hideBlockedUsers:!0}}},stats:{level:1,points:0,streak:0,badges:[],leaderboard:[]},loading:!1,error:null,updateUser:async()=>{},updateStats:async()=>{},updateSettings:async()=>{},addPoints:async()=>{},incrementStreak:async()=>{},refreshData:async()=>{}}:a}function j({children:a}){let{user:f}=(0,d.useAuth)(),[i,j]=(0,c.useState)(null),[k,l]=(0,c.useState)(null),[m,n]=(0,c.useState)(!0),[o,p]=(0,c.useState)(null);(0,c.useEffect)(()=>((async()=>{if(!f){j(null),l(null),n(!1);return}try{n(!0),p(null);let a=await e.supabaseService.getUserProfile(f.id);if(!a&&!(a=await e.supabaseService.createUserProfile(f)))throw Error("Failed to create user profile");if(!await e.supabaseService.getUserStats(f.id))throw Error("Failed to load user stats");let b=await e.supabaseService.getUserAchievements(f.id),c={id:a.id,username:a.username||a.email?.split("@")[0]||"user",email:a.email,fullName:a.full_name||"",avatar:a.avatar_url||"",joinedAt:new Date(a.created_at),points:a.points,level:a.level,streak:a.streak,longestStreak:a.longest_streak||0,friends:[],achievements:b.map(a=>a.achievement).filter(Boolean),settings:{theme:"system",notifications:{email:!0,push:!0,dailyDevotional:!0,friendRequests:!0,messages:!0,achievementAlerts:!0,communityPosts:!1,readingReminders:!0,weeklyProgress:!0},privacy:{profileVisibility:"public",showOnlineStatus:!0,showReadingProgress:!0,allowFriendRequests:!0,showAchievements:!0},reading:{fontSize:"medium",translation:"kjv",dailyReminderTime:"08:00",autoPlayAudio:!1,highlightVerses:!0,showNotes:!0},community:{showInFeed:!0,allowMentions:!0,emailNotifications:!0,pushNotifications:!0,filterContent:!0,hideBlockedUsers:!0}}},d={level:a.level,points:a.points,streak:a.streak,badges:[],leaderboard:[]};j(c),l(d);try{let{newAchievements:a,pointsAwarded:b}=await g.checkAndAwardAchievements(f.id);if(a.length>0){console.log("New achievements unlocked:",a),console.log("Points awarded:",b);let c=await e.supabaseService.getUserAchievements(f.id);j(a=>a?{...a,achievements:c.map(a=>a.achievement).filter(Boolean)}:null)}}catch(a){console.error("Error checking achievements:",a)}e.supabaseService.subscribeToUser(f.id,a=>{j(b=>b?{...b,...a}:null)}),e.supabaseService.subscribeToUserStats(f.id,a=>{console.log("User stats updated:",a)})}catch(a){console.error("Error initializing user data:",a),p(a instanceof Error?a.message:"Failed to load user data")}finally{n(!1)}})(),()=>{e.supabaseService.unsubscribeAll()}),[f]);let q=async a=>{if(f&&i)try{let b={username:a.username,full_name:a.fullName,avatar_url:a.avatar};await e.supabaseService.updateUserProfile(f.id,b)&&j(b=>b?{...b,...a}:null)}catch(a){console.error("Error updating user:",a),p(a instanceof Error?a.message:"Failed to update user")}},r=async a=>{if(f)try{let b=await e.supabaseService.addPoints(f.id,a);b&&(j(a=>a?{...a,points:b.points,level:b.level}:null),l(a=>a?{...a,points:b.points,level:b.level}:null))}catch(a){console.error("Error adding points:",a),p(a instanceof Error?a.message:"Failed to add points")}},s=async()=>{if(f&&i)try{let a=i.streak+1;await e.supabaseService.updateStreak(f.id,a)&&(j(b=>b?{...b,streak:a}:null),l(b=>b?{...b,streak:a}:null))}catch(a){console.error("Error updating streak:",a),p(a instanceof Error?a.message:"Failed to update streak")}},t=async()=>{if(f)try{n(!0);let a=await e.supabaseService.getUserProfile(f.id);a&&(j(b=>b?{...b,points:a.points,level:a.level,streak:a.streak,fullName:a.full_name,avatar:a.avatar_url||""}:null),l(b=>b?{...b,points:a.points,level:a.level,streak:a.streak}:null))}catch(a){console.error("Error refreshing data:",a),p(a instanceof Error?a.message:"Failed to refresh data")}finally{n(!1)}};return(0,b.jsx)(h.Provider,{value:{user:i,stats:k,loading:m,error:o,updateUser:q,updateStats:a=>{k&&l({...k,...a})},updateSettings:a=>{i&&j({...i,settings:{...i.settings,...a}})},addPoints:r,incrementStreak:s,refreshData:t},children:a})}a.s(["UserDataProvider",()=>j,"useUserData",()=>i],71641)}];

//# sourceMappingURL=src_24184d58._.js.map