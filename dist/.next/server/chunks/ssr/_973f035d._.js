module.exports=[38617,a=>{"use strict";let b=(0,a.i(70106).default)("bookmark",[["path",{d:"m19 21-7-4-7 4V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v16z",key:"1fy3hk"}]]);a.s(["Bookmark",()=>b],38617)},45222,a=>{"use strict";let b=(0,a.i(70106).default)("message-circle",[["path",{d:"M2.992 16.342a2 2 0 0 1 .094 1.167l-1.065 3.29a1 1 0 0 0 1.236 1.168l3.413-.998a2 2 0 0 1 1.099.092 10 10 0 1 0-4.777-4.719",key:"1sd12s"}]]);a.s(["MessageCircle",()=>b],45222)},92759,a=>{"use strict";let b=(0,a.i(70106).default)("send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]);a.s(["Send",()=>b],92759)},53569,a=>{"use strict";let b=(0,a.i(70106).default)("share-2",[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]]);a.s(["Share2",()=>b],53569)},29246,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(68114);let e=c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("textarea",{className:(0,d.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",a),ref:e,...c}));e.displayName="Textarea",a.s(["Textarea",()=>e])},67421,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(76472),e=a.i(45222),f=a.i(53569),g=a.i(92759),h=a.i(99570),i=a.i(29246),j=a.i(72233),k=a.i(43897),l=a.i(86130);class m{static instance;static getInstance(){return m.instance||(m.instance=new m),m.instance}async toggleLike(a,b,c){try{let{data:d}=await l.supabaseService.getClient().from("likes").select("id").eq("user_id",c).eq("target_id",a).eq("target_type",b).maybeSingle();if(d)return await l.supabaseService.getClient().from("likes").delete().eq("user_id",c).eq("target_id",a).eq("target_type",b),await this.updateCount(a,b,"likes_count",-1),{liked:!1,count:await this.getCount(a,b,"likes_count")};return await l.supabaseService.getClient().from("likes").insert({user_id:c,target_id:a,target_type:b}),await this.updateCount(a,b,"likes_count",1),{liked:!0,count:await this.getCount(a,b,"likes_count")}}catch(a){throw console.error("Error toggling like:",a),a}}async hasUserLiked(a,b,c){try{let{data:d}=await l.supabaseService.getClient().from("likes").select("id").eq("user_id",c).eq("target_id",a).eq("target_type",b).maybeSingle();return!!d}catch(a){return console.error("Error checking like status:",a),!1}}async addComment(a,b,c,d){try{let{data:e,error:f}=await l.supabaseService.getClient().from("comments").insert({user_id:c,target_id:a,target_type:b,content:d.trim()}).select(`
          *,
          user:users(id, username, full_name, avatar_url)
        `).single();if(f)throw f;return await this.updateCount(a,b,"comments_count",1),e}catch(a){throw console.error("Error adding comment:",a),a}}async getComments(a,b){try{let{data:c,error:d}=await l.supabaseService.getClient().from("comments").select(`
          *,
          user:users(id, username, full_name, avatar_url)
        `).eq("target_id",a).eq("target_type",b).order("created_at",{ascending:!0});if(d)throw d;return c||[]}catch(a){return console.error("Error fetching comments:",a),[]}}async share(a,b,c){try{return await l.supabaseService.getClient().from("shares").insert({user_id:c,target_id:a,target_type:b}),await this.updateCount(a,b,"shares_count",1),{count:await this.getCount(a,b,"shares_count")}}catch(a){throw console.error("Error recording share:",a),a}}async getCount(a,b,c){try{let d="";switch(b){case"post":d="community_posts";break;case"devotional":d="devotionals";break;case"prayer":d="prayer_requests";break;default:return 0}let{data:e}=await l.supabaseService.getClient().from(d).select(c).eq("id",a).single();return e?.[c]||0}catch(a){return console.error("Error getting count:",a),0}}async updateCount(a,b,c,d){try{let e="";switch(b){case"post":e="community_posts";break;case"devotional":e="devotionals";break;case"prayer":e="prayer_requests";break;default:return}let{error:f}=await l.supabaseService.getClient().rpc("increment_count",{table_name:e,record_id:a,column_name:c,increment_value:d});if(f){let{data:b}=await l.supabaseService.getClient().from(e).select(c).eq("id",a).single();if(b){let f=Math.max(0,(b[c]||0)+d);await l.supabaseService.getClient().from(e).update({[c]:f}).eq("id",a)}}}catch(a){console.error("Error updating count:",a)}}async getUserSocialActivity(a){try{let[b,c,d]=await Promise.all([l.supabaseService.getClient().from("likes").select(`
            *,
            target:community_posts(id, content, created_at)
          `).eq("user_id",a).order("created_at",{ascending:!1}).limit(10),l.supabaseService.getClient().from("comments").select(`
            *,
            target:community_posts(id, content, created_at)
          `).eq("user_id",a).order("created_at",{ascending:!1}).limit(10),l.supabaseService.getClient().from("shares").select(`
            *,
            target:community_posts(id, content, created_at)
          `).eq("user_id",a).order("created_at",{ascending:!1}).limit(10)]);return{likes:b.data||[],comments:c.data||[],shares:d.data||[]}}catch(a){return console.error("Error fetching user social activity:",a),{likes:[],comments:[],shares:[]}}}}let n=m.getInstance();var o=a.i(68114);function p({targetId:a,targetType:l,initialLikes:m=0,initialComments:p=0,initialShares:q=0,showComments:r=!0,className:s=""}){let{user:t}=(0,k.useAuth)(),[u,v]=(0,c.useState)(!1),[w,x]=(0,c.useState)(m),[y,z]=(0,c.useState)(p),[A,B]=(0,c.useState)(q),[C,D]=(0,c.useState)(!1),[E,F]=(0,c.useState)(!1),[G,H]=(0,c.useState)(!1),[I,J]=(0,c.useState)([]),[K,L]=(0,c.useState)(!1),[M,N]=(0,c.useState)(""),[O,P]=(0,c.useState)(!1);(0,c.useEffect)(()=>{v(!0)},[]),(0,c.useEffect)(()=>{t&&u&&n.hasUserLiked(a,l,t.id).then(D)},[a,l,t,u]),(0,c.useEffect)(()=>{K&&r&&u&&Q()},[K,a,l,r,u]);let Q=async()=>{try{let b=await n.getComments(a,l);J(b),z(b.length)}catch(a){console.error("Error loading comments:",a)}},R=async()=>{if(!t||E||!u)return;F(!0);let b=!C,c=b?w+1:Math.max(0,w-1);D(b),x(c);try{let b=await n.toggleLike(a,l,t.id);x(b.count),D(b.liked)}catch(a){console.error("Error toggling like:",a),D(!b),x(w)}finally{F(!1)}},S=async()=>{if(t&&!G&&u){H(!0);try{let b=await n.share(a,l,t.id);B(b.count),navigator.share&&await navigator.share({title:`Check out this ${l}`,text:`Found this amazing ${l} on Journey!`,url:window.location.href})}catch(a){console.error("Error sharing:",a)}finally{H(!1)}}},T=async()=>{if(t&&M.trim()&&!O&&u){P(!0);try{let b=await n.addComment(a,l,t.id,M);J([b,...I]),z(a=>a+1),N("")}catch(a){console.error("Error adding comment:",a)}finally{P(!1)}}};return(0,b.jsxs)("div",{className:`space-y-4 ${s}`,children:[(0,b.jsx)("div",{className:"flex items-center justify-between pt-4 border-t",children:(0,b.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,b.jsxs)(h.Button,{variant:"ghost",size:"sm",className:`text-muted-foreground hover:text-red-500 transition-colors ${C?"text-red-500":""}`,onClick:R,disabled:!t||E,children:[(0,b.jsx)(d.Heart,{className:`h-4 w-4 mr-1 ${C?"fill-current":""}`}),w]}),r&&(0,b.jsxs)(h.Button,{variant:"ghost",size:"sm",className:"text-muted-foreground hover:text-blue-500 transition-colors",onClick:()=>L(!K),children:[(0,b.jsx)(e.MessageCircle,{className:"h-4 w-4 mr-1"}),y]}),(0,b.jsxs)(h.Button,{variant:"ghost",size:"sm",className:"text-muted-foreground hover:text-green-500 transition-colors",onClick:S,disabled:!t||G,children:[(0,b.jsx)(f.Share2,{className:"h-4 w-4 mr-1"}),A]})]})}),r&&K&&(0,b.jsxs)("div",{className:"space-y-4 border-t pt-4",children:[t&&(0,b.jsxs)("div",{className:"flex space-x-3",children:[(0,b.jsxs)(j.Avatar,{className:"h-8 w-8",children:[(0,b.jsx)(j.AvatarImage,{src:t.user_metadata?.avatar_url}),(0,b.jsx)(j.AvatarFallback,{children:t.email?.charAt(0)})]}),(0,b.jsxs)("div",{className:"flex-1 space-y-2",children:[(0,b.jsx)(i.Textarea,{placeholder:"Share your thoughts...",value:M,onChange:a=>N(a.target.value),className:"min-h-[60px] resize-none"}),(0,b.jsx)("div",{className:"flex justify-end",children:(0,b.jsxs)(h.Button,{size:"sm",onClick:T,disabled:!M.trim()||O,children:[(0,b.jsx)(g.Send,{className:"h-4 w-4 mr-1"}),O?"Posting...":"Post"]})})]})]}),(0,b.jsx)("div",{className:"space-y-3",children:0===I.length?(0,b.jsx)("div",{className:"text-center py-4 text-muted-foreground",children:"No comments yet. Be the first to share your thoughts!"}):I.map(a=>(0,b.jsxs)("div",{className:"flex space-x-3",children:[(0,b.jsxs)(j.Avatar,{className:"h-8 w-8",children:[(0,b.jsx)(j.AvatarImage,{src:a.user?.avatar_url}),(0,b.jsx)(j.AvatarFallback,{children:a.user?.full_name?.charAt(0)||a.user?.username?.charAt(0)||"U"})]}),(0,b.jsxs)("div",{className:"flex-1 space-y-1",children:[(0,b.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,b.jsx)("span",{className:"font-medium text-sm",children:a.user?.full_name||a.user?.username||"Anonymous"}),(0,b.jsx)("span",{className:"text-xs text-muted-foreground",children:(0,o.formatTimeAgo)(new Date(a.created_at))})]}),(0,b.jsx)("p",{className:"text-sm text-gray-700",children:a.content})]})]},a.id))})]})]})}a.s(["SocialInteraction",()=>p],67421)},9892,a=>{"use strict";var b=a.i(87924),c=a.i(91119),d=a.i(86304),e=a.i(99570),f=a.i(72233),g=a.i(38617),h=a.i(68114),i=a.i(67421);function j({devotional:a}){let j=a.verse?.text||a.verse_text||"",k=a.verse?`${a.verse.book||""} ${a.verse.chapter||""}:${a.verse.number||""}`:a.verse_reference||"",l=a.author_name||a.author||"Anonymous",m=a.date?a.date instanceof Date?a.date:new Date(a.date):a.created_at?new Date(a.created_at):new Date;a.shares;let n=a.tags||[];return(0,b.jsxs)(c.Card,{className:"w-full",children:[(0,b.jsxs)(c.CardHeader,{children:[(0,b.jsxs)("div",{className:"flex items-start justify-between",children:[(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsx)(c.CardTitle,{className:"text-lg",children:a.title}),(0,b.jsx)(c.CardDescription,{children:j&&k?`${j} - ${k}`:j||k})]}),(0,b.jsx)(e.Button,{variant:"ghost",size:"icon",children:(0,b.jsx)(g.Bookmark,{className:"h-4 w-4"})})]}),(0,b.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,b.jsx)(f.Avatar,{className:"h-6 w-6",children:(0,b.jsx)(f.AvatarFallback,{children:l.charAt(0).toUpperCase()})}),(0,b.jsx)("span",{className:"text-sm text-muted-foreground",children:l}),(0,b.jsx)("span",{className:"text-sm text-muted-foreground",children:"â€¢"}),(0,b.jsx)("span",{className:"text-sm text-muted-foreground",children:(0,h.formatTimeAgo)(m)})]})]}),(0,b.jsxs)(c.CardContent,{children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground mb-4 line-clamp-3",children:a.content}),(0,b.jsx)("div",{className:"flex flex-wrap gap-2 mb-4",children:n.map(a=>(0,b.jsxs)(d.Badge,{variant:"secondary",className:"text-xs",children:["#",a]},a))}),(0,b.jsx)(i.SocialInteraction,{targetId:a.id,targetType:"devotional",initialLikes:a.likes_count||0,initialComments:a.comments_count||0,initialShares:a.shares_count||0,showComments:!1,className:"mb-4"})]})]})}a.s(["DevotionalCard",()=>j])}];

//# sourceMappingURL=_973f035d._.js.map