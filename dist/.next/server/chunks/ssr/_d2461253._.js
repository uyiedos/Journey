module.exports=[70430,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(30553),e=c.forwardRef((a,c)=>(0,b.jsx)(d.Primitive.label,{...a,ref:c,onMouseDown:b=>{b.target.closest("button, input, select, textarea")||(a.onMouseDown?.(b),!b.defaultPrevented&&b.detail>1&&b.preventDefault())}}));e.displayName="Label";var f=a.i(187),g=a.i(68114);let h=(0,f.cva)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),i=c.forwardRef(({className:a,...c},d)=>(0,b.jsx)(e,{ref:d,className:(0,g.cn)(h(),a),...c}));i.displayName=e.displayName,a.s(["Label",()=>i],70430)},17755,a=>{"use strict";let b=(0,a.i(70106).default)("ellipsis",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]]);a.s(["MoreHorizontal",()=>b],17755)},29246,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(68114);let e=c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("textarea",{className:(0,d.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",a),ref:e,...c}));e.displayName="Textarea",a.s(["Textarea",()=>e])},45222,a=>{"use strict";let b=(0,a.i(70106).default)("message-circle",[["path",{d:"M2.992 16.342a2 2 0 0 1 .094 1.167l-1.065 3.29a1 1 0 0 0 1.236 1.168l3.413-.998a2 2 0 0 1 1.099.092 10 10 0 1 0-4.777-4.719",key:"1sd12s"}]]);a.s(["MessageCircle",()=>b],45222)},92759,a=>{"use strict";let b=(0,a.i(70106).default)("send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]);a.s(["Send",()=>b],92759)},53569,a=>{"use strict";let b=(0,a.i(70106).default)("share-2",[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]]);a.s(["Share2",()=>b],53569)},67421,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(76472),e=a.i(45222),f=a.i(53569),g=a.i(92759),h=a.i(99570),i=a.i(29246),j=a.i(72233),k=a.i(43897),l=a.i(86130);class m{static instance;static getInstance(){return m.instance||(m.instance=new m),m.instance}async toggleLike(a,b,c){try{let{data:d}=await l.supabaseService.getClient().from("likes").select("id").eq("user_id",c).eq("target_id",a).eq("target_type",b).maybeSingle();if(d)return await l.supabaseService.getClient().from("likes").delete().eq("user_id",c).eq("target_id",a).eq("target_type",b),await this.updateCount(a,b,"likes_count",-1),{liked:!1,count:await this.getCount(a,b,"likes_count")};return await l.supabaseService.getClient().from("likes").insert({user_id:c,target_id:a,target_type:b}),await this.updateCount(a,b,"likes_count",1),{liked:!0,count:await this.getCount(a,b,"likes_count")}}catch(a){throw console.error("Error toggling like:",a),a}}async hasUserLiked(a,b,c){try{let{data:d}=await l.supabaseService.getClient().from("likes").select("id").eq("user_id",c).eq("target_id",a).eq("target_type",b).maybeSingle();return!!d}catch(a){return console.error("Error checking like status:",a),!1}}async addComment(a,b,c,d){try{let{data:e,error:f}=await l.supabaseService.getClient().from("comments").insert({user_id:c,target_id:a,target_type:b,content:d.trim()}).select(`
          *,
          user:users(id, username, full_name, avatar_url)
        `).single();if(f)throw f;return await this.updateCount(a,b,"comments_count",1),e}catch(a){throw console.error("Error adding comment:",a),a}}async getComments(a,b){try{let{data:c,error:d}=await l.supabaseService.getClient().from("comments").select(`
          *,
          user:users(id, username, full_name, avatar_url)
        `).eq("target_id",a).eq("target_type",b).order("created_at",{ascending:!0});if(d)throw d;return c||[]}catch(a){return console.error("Error fetching comments:",a),[]}}async share(a,b,c){try{return await l.supabaseService.getClient().from("shares").insert({user_id:c,target_id:a,target_type:b}),await this.updateCount(a,b,"shares_count",1),{count:await this.getCount(a,b,"shares_count")}}catch(a){throw console.error("Error recording share:",a),a}}async getCount(a,b,c){try{let d="";switch(b){case"post":d="community_posts";break;case"devotional":d="devotionals";break;case"prayer":d="prayer_requests";break;default:return 0}let{data:e}=await l.supabaseService.getClient().from(d).select(c).eq("id",a).single();return e?.[c]||0}catch(a){return console.error("Error getting count:",a),0}}async updateCount(a,b,c,d){try{let e="";switch(b){case"post":e="community_posts";break;case"devotional":e="devotionals";break;case"prayer":e="prayer_requests";break;default:return}let{error:f}=await l.supabaseService.getClient().rpc("increment_count",{table_name:e,record_id:a,column_name:c,increment_value:d});if(f){let{data:b}=await l.supabaseService.getClient().from(e).select(c).eq("id",a).single();if(b){let f=Math.max(0,(b[c]||0)+d);await l.supabaseService.getClient().from(e).update({[c]:f}).eq("id",a)}}}catch(a){console.error("Error updating count:",a)}}async getUserSocialActivity(a){try{let[b,c,d]=await Promise.all([l.supabaseService.getClient().from("likes").select(`
            *,
            target:community_posts(id, content, created_at)
          `).eq("user_id",a).order("created_at",{ascending:!1}).limit(10),l.supabaseService.getClient().from("comments").select(`
            *,
            target:community_posts(id, content, created_at)
          `).eq("user_id",a).order("created_at",{ascending:!1}).limit(10),l.supabaseService.getClient().from("shares").select(`
            *,
            target:community_posts(id, content, created_at)
          `).eq("user_id",a).order("created_at",{ascending:!1}).limit(10)]);return{likes:b.data||[],comments:c.data||[],shares:d.data||[]}}catch(a){return console.error("Error fetching user social activity:",a),{likes:[],comments:[],shares:[]}}}}let n=m.getInstance();var o=a.i(68114);function p({targetId:a,targetType:l,initialLikes:m=0,initialComments:p=0,initialShares:q=0,showComments:r=!0,className:s=""}){let{user:t}=(0,k.useAuth)(),[u,v]=(0,c.useState)(!1),[w,x]=(0,c.useState)(m),[y,z]=(0,c.useState)(p),[A,B]=(0,c.useState)(q),[C,D]=(0,c.useState)(!1),[E,F]=(0,c.useState)(!1),[G,H]=(0,c.useState)(!1),[I,J]=(0,c.useState)([]),[K,L]=(0,c.useState)(!1),[M,N]=(0,c.useState)(""),[O,P]=(0,c.useState)(!1);(0,c.useEffect)(()=>{v(!0)},[]),(0,c.useEffect)(()=>{t&&u&&n.hasUserLiked(a,l,t.id).then(D)},[a,l,t,u]),(0,c.useEffect)(()=>{K&&r&&u&&Q()},[K,a,l,r,u]);let Q=async()=>{try{let b=await n.getComments(a,l);J(b),z(b.length)}catch(a){console.error("Error loading comments:",a)}},R=async()=>{if(!t||E||!u)return;F(!0);let b=!C,c=b?w+1:Math.max(0,w-1);D(b),x(c);try{let b=await n.toggleLike(a,l,t.id);x(b.count),D(b.liked)}catch(a){console.error("Error toggling like:",a),D(!b),x(w)}finally{F(!1)}},S=async()=>{if(t&&!G&&u){H(!0);try{let b=await n.share(a,l,t.id);B(b.count),navigator.share&&await navigator.share({title:`Check out this ${l}`,text:`Found this amazing ${l} on Journey!`,url:window.location.href})}catch(a){console.error("Error sharing:",a)}finally{H(!1)}}},T=async()=>{if(t&&M.trim()&&!O&&u){P(!0);try{let b=await n.addComment(a,l,t.id,M);J([b,...I]),z(a=>a+1),N("")}catch(a){console.error("Error adding comment:",a)}finally{P(!1)}}};return(0,b.jsxs)("div",{className:`space-y-4 ${s}`,children:[(0,b.jsx)("div",{className:"flex items-center justify-between pt-4 border-t",children:(0,b.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,b.jsxs)(h.Button,{variant:"ghost",size:"sm",className:`text-muted-foreground hover:text-red-500 transition-colors ${C?"text-red-500":""}`,onClick:R,disabled:!t||E,children:[(0,b.jsx)(d.Heart,{className:`h-4 w-4 mr-1 ${C?"fill-current":""}`}),w]}),r&&(0,b.jsxs)(h.Button,{variant:"ghost",size:"sm",className:"text-muted-foreground hover:text-blue-500 transition-colors",onClick:()=>L(!K),children:[(0,b.jsx)(e.MessageCircle,{className:"h-4 w-4 mr-1"}),y]}),(0,b.jsxs)(h.Button,{variant:"ghost",size:"sm",className:"text-muted-foreground hover:text-green-500 transition-colors",onClick:S,disabled:!t||G,children:[(0,b.jsx)(f.Share2,{className:"h-4 w-4 mr-1"}),A]})]})}),r&&K&&(0,b.jsxs)("div",{className:"space-y-4 border-t pt-4",children:[t&&(0,b.jsxs)("div",{className:"flex space-x-3",children:[(0,b.jsxs)(j.Avatar,{className:"h-8 w-8",children:[(0,b.jsx)(j.AvatarImage,{src:t.user_metadata?.avatar_url}),(0,b.jsx)(j.AvatarFallback,{children:t.email?.charAt(0)})]}),(0,b.jsxs)("div",{className:"flex-1 space-y-2",children:[(0,b.jsx)(i.Textarea,{placeholder:"Share your thoughts...",value:M,onChange:a=>N(a.target.value),className:"min-h-[60px] resize-none"}),(0,b.jsx)("div",{className:"flex justify-end",children:(0,b.jsxs)(h.Button,{size:"sm",onClick:T,disabled:!M.trim()||O,children:[(0,b.jsx)(g.Send,{className:"h-4 w-4 mr-1"}),O?"Posting...":"Post"]})})]})]}),(0,b.jsx)("div",{className:"space-y-3",children:0===I.length?(0,b.jsx)("div",{className:"text-center py-4 text-muted-foreground",children:"No comments yet. Be the first to share your thoughts!"}):I.map(a=>(0,b.jsxs)("div",{className:"flex space-x-3",children:[(0,b.jsxs)(j.Avatar,{className:"h-8 w-8",children:[(0,b.jsx)(j.AvatarImage,{src:a.user?.avatar_url}),(0,b.jsx)(j.AvatarFallback,{children:a.user?.full_name?.charAt(0)||a.user?.username?.charAt(0)||"U"})]}),(0,b.jsxs)("div",{className:"flex-1 space-y-1",children:[(0,b.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,b.jsx)("span",{className:"font-medium text-sm",children:a.user?.full_name||a.user?.username||"Anonymous"}),(0,b.jsx)("span",{className:"text-xs text-muted-foreground",children:(0,o.formatTimeAgo)(new Date(a.created_at))})]}),(0,b.jsx)("p",{className:"text-sm text-gray-700",children:a.content})]})]},a.id))})]})]})}a.s(["SocialInteraction",()=>p],67421)},15618,69012,a=>{"use strict";var b=a.i(70106);let c=(0,b.default)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);a.s(["Plus",()=>c],15618);let d=(0,b.default)("funnel",[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]]);a.s(["Filter",()=>d],69012)},88859,a=>{"use strict";var b=a.i(87924),c=a.i(91119),d=a.i(99570),e=a.i(72233),f=a.i(86304),g=a.i(17755),h=a.i(68114),i=a.i(67421);function j({post:a,authorName:j,authorAvatar:k}){return(0,b.jsx)(c.Card,{className:"w-full",children:(0,b.jsxs)(c.CardContent,{className:"p-6",children:[(0,b.jsxs)("div",{className:"flex items-start justify-between mb-4",children:[(0,b.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,b.jsxs)(e.Avatar,{className:"h-10 w-10",children:[(0,b.jsx)(e.AvatarImage,{src:k}),(0,b.jsx)(e.AvatarFallback,{children:j.charAt(0)})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"font-medium",children:j}),(0,b.jsx)("div",{className:"text-sm text-muted-foreground",children:a.created_at?(0,h.formatTimeAgo)(new Date(a.created_at)):"Just now"})]})]}),(0,b.jsx)(d.Button,{variant:"ghost",size:"icon",children:(0,b.jsx)(g.MoreHorizontal,{className:"h-4 w-4"})})]}),(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsx)("p",{className:"text-sm leading-relaxed",children:a.content}),a.verse_reference&&a.verse_text&&(0,b.jsx)("div",{className:"bg-muted/50 p-3 rounded-lg border-l-4 border-primary",children:(0,b.jsxs)("p",{className:"text-sm italic text-muted-foreground",children:['"',a.verse_text,'" - ',a.verse_reference]})}),a.tags&&a.tags.length>0&&(0,b.jsx)("div",{className:"flex flex-wrap gap-2",children:a.tags.map((a,c)=>(0,b.jsxs)(f.Badge,{variant:"secondary",className:"text-xs",children:["#",a]},c))})]}),(0,b.jsx)(i.SocialInteraction,{targetId:a.id,targetType:"post",initialLikes:a.likes_count||0,initialComments:a.comments_count||0,initialShares:a.shares_count||0,showComments:!0})]})})}a.s(["CommunityPost",()=>j])},14574,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(97942),e=a.i(33508),f=a.i(68114);let g=d.Root,h=d.Trigger,i=d.Portal;d.Close;let j=c.forwardRef(({className:a,...c},e)=>(0,b.jsx)(d.Overlay,{ref:e,className:(0,f.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",a),...c}));j.displayName=d.Overlay.displayName;let k=c.forwardRef(({className:a,children:c,...g},h)=>(0,b.jsxs)(i,{children:[(0,b.jsx)(j,{}),(0,b.jsxs)(d.Content,{ref:h,className:(0,f.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",a),...g,children:[c,(0,b.jsxs)(d.Close,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,b.jsx)(e.X,{className:"h-4 w-4"}),(0,b.jsx)("span",{className:"sr-only",children:"Close"})]})]})]}));k.displayName=d.Content.displayName;let l=({className:a,...c})=>(0,b.jsx)("div",{className:(0,f.cn)("flex flex-col space-y-1.5 text-center sm:text-left",a),...c});l.displayName="DialogHeader";let m=c.forwardRef(({className:a,...c},e)=>(0,b.jsx)(d.Title,{ref:e,className:(0,f.cn)("text-lg font-semibold leading-none tracking-tight",a),...c}));m.displayName=d.Title.displayName,c.forwardRef(({className:a,...c},e)=>(0,b.jsx)(d.Description,{ref:e,className:(0,f.cn)("text-sm text-muted-foreground",a),...c})).displayName=d.Description.displayName,a.s(["Dialog",()=>g,"DialogContent",()=>k,"DialogHeader",()=>l,"DialogTitle",()=>m,"DialogTrigger",()=>h])},99272,a=>{"use strict";var b=a.i(87924),c=a.i(43897),d=a.i(99570),e=a.i(91119),f=a.i(38246),g=a.i(31067),h=a.i(76472),i=a.i(45222),j=a.i(17371);let k=(0,a.i(70106).default)("pen-tool",[["path",{d:"M15.707 21.293a1 1 0 0 1-1.414 0l-1.586-1.586a1 1 0 0 1 0-1.414l5.586-5.586a1 1 0 0 1 1.414 0l1.586 1.586a1 1 0 0 1 0 1.414z",key:"nt11vn"}],["path",{d:"m18 13-1.375-6.874a1 1 0 0 0-.746-.776L3.235 2.028a1 1 0 0 0-1.207 1.207L5.35 15.879a1 1 0 0 0 .776.746L13 18",key:"15qc1e"}],["path",{d:"m2.3 2.3 7.286 7.286",key:"1wuzzi"}],["circle",{cx:"11",cy:"11",r:"2",key:"xmgehs"}]]);function l({children:a,action:l,fallback:m}){let{user:n}=(0,c.useAuth)();if(n)return(0,b.jsx)(b.Fragment,{children:a});if(m)return(0,b.jsx)(b.Fragment,{children:m});let o={post:{title:"Sign in to Post",description:"Join our community to share your thoughts and devotionals",icon:k},comment:{title:"Sign in to Comment",description:"Share your thoughts and engage with the community",icon:i.MessageCircle},like:{title:"Sign in to Like",description:"Show appreciation for posts that inspire you",icon:h.Heart},friend:{title:"Sign in to Add Friends",description:"Connect with others on their spiritual journey",icon:j.UserPlus},devotional:{title:"Sign in to Create Devotionals",description:"Share your insights and inspire others",icon:k}}[l],p=o.icon;return(0,b.jsx)(e.Card,{className:"border-dashed border-muted-foreground/30 bg-muted/30",children:(0,b.jsxs)(e.CardContent,{className:"p-6 text-center",children:[(0,b.jsx)("div",{className:"mx-auto w-12 h-12 bg-primary/10 rounded-full flex items-center justify-center mb-4",children:(0,b.jsx)(p,{className:"h-6 w-6 text-primary"})}),(0,b.jsx)(e.CardTitle,{className:"text-lg mb-2",children:o.title}),(0,b.jsx)(e.CardDescription,{className:"mb-4",children:o.description}),(0,b.jsx)(f.default,{href:"/auth",children:(0,b.jsxs)(d.Button,{className:"w-full",children:[(0,b.jsx)(g.LogIn,{className:"mr-2 h-4 w-4"}),"Sign In to Continue"]})})]})})}a.s(["AuthGuard",()=>l],99272)},7428,a=>{"use strict";let b=(0,a.i(70106).default)("smile",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 14s1.5 2 4 2 4-2 4-2",key:"1y1vjs"}],["line",{x1:"9",x2:"9.01",y1:"9",y2:"9",key:"yxxnd0"}],["line",{x1:"15",x2:"15.01",y1:"9",y2:"9",key:"1p4y9e"}]]);a.s(["Smile",()=>b],7428)}];

//# sourceMappingURL=_d2461253._.js.map