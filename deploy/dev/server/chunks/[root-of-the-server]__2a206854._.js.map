{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/UYI/Downloads/Journey/journey/src/lib/supabase/server.ts"],"sourcesContent":["import { createClient as createSupabaseClient } from '@supabase/supabase-js';\r\n\r\nconst supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL || 'https://your-project.supabase.co';\r\nconst supabaseServiceKey = process.env.SUPABASE_SERVICE_ROLE_KEY || 'your-service-key';\r\n\r\nexport function createServerClient() {\r\n  return createSupabaseClient(supabaseUrl, supabaseServiceKey, {\r\n    auth: {\r\n      autoRefreshToken: false,\r\n      persistSession: false,\r\n    },\r\n  });\r\n}\r\n"],"names":[],"mappings":";;;;AAAA;;AAEA,MAAM,cAAc,gFAAwC;AAC5D,MAAM,qBAAqB,QAAQ,GAAG,CAAC,yBAAyB,IAAI;AAE7D,SAAS;IACd,OAAO,IAAA,yLAAoB,EAAC,aAAa,oBAAoB;QAC3D,MAAM;YACJ,kBAAkB;YAClB,gBAAgB;QAClB;IACF;AACF"}},
    {"offset": {"line": 66, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/UYI/Downloads/Journey/journey/src/lib/supabase.ts"],"sourcesContent":["import { createClient } from '@supabase/supabase-js';\r\n\r\nconst supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL || 'https://your-project.supabase.co';\r\nconst supabaseAnonKey = process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY || 'your-anon-key';\r\n\r\nexport const supabase = createClient(supabaseUrl, supabaseAnonKey, {\r\n  auth: {\r\n    autoRefreshToken: true,\r\n    persistSession: true,\r\n    detectSessionInUrl: true,\r\n    flowType: 'pkce', // Recommended for web apps\r\n  },\r\n  realtime: {\r\n    params: {\r\n      eventsPerSecond: 10,\r\n    },\r\n  },\r\n});\r\n\r\n// For server-side operations\r\nconst serviceRoleKey = process.env.SUPABASE_SERVICE_ROLE_KEY;\r\n\r\nexport const supabaseAdmin = serviceRoleKey \r\n  ? createClient(supabaseUrl, serviceRoleKey, {\r\n      auth: {\r\n        autoRefreshToken: false,\r\n        persistSession: false,\r\n      },\r\n      realtime: {\r\n        params: {\r\n          eventsPerSecond: 10,\r\n        },\r\n      },\r\n    })\r\n  : null;\r\n"],"names":[],"mappings":";;;;;;AAAA;;AAEA,MAAM,cAAc,gFAAwC;AAC5D,MAAM,kBAAkB,wPAA6C;AAE9D,MAAM,WAAW,IAAA,yLAAY,EAAC,aAAa,iBAAiB;IACjE,MAAM;QACJ,kBAAkB;QAClB,gBAAgB;QAChB,oBAAoB;QACpB,UAAU;IACZ;IACA,UAAU;QACR,QAAQ;YACN,iBAAiB;QACnB;IACF;AACF;AAEA,6BAA6B;AAC7B,MAAM,iBAAiB,QAAQ,GAAG,CAAC,yBAAyB;AAErD,MAAM,gBAAgB,iBACzB,IAAA,yLAAY,EAAC,aAAa,gBAAgB;IACxC,MAAM;QACJ,kBAAkB;QAClB,gBAAgB;IAClB;IACA,UAAU;QACR,QAAQ;YACN,iBAAiB;QACnB;IACF;AACF,KACA"}},
    {"offset": {"line": 106, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/UYI/Downloads/Journey/journey/src/services/readingPlanService.ts"],"sourcesContent":["// Reading Plan Service for Supabase integration\r\nimport { supabase } from '../lib/supabase';\r\n\r\nexport interface ReadingPlan {\r\n  id: string;\r\n  title: string;\r\n  description: string;\r\n  duration: number;\r\n  difficulty: 'beginner' | 'intermediate' | 'advanced';\r\n  readings?: ReadingPlanItem[];\r\n  participants?: number;\r\n  rating?: number;\r\n  user_id?: string;\r\n  is_public?: boolean;\r\n  created_at?: string;\r\n  updated_at?: string;\r\n}\r\n\r\nexport interface ReadingPlanItem {\r\n  id: string;\r\n  day: number;\r\n  title: string;\r\n  passages: string[];\r\n  devotional: string;\r\n  completed?: boolean;\r\n}\r\n\r\nexport interface UserReadingPlan {\r\n  id: string;\r\n  user_id: string;\r\n  plan_id: string;\r\n  started_at: string;\r\n  completed_at?: string;\r\n  current_day: number;\r\n  is_active: boolean;\r\n  created_at: string;\r\n  updated_at: string;\r\n}\r\n\r\nexport interface ReadingPlanProgress {\r\n  id: string;\r\n  user_id: string;\r\n  plan_id: string;\r\n  day: number;\r\n  completed: boolean;\r\n  completed_at?: string;\r\n  notes?: string;\r\n  points_earned: number;\r\n  created_at: string;\r\n  updated_at: string;\r\n}\r\n\r\nclass ReadingPlanService {\r\n  // Get all public reading plans\r\n  async getPublicReadingPlans(): Promise<ReadingPlan[]> {\r\n    try {\r\n      const { data, error } = await supabase\r\n        .from('reading_plans')\r\n        .select('*')\r\n        .eq('is_public', true)\r\n        .order('created_at', { ascending: false });\r\n\r\n      if (error) throw error;\r\n      return data || [];\r\n    } catch (error) {\r\n      console.error('Error fetching reading plans:', error);\r\n      return [];\r\n    }\r\n  }\r\n\r\n  // Get reading plan by ID\r\n  async getReadingPlanById(id: string): Promise<ReadingPlan | null> {\r\n    if (!id) {\r\n      console.error('Error: No ID provided to getReadingPlanById');\r\n      return null;\r\n    }\r\n    \r\n    try {\r\n      console.log(`Fetching reading plan with ID: ${id}`);\r\n      const { data, error } = await supabase\r\n        .from('reading_plans')\r\n        .select('*')\r\n        .eq('id', id)\r\n        .single();\r\n\r\n      if (error) {\r\n        console.error('Supabase error details:', {\r\n          message: error.message,\r\n          code: error.code,\r\n          details: error.details,\r\n          hint: error.hint,\r\n          request: error.request\r\n        });\r\n        throw error;\r\n      }\r\n      \r\n      if (!data) {\r\n        console.error(`No reading plan found with ID: ${id}`);\r\n        return null;\r\n      }\r\n      \r\n      return data;\r\n    } catch (error) {\r\n      console.error('Error in getReadingPlanById:', {\r\n        error,\r\n        errorString: String(error),\r\n        errorObject: JSON.stringify(error, Object.getOwnPropertyNames(error)),\r\n        planId: id\r\n      });\r\n      return null;\r\n    }\r\n  }\r\n\r\n  // Start a reading plan for a user\r\n  async startReadingPlan(userId: string, planId: string): Promise<UserReadingPlan> {\r\n    try {\r\n      // Create user reading plan entry\r\n      const { data: userPlan, error: userPlanError } = await supabase\r\n        .from('user_reading_plans')\r\n        .insert([{\r\n          user_id: userId,\r\n          plan_id: planId,\r\n          started_at: new Date().toISOString(),\r\n          current_day: 1,\r\n          is_active: true\r\n        }])\r\n        .select()\r\n        .single();\r\n\r\n      if (userPlanError) throw userPlanError;\r\n\r\n      // Award initial points for starting a plan\r\n      await this.awardPoints(userId, 10, 'Started a reading plan');\r\n\r\n      return userPlan;\r\n    } catch (error) {\r\n      console.error('Error starting reading plan:', error);\r\n      throw error;\r\n    }\r\n  }\r\n\r\n  // Get user's reading plans\r\n  async getUserReadingPlans(userId: string): Promise<UserReadingPlan[]> {\r\n    try {\r\n      const { data, error } = await supabase\r\n        .from('user_reading_plans')\r\n        .select(`\r\n          *,\r\n          reading_plans (*)\r\n        `)\r\n        .eq('user_id', userId)\r\n        .order('started_at', { ascending: false });\r\n\r\n      if (error) throw error;\r\n      return data || [];\r\n    } catch (error) {\r\n      console.error('Error fetching user reading plans:', error);\r\n      return [];\r\n    }\r\n  }\r\n\r\n  // Get user's progress for a specific plan\r\n  async getPlanProgress(userId: string, planId: string): Promise<ReadingPlanProgress[]> {\r\n    try {\r\n      const { data, error } = await supabase\r\n        .from('reading_plan_progress')\r\n        .select('*')\r\n        .eq('user_id', userId)\r\n        .eq('plan_id', planId)\r\n        .order('day_number', { ascending: true });\r\n\r\n      if (error) throw error;\r\n      return data || [];\r\n    } catch (error) {\r\n      console.error('Error fetching plan progress:', error);\r\n      return [];\r\n    }\r\n  }\r\n\r\n  // Mark a day as completed\r\n  async completeDay(\r\n    userId: string, \r\n    planId: string, \r\n    day: number, \r\n    notes?: string\r\n  ): Promise<ReadingPlanProgress> {\r\n    try {\r\n      const { data, error } = await supabase\r\n        .from('reading_plan_progress')\r\n        .upsert([{\r\n          user_id: userId,\r\n          plan_id: planId,\r\n          day: day,\r\n          completed: true,\r\n          completed_at: new Date().toISOString(),\r\n          notes: notes || null,\r\n          points_earned: 5 // Award 5 points per completed day\r\n        }])\r\n        .select()\r\n        .single();\r\n\r\n      if (error) throw error;\r\n\r\n      // Award points for completing a day\r\n      await this.awardPoints(userId, 5, 'Completed a reading plan day');\r\n\r\n      // Update user reading plan current day\r\n      await supabase\r\n        .from('user_reading_plans')\r\n        .update({ \r\n          current_day: day + 1,\r\n          updated_at: new Date().toISOString()\r\n        })\r\n        .eq('user_id', userId)\r\n        .eq('plan_id', planId);\r\n\r\n      return data;\r\n    } catch (error) {\r\n      console.error('Error completing day:', error);\r\n      throw error;\r\n    }\r\n  }\r\n\r\n  // Complete entire reading plan\r\n  async completeReadingPlan(userId: string, planId: string): Promise<UserReadingPlan> {\r\n    try {\r\n      // Get plan details to calculate completion bonus\r\n      const plan = await this.getReadingPlanById(planId);\r\n      if (!plan) throw new Error('Plan not found');\r\n\r\n      const completionBonus = plan.duration * 2; // 2 points per day as bonus\r\n\r\n      const { data, error } = await supabase\r\n        .from('user_reading_plans')\r\n        .update({\r\n          is_active: false,\r\n          completed_at: new Date().toISOString()\r\n        })\r\n        .eq('user_id', userId)\r\n        .eq('plan_id', planId)\r\n        .select()\r\n        .single();\r\n\r\n      if (error) throw error;\r\n\r\n      // Award completion bonus points\r\n      await this.awardPoints(userId, completionBonus, 'Completed a reading plan');\r\n\r\n      return data;\r\n    } catch (error) {\r\n      console.error('Error completing reading plan:', error);\r\n      throw error;\r\n    }\r\n  }\r\n\r\n  // Award points to user\r\n  private async awardPoints(userId: string, points: number, reason: string): Promise<void> {\r\n    try {\r\n      // Update user points\r\n      const { error: updateError } = await supabase.rpc('increment_user_points', {\r\n        p_user_id: userId,\r\n        p_points: points\r\n      });\r\n\r\n      if (updateError) throw updateError;\r\n\r\n      // Create activity record\r\n      const { error: activityError } = await supabase\r\n        .from('activities')\r\n        .insert([{\r\n          user_id: userId,\r\n          type: 'reading_plan',\r\n          description: reason,\r\n          points: points,\r\n          created_at: new Date().toISOString()\r\n        }]);\r\n\r\n      if (activityError) throw activityError;\r\n    } catch (error) {\r\n      console.error('Error awarding points:', error);\r\n    }\r\n  }\r\n\r\n  // Get reading plan statistics\r\n  async getPlanStats(planId: string): Promise<{\r\n    totalParticipants: number;\r\n    averageCompletion: number;\r\n    totalCompletions: number;\r\n  }> {\r\n    try {\r\n      const { data: userPlans, error } = await supabase\r\n        .from('user_reading_plans')\r\n        .select('is_completed')\r\n        .eq('plan_id', planId);\r\n\r\n      if (error) throw error;\r\n\r\n      const totalParticipants = userPlans?.length || 0;\r\n      const totalCompletions = userPlans?.filter(plan => plan.is_completed).length || 0;\r\n      const averageCompletion = totalParticipants > 0 ? (totalCompletions / totalParticipants) * 100 : 0;\r\n\r\n      return {\r\n        totalParticipants,\r\n        averageCompletion,\r\n        totalCompletions\r\n      };\r\n    } catch (error) {\r\n      console.error('Error fetching plan stats:', error);\r\n      return {\r\n        totalParticipants: 0,\r\n        averageCompletion: 0,\r\n        totalCompletions: 0\r\n      };\r\n    }\r\n  }\r\n\r\n  // Create a new reading plan (for admin users)\r\n  async createReadingPlan(plan: Omit<ReadingPlan, 'id' | 'created_at' | 'updated_at'>): Promise<ReadingPlan> {\r\n    try {\r\n      const { data, error } = await supabase\r\n        .from('reading_plans')\r\n        .insert([plan])\r\n        .select()\r\n        .single();\r\n\r\n      if (error) throw error;\r\n      return data;\r\n    } catch (error) {\r\n      console.error('Error creating reading plan:', error);\r\n      throw error;\r\n    }\r\n  }\r\n}\r\n\r\nexport const readingPlanService = new ReadingPlanService();\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 325, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/UYI/Downloads/Journey/journey/src/app/api/reading-plans/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from 'next/server';\r\nimport { createServerClient } from '@/lib/supabase/server';\r\nimport { readingPlanService } from '@/services/readingPlanService';\r\n\r\nexport async function POST(request: NextRequest) {\r\n  try {\r\n    const supabase = createServerClient();\r\n    const { data: { user }, error: authError } = await supabase.auth.getUser();\r\n\r\n    if (authError || !user) {\r\n      return NextResponse.json(\r\n        { error: 'Unauthorized' },\r\n        { status: 401 }\r\n      );\r\n    }\r\n\r\n    const body = await request.json();\r\n    const { title, description, duration, difficulty, readings, is_public } = body;\r\n\r\n    // Validate required fields\r\n    if (!title || !description || !duration || !difficulty) {\r\n      return NextResponse.json(\r\n        { error: 'Missing required fields: title, description, duration, difficulty' },\r\n        { status: 400 }\r\n      );\r\n    }\r\n\r\n    // Create reading plan using the service\r\n    const readingPlan = await readingPlanService.createReadingPlan({\r\n      title,\r\n      description,\r\n      duration,\r\n      difficulty,\r\n      user_id: user.id,\r\n      is_public: is_public || false\r\n    });\r\n\r\n    return NextResponse.json({\r\n      success: true,\r\n      data: readingPlan\r\n    });\r\n\r\n  } catch (error) {\r\n    console.error('Error creating reading plan:', error);\r\n    return NextResponse.json(\r\n      { \r\n        error: 'Failed to create reading plan',\r\n        details: error instanceof Error ? error.message : 'Unknown error'\r\n      },\r\n      { status: 500 }\r\n    );\r\n  }\r\n}\r\n"],"names":[],"mappings":";;;;AAAA;AACA;AACA;;;;AAEO,eAAe,KAAK,OAAoB;IAC7C,IAAI;QACF,MAAM,WAAW,IAAA,wJAAkB;QACnC,MAAM,EAAE,MAAM,EAAE,IAAI,EAAE,EAAE,OAAO,SAAS,EAAE,GAAG,MAAM,SAAS,IAAI,CAAC,OAAO;QAExE,IAAI,aAAa,CAAC,MAAM;YACtB,OAAO,gJAAY,CAAC,IAAI,CACtB;gBAAE,OAAO;YAAe,GACxB;gBAAE,QAAQ;YAAI;QAElB;QAEA,MAAM,OAAO,MAAM,QAAQ,IAAI;QAC/B,MAAM,EAAE,KAAK,EAAE,WAAW,EAAE,QAAQ,EAAE,UAAU,EAAE,QAAQ,EAAE,SAAS,EAAE,GAAG;QAE1E,2BAA2B;QAC3B,IAAI,CAAC,SAAS,CAAC,eAAe,CAAC,YAAY,CAAC,YAAY;YACtD,OAAO,gJAAY,CAAC,IAAI,CACtB;gBAAE,OAAO;YAAoE,GAC7E;gBAAE,QAAQ;YAAI;QAElB;QAEA,wCAAwC;QACxC,MAAM,cAAc,MAAM,6JAAkB,CAAC,iBAAiB,CAAC;YAC7D;YACA;YACA;YACA;YACA,SAAS,KAAK,EAAE;YAChB,WAAW,aAAa;QAC1B;QAEA,OAAO,gJAAY,CAAC,IAAI,CAAC;YACvB,SAAS;YACT,MAAM;QACR;IAEF,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,gCAAgC;QAC9C,OAAO,gJAAY,CAAC,IAAI,CACtB;YACE,OAAO;YACP,SAAS,iBAAiB,QAAQ,MAAM,OAAO,GAAG;QACpD,GACA;YAAE,QAAQ;QAAI;IAElB;AACF"}}]
}