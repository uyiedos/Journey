(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,39584,e=>{"use strict";var s=e.i(43476),a=e.i(71645),t=e.i(85665),r=e.i(79110),l=e.i(19455),i=e.i(93479),n=e.i(15288),c=e.i(99676),d=e.i(58709),o=e.i(61911),m=e.i(79002),x=e.i(55436),u=e.i(94983),h=e.i(46462),j=e.i(27142);function p(){let{user:e}=(0,h.useAuth)(),[t,r]=(0,a.useState)(""),[p,v]=(0,a.useState)(!1),[f,g]=(0,a.useState)("all"),[N,b]=(0,a.useState)([]),[y,w]=(0,a.useState)([]),[C,S]=(0,a.useState)([]),[k,T]=(0,a.useState)(!1),_=async()=>{if(e)try{let{data:s}=await j.supabaseService.getClient().from("friends").select(`
          *,
          friend:users(id, username, full_name, avatar_url, points, level, streak)
        `).or(`user_id.eq.${e.id},friend_id.eq.${e.id}`).eq("status","accepted"),{data:a}=await j.supabaseService.getClient().from("friends").select(`
          *,
          user:users(id, username, full_name, avatar_url, points, level, streak)
        `).eq("friend_id",e.id).eq("status","pending");b(s||[]),w(a||[])}catch(e){console.error("Error fetching friends:",e)}},A=async s=>{if(!s.trim()||!e)return void S([]);try{T(!0);let{data:a}=await j.supabaseService.getClient().from("users").select("id, username, full_name, avatar_url, points, level, streak").ilike("username",`%${s}%`).neq("id",e.id).limit(10);S(a||[])}catch(e){console.error("Error searching users:",e)}finally{T(!1)}},F=async s=>{if(e)try{let{error:a}=await j.supabaseService.getClient().from("friends").insert({user_id:e.id,friend_id:s,status:"pending"});if(a)throw a;S(e=>e.filter(e=>e.id!==s))}catch(e){console.error("Error sending friend request:",e)}},B=async e=>{try{let{error:s}=await j.supabaseService.getClient().from("friends").update({status:"accepted"}).eq("id",e);if(s)throw s;_()}catch(e){console.error("Error accepting friend request:",e)}};return(0,a.useEffect)(()=>{e&&_()},[e]),(0,a.useEffect)(()=>{let e=setTimeout(()=>{A(t)},300);return()=>clearTimeout(e)},[t]),(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{className:"text-2xl font-bold",children:"Friends"}),(0,s.jsx)("p",{className:"text-muted-foreground",children:"Connect with fellow believers on their spiritual journey"})]}),(0,s.jsx)(d.AuthGuard,{action:"friend",children:(0,s.jsxs)(l.Button,{children:[(0,s.jsx)(m.UserPlus,{className:"mr-2 h-4 w-4"}),"Find Friends"]})})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[(0,s.jsx)(n.Card,{children:(0,s.jsxs)(n.CardContent,{className:"p-4 text-center",children:[(0,s.jsx)("div",{className:"text-2xl font-bold text-blue-500",children:N.length}),(0,s.jsx)("div",{className:"text-sm text-muted-foreground",children:"Total Friends"})]})}),(0,s.jsx)(n.Card,{children:(0,s.jsxs)(n.CardContent,{className:"p-4 text-center",children:[(0,s.jsx)("div",{className:"text-2xl font-bold text-green-500",children:y.length}),(0,s.jsx)("div",{className:"text-sm text-muted-foreground",children:"Friend Requests"})]})}),(0,s.jsx)(n.Card,{children:(0,s.jsxs)(n.CardContent,{className:"p-4 text-center",children:[(0,s.jsx)("div",{className:"text-2xl font-bold text-purple-500",children:"0"}),(0,s.jsx)("div",{className:"text-sm text-muted-foreground",children:"Online Now"})]})})]}),(0,s.jsxs)(n.Card,{children:[(0,s.jsx)(n.CardHeader,{children:(0,s.jsx)(n.CardTitle,{children:"Find Friends"})}),(0,s.jsxs)(n.CardContent,{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)(x.Search,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),(0,s.jsx)(i.Input,{placeholder:"Search for users by username...",value:t,onChange:e=>r(e.target.value),className:"pl-10"})]}),k&&(0,s.jsx)("div",{className:"text-center py-4",children:(0,s.jsx)("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-primary mx-auto"})}),C.length>0&&(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("h4",{className:"font-medium",children:"Search Results"}),C.map(e=>(0,s.jsxs)("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,s.jsxs)(c.Avatar,{className:"h-8 w-8",children:[(0,s.jsx)(c.AvatarImage,{src:e.avatar_url}),(0,s.jsx)(c.AvatarFallback,{children:e.username?.charAt(0)||"U"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"font-medium",children:e.full_name||e.username}),(0,s.jsxs)("div",{className:"text-sm text-muted-foreground",children:["Level ",e.level," • ",e.points," points"]})]})]}),(0,s.jsxs)(l.Button,{size:"sm",onClick:()=>F(e.id),children:[(0,s.jsx)(m.UserPlus,{className:"h-4 w-4 mr-1"}),"Add Friend"]})]},e.id))]})]})]}),y.length>0&&(0,s.jsxs)(n.Card,{children:[(0,s.jsx)(n.CardHeader,{children:(0,s.jsx)(n.CardTitle,{children:"Friend Requests"})}),(0,s.jsx)(n.CardContent,{className:"space-y-2",children:y.map(e=>(0,s.jsxs)("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,s.jsxs)(c.Avatar,{className:"h-8 w-8",children:[(0,s.jsx)(c.AvatarImage,{src:e.user?.avatar_url}),(0,s.jsx)(c.AvatarFallback,{children:e.user?.username?.charAt(0)||"U"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"font-medium",children:e.user?.full_name||e.user?.username}),(0,s.jsxs)("div",{className:"text-sm text-muted-foreground",children:["Level ",e.user?.level," • ",e.user?.points," points"]})]})]}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)(l.Button,{size:"sm",onClick:()=>B(e.id),children:"Accept"}),(0,s.jsx)(l.Button,{size:"sm",variant:"outline",children:"Decline"})]})]},e.id))})]}),N.length>0&&(0,s.jsxs)(n.Card,{children:[(0,s.jsx)(n.CardHeader,{children:(0,s.jsx)(n.CardTitle,{children:"Your Friends"})}),(0,s.jsx)(n.CardContent,{className:"space-y-2",children:N.map(e=>{let a=e.user||e.friend;return(0,s.jsxs)("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,s.jsxs)(c.Avatar,{className:"h-8 w-8",children:[(0,s.jsx)(c.AvatarImage,{src:a?.avatar_url}),(0,s.jsx)(c.AvatarFallback,{children:a?.username?.charAt(0)||"U"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"font-medium",children:a?.full_name||a?.username}),(0,s.jsxs)("div",{className:"text-sm text-muted-foreground",children:["Level ",a?.level," • ",a?.points," points"]})]})]}),(0,s.jsxs)(l.Button,{size:"sm",variant:"outline",children:[(0,s.jsx)(u.MessageCircle,{className:"h-4 w-4 mr-1"}),"Message"]})]},e.id)})})]}),0===N.length&&0===y.length&&0===C.length&&(0,s.jsx)(n.Card,{children:(0,s.jsxs)(n.CardContent,{className:"text-center py-12",children:[(0,s.jsx)(o.Users,{className:"h-12 w-12 mx-auto mb-4 text-muted-foreground"}),(0,s.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"No friends yet"}),(0,s.jsx)("p",{className:"text-muted-foreground",children:"Start searching for users above to build your spiritual community!"})]})})]})}var v=e.i(932),f=e.i(87486),g=e.i(14764),N=e.i(75254);let b=(0,N.default)("phone",[["path",{d:"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384",key:"9njp5v"}]]),y=(0,N.default)("video",[["path",{d:"m16 13 5.223 3.482a.5.5 0 0 0 .777-.416V7.87a.5.5 0 0 0-.752-.432L16 10.5",key:"ftymec"}],["rect",{x:"2",y:"6",width:"14",height:"12",rx:"2",key:"158x01"}]]),w=(0,N.default)("ellipsis-vertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]]);var C=e.i(97960);let S=(0,N.default)("paperclip",[["path",{d:"m16 6-8.414 8.586a2 2 0 0 0 2.829 2.829l8.414-8.586a4 4 0 1 0-5.657-5.657l-8.379 8.551a6 6 0 1 0 8.485 8.485l8.379-8.551",key:"1miecu"}]]);function k(){let e,t,r,n,d,o,m,u=(0,v.c)(9),[h,j]=(0,a.useState)(null),[p,N]=(0,a.useState)(""),[k,_]=(0,a.useState)(""),A=(0,a.useRef)(null),F=[],B=F.filter(e=>e.participantName.toLowerCase().includes(k.toLowerCase())),P=F.find(e=>e.id===h),L=[];u[0]===Symbol.for("react.memo_cache_sentinel")?(e=()=>{A.current?.scrollIntoView({behavior:"smooth"})},u[0]=e):e=u[0];let O=e;u[1]===Symbol.for("react.memo_cache_sentinel")?(t=()=>{O()},u[1]=t):t=u[1],(0,a.useEffect)(t,[L]);let E=T;u[2]!==p?(r=()=>{p.trim()&&(console.log("Sending message:",p),N(""))},u[2]=p,u[3]=r):r=u[3];let I=r;return u[4]===Symbol.for("react.memo_cache_sentinel")?(n=(0,s.jsx)("h3",{className:"font-semibold mb-3",children:"Messages"}),u[4]=n):n=u[4],u[5]===Symbol.for("react.memo_cache_sentinel")?(d=(0,s.jsx)(x.Search,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),u[5]=d):d=u[5],u[6]===Symbol.for("react.memo_cache_sentinel")?(o=e=>_(e.target.value),u[6]=o):o=u[6],u[7]!==k?(m=(0,s.jsxs)("div",{className:"p-4 border-b",children:[n,(0,s.jsxs)("div",{className:"relative",children:[d,(0,s.jsx)(i.Input,{placeholder:"Search conversations...",value:k,onChange:o,className:"pl-10"})]})]}),u[7]=k,u[8]=m):m=u[8],(0,s.jsxs)("div",{className:"flex h-[600px] border rounded-lg overflow-hidden",children:[(0,s.jsxs)("div",{className:"w-80 border-r flex flex-col",children:[m,(0,s.jsx)("div",{className:"flex-1 overflow-y-auto",children:B.map(e=>(0,s.jsx)("div",{onClick:()=>j(e.id),className:`p-4 border-b cursor-pointer hover:bg-muted/50 transition-colors ${h===e.id?"bg-muted":""}`,children:(0,s.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsxs)(c.Avatar,{className:"h-10 w-10",children:[(0,s.jsx)(c.AvatarImage,{src:e.participantAvatar}),(0,s.jsx)(c.AvatarFallback,{children:e.participantName.charAt(0)})]}),e.isOnline&&(0,s.jsx)("div",{className:"absolute -bottom-1 -right-1 w-3 h-3 bg-green-500 rounded-full border-2 border-background"})]}),(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("h4",{className:"font-medium truncate",children:e.participantName}),(0,s.jsx)("span",{className:"text-xs text-muted-foreground",children:E(e.lastMessageTime)})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("p",{className:"text-sm text-muted-foreground truncate",children:e.lastMessage}),e.unreadCount>0&&(0,s.jsx)(f.Badge,{variant:"destructive",className:"ml-2 h-5 w-5 rounded-full p-0 flex items-center justify-center text-xs",children:e.unreadCount})]})]})]})},e.id))})]}),h?(0,s.jsxs)("div",{className:"flex-1 flex flex-col",children:[(0,s.jsxs)("div",{className:"p-4 border-b flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsxs)(c.Avatar,{className:"h-8 w-8",children:[(0,s.jsx)(c.AvatarImage,{src:P?.participantAvatar}),(0,s.jsx)(c.AvatarFallback,{children:P?.participantName.charAt(0)})]}),P?.isOnline&&(0,s.jsx)("div",{className:"absolute -bottom-1 -right-1 w-2 h-2 bg-green-500 rounded-full border-2 border-background"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h4",{className:"font-medium",children:P?.participantName}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:P?.isOnline?"Active now":"Offline"})]})]}),(0,s.jsxs)("div",{className:"flex space-x-2",children:[(0,s.jsx)(l.Button,{variant:"ghost",size:"icon",children:(0,s.jsx)(b,{className:"h-4 w-4"})}),(0,s.jsx)(l.Button,{variant:"ghost",size:"icon",children:(0,s.jsx)(y,{className:"h-4 w-4"})}),(0,s.jsx)(l.Button,{variant:"ghost",size:"icon",children:(0,s.jsx)(w,{className:"h-4 w-4"})})]})]}),(0,s.jsxs)("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[L.map(e=>(0,s.jsx)("div",{className:`flex ${e.isOwn?"justify-end":"justify-start"}`,children:(0,s.jsxs)("div",{className:`flex space-x-2 max-w-[70%] ${e.isOwn?"flex-row-reverse space-x-reverse":""}`,children:[!e.isOwn&&(0,s.jsxs)(c.Avatar,{className:"h-8 w-8",children:[(0,s.jsx)(c.AvatarImage,{src:e.senderAvatar}),(0,s.jsx)(c.AvatarFallback,{children:e.senderName.charAt(0)})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:`rounded-lg px-3 py-2 ${e.isOwn?"bg-primary text-primary-foreground":"bg-muted"}`,children:(0,s.jsx)("p",{className:"text-sm",children:e.content})}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground mt-1 px-1",children:E(e.timestamp)})]})]})},e.id)),(0,s.jsx)("div",{ref:A})]}),(0,s.jsx)("div",{className:"p-4 border-t",children:(0,s.jsxs)("div",{className:"flex space-x-2",children:[(0,s.jsx)(l.Button,{variant:"ghost",size:"icon",children:(0,s.jsx)(S,{className:"h-4 w-4"})}),(0,s.jsxs)("div",{className:"flex-1 relative",children:[(0,s.jsx)(i.Input,{placeholder:"Type a message...",value:p,onChange:e=>N(e.target.value),onKeyPress:e=>"Enter"===e.key&&I(),className:"pr-10"}),(0,s.jsx)(l.Button,{variant:"ghost",size:"icon",className:"absolute right-1 top-1",children:(0,s.jsx)(C.Smile,{className:"h-4 w-4"})})]}),(0,s.jsx)(l.Button,{onClick:I,disabled:!p.trim(),children:(0,s.jsx)(g.Send,{className:"h-4 w-4"})})]})})]}):(0,s.jsx)("div",{className:"flex-1 flex items-center justify-center",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"h-16 w-16 bg-muted rounded-full flex items-center justify-center mx-auto mb-4",children:(0,s.jsx)(g.Send,{className:"h-8 w-8 text-muted-foreground"})}),(0,s.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"Select a conversation"}),(0,s.jsx)("p",{className:"text-muted-foreground",children:"Choose a friend from the list to start chatting"})]})})]})}function T(e){let s=Math.floor((new Date().getTime()-e.getTime())/36e5);return s<1?"just now":s<24?`${s}h ago`:e.toLocaleDateString()}var _=e.i(76639),A=e.i(24687),F=e.i(10204),B=e.i(77572),P=e.i(69908),L=e.i(57223),O=e.i(7233),E=e.i(10980);let I=(0,N.default)("hash",[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]]);var D=e.i(83086),M=e.i(31278);function q({children:e,onPostCreated:t}){let{user:r}=(0,h.useAuth)(),{user:n}=(0,P.useUserData)(),[c,d]=(0,a.useState)(!1),[o,m]=(0,a.useState)(""),[x,u]=(0,a.useState)(""),[p,v]=(0,a.useState)(""),[g,N]=(0,a.useState)([]),[b,y]=(0,a.useState)(""),[w,C]=(0,a.useState)(!1),[S,k]=(0,a.useState)(!1),[T,q]=(0,a.useState)(""),[U,z]=(0,a.useState)("devotional"),R=()=>{b.trim()&&!g.includes(b.trim())&&(N([...g,b.trim()]),y(""))},G=e=>{N(g.filter(s=>s!==e))},V=async()=>{if(T.trim()){k(!0);try{let e="";switch(U){case"devotional":let s=L.aiService.generateDevotional("",T);e=s.main_message+"\n\nApplication: "+s.application+"\n\nPrayer: "+s.prayer,s.verse&&(u(s.verse),v(s.verse_text));break;case"reflection":let a=L.aiService.generateBibleStudy(T);e="Topic: "+a.topic+"\n\nKey Themes:\n"+a.main_themes.join("\n")+"\n\nLife Application: "+a.life_application;break;case"prayer":let t=L.aiService.getPrayerGuidance(T);e="Prayer Focus: "+t.title+"\n\nScripture: "+t.scripture+"\n\nPrayer Points:\n"+t.prayer_points.join("\n")+"\n\nSample Prayer: "+t.sample_prayer}m(e),N([...g,U])}catch(e){console.error("Error generating AI content:",e),alert("Failed to generate content. Please try again.")}finally{k(!1)}}},$=async e=>{if(e.preventDefault(),r&&o.trim()){C(!0);try{let{data:e,error:s}=await j.supabaseService.getClient().from("community_posts").insert({user_id:r.id,content:o.trim(),verse_reference:x.trim()||null,verse_text:p.trim()||null,tags:g.length>0?g:null,likes_count:0,comments_count:0,shares_count:0}).select().single();if(s)throw console.error("Error creating post:",s),s;let a=await j.supabaseService.getUserStats(r.id);await j.supabaseService.updateUserStats(r.id,{community_posts:(a?.community_posts||0)+1}),await j.supabaseService.addPoints(r.id,5),m(""),u(""),v(""),N([]),y(""),d(!1),t?.(),console.log("Post created successfully:",e)}catch(e){console.error("Error creating post:",e)}finally{C(!1)}}};return(0,s.jsxs)(_.Dialog,{open:c,onOpenChange:d,children:[(0,s.jsx)(_.DialogTrigger,{asChild:!0,children:e}),(0,s.jsxs)(_.DialogContent,{className:"sm:max-w-[600px] bg-background border-2 shadow-xl",children:[(0,s.jsx)(_.DialogHeader,{className:"border-b pb-4",children:(0,s.jsxs)(_.DialogTitle,{className:"flex items-center gap-2 text-xl",children:[(0,s.jsx)(O.Plus,{className:"h-5 w-5"}),"Create New Post"]})}),(0,s.jsxs)(B.Tabs,{defaultValue:"manual",className:"w-full",children:[(0,s.jsxs)(B.TabsList,{className:"grid w-full grid-cols-2 bg-muted border-2",children:[(0,s.jsx)(B.TabsTrigger,{value:"manual",className:"data-[state=active]:bg-background data-[state=active]:shadow-sm",children:"Manual"}),(0,s.jsxs)(B.TabsTrigger,{value:"ai",className:"flex items-center gap-2 data-[state=active]:bg-background data-[state=active]:shadow-sm",children:[(0,s.jsx)(D.Sparkles,{className:"h-4 w-4"}),"AI Assist"]})]}),(0,s.jsx)(B.TabsContent,{value:"manual",className:"space-y-4",children:(0,s.jsxs)("form",{onSubmit:$,className:"space-y-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(F.Label,{htmlFor:"content",className:"text-base font-medium",children:"Share your thoughts..."}),(0,s.jsx)(A.Textarea,{id:"content",placeholder:"What's on your mind? Share your spiritual journey, insights, or prayer requests...",value:o,onChange:e=>m(e.target.value),className:"min-h-[100px] border-2 bg-background resize-none focus:ring-2 focus:ring-primary",required:!0})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)(F.Label,{htmlFor:"verse-reference",className:"text-base font-medium",children:[(0,s.jsx)(E.BookOpen,{className:"inline h-4 w-4 mr-1"}),"Verse Reference (Optional)"]}),(0,s.jsx)(i.Input,{id:"verse-reference",placeholder:"e.g., John 3:16",value:x,onChange:e=>u(e.target.value),className:"border-2 bg-background focus:ring-2 focus:ring-primary"})]}),x&&(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(F.Label,{htmlFor:"verse-text",className:"text-base font-medium",children:"Verse Text (Optional)"}),(0,s.jsx)(A.Textarea,{id:"verse-text",placeholder:"Enter the verse text...",value:p,onChange:e=>v(e.target.value),className:"min-h-[60px] border-2 bg-background resize-none focus:ring-2 focus:ring-primary"})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)(F.Label,{htmlFor:"tags",children:[(0,s.jsx)(I,{className:"inline h-4 w-4 mr-1"}),"Tags (Optional)"]}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)(i.Input,{id:"tags",placeholder:"Add a tag...",value:b,onChange:e=>y(e.target.value),onKeyPress:e=>"Enter"===e.key&&(e.preventDefault(),R())}),(0,s.jsx)(l.Button,{type:"button",variant:"outline",onClick:R,children:"Add"})]}),g.length>0&&(0,s.jsx)("div",{className:"flex flex-wrap gap-1 mt-2",children:g.map(e=>(0,s.jsxs)(f.Badge,{variant:"secondary",className:"cursor-pointer",children:["#",e,(0,s.jsx)("button",{type:"button",onClick:()=>G(e),className:"ml-1 text-xs hover:text-destructive",children:"×"})]},e))})]}),(0,s.jsxs)("div",{className:"flex justify-end gap-2 pt-4",children:[(0,s.jsx)(l.Button,{type:"button",variant:"outline",onClick:()=>d(!1),children:"Cancel"}),(0,s.jsx)(l.Button,{type:"submit",disabled:!o.trim()||w,children:w?"Posting...":"Share Post"})]})]})}),(0,s.jsxs)(B.TabsContent,{value:"ai",className:"space-y-4",children:[(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(F.Label,{htmlFor:"ai-type",children:"Content Type"}),(0,s.jsxs)("select",{id:"ai-type",value:U,onChange:e=>z(e.target.value),className:"w-full p-2 border rounded-md bg-background",children:[(0,s.jsx)("option",{value:"devotional",children:"Devotional"}),(0,s.jsx)("option",{value:"reflection",children:"Bible Reflection"}),(0,s.jsx)("option",{value:"prayer",children:"Prayer Guide"})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(F.Label,{htmlFor:"ai-topic",children:"Topic or Theme"}),(0,s.jsx)(i.Input,{id:"ai-topic",placeholder:"e.g., Faith, Prayer, Forgiveness, God's Love...",value:T,onChange:e=>q(e.target.value)})]}),(0,s.jsx)(l.Button,{type:"button",onClick:V,disabled:!T.trim()||S,className:"w-full",children:S?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(M.Loader2,{className:"mr-2 h-4 w-4 animate-spin"}),"Generating..."]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(D.Sparkles,{className:"mr-2 h-4 w-4"}),"Generate Content"]})}),o&&(0,s.jsxs)("div",{className:"border rounded-lg p-4 bg-muted/50",children:[(0,s.jsx)(F.Label,{className:"text-sm font-medium",children:"Generated Content"}),(0,s.jsx)(A.Textarea,{value:o,onChange:e=>m(e.target.value),className:"mt-2 min-h-[150px]",placeholder:"AI-generated content will appear here..."})]})]}),(0,s.jsxs)("form",{onSubmit:$,className:"space-y-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)(F.Label,{htmlFor:"verse-reference-ai",children:[(0,s.jsx)(E.BookOpen,{className:"inline h-4 w-4 mr-1"}),"Verse Reference (Optional)"]}),(0,s.jsx)(i.Input,{id:"verse-reference-ai",placeholder:"e.g., John 3:16",value:x,onChange:e=>u(e.target.value)})]}),x&&(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(F.Label,{htmlFor:"verse-text-ai",children:"Verse Text (Optional)"}),(0,s.jsx)(A.Textarea,{id:"verse-text-ai",placeholder:"Enter the verse text...",value:p,onChange:e=>v(e.target.value),className:"min-h-[60px]"})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)(F.Label,{htmlFor:"tags-ai",children:[(0,s.jsx)(I,{className:"inline h-4 w-4 mr-1"}),"Tags (Optional)"]}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)(i.Input,{id:"tags-ai",placeholder:"Add a tag...",value:b,onChange:e=>y(e.target.value),onKeyPress:e=>"Enter"===e.key&&(e.preventDefault(),R())}),(0,s.jsx)(l.Button,{type:"button",variant:"outline",onClick:R,children:"Add"})]}),g.length>0&&(0,s.jsx)("div",{className:"flex flex-wrap gap-1 mt-2",children:g.map(e=>(0,s.jsxs)(f.Badge,{variant:"secondary",className:"cursor-pointer",children:["#",e,(0,s.jsx)("button",{type:"button",onClick:()=>G(e),className:"ml-1 text-xs hover:text-destructive",children:"×"})]},e))})]}),(0,s.jsxs)("div",{className:"flex justify-end gap-2 pt-4",children:[(0,s.jsx)(l.Button,{type:"button",variant:"outline",onClick:()=>d(!1),children:"Cancel"}),(0,s.jsx)(l.Button,{type:"submit",disabled:!o.trim()||w,children:w?"Posting...":"Share Post"})]})]})]})]})]})]})}var U=e.i(87130),z=e.i(45423);function R(){let{user:e}=(0,h.useAuth)(),[c,m]=(0,a.useState)(""),[u,v]=(0,a.useState)(null),[g,N]=(0,a.useState)([]),[b,y]=(0,a.useState)(!1),[w,C]=(0,a.useState)(!1);(0,a.useEffect)(()=>{C(!0)},[]);let S=async()=>{if(e&&w)try{y(!0);let{data:e,error:s}=await j.supabaseService.getClient().from("community_posts").select(`
          *,
          user:users(id, username, full_name, avatar_url)
        `).order("created_at",{ascending:!1}).limit(50);if(s)return void console.error("Error fetching posts:",s);N(e||[])}catch(e){console.error("Error fetching posts:",e)}finally{y(!1)}};(0,a.useEffect)(()=>{e&&w&&S()},[e,w]);let T=g.filter(e=>e.content.toLowerCase().includes(c.toLowerCase()));return(0,s.jsx)(t.Layout,{children:(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-3xl font-bold",children:"Community"}),(0,s.jsx)("p",{className:"text-muted-foreground",children:"Connect with fellow believers, share insights, and grow together"})]}),(0,s.jsx)(d.AuthGuard,{action:"post",children:(0,s.jsx)(q,{onPostCreated:S,children:(0,s.jsxs)(l.Button,{className:"w-full sm:w-auto",children:[(0,s.jsx)(O.Plus,{className:"mr-2 h-4 w-4"}),"Create Post"]})})})]}),(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4",children:[(0,s.jsxs)("div",{className:"relative flex-1",children:[(0,s.jsx)(x.Search,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),(0,s.jsx)(i.Input,{placeholder:"Search posts...",value:c,onChange:e=>m(e.target.value),className:"pl-10"})]}),(0,s.jsxs)(l.Button,{variant:"outline",children:[(0,s.jsx)(U.Filter,{className:"mr-2 h-4 w-4"}),"Filters"]})]}),(0,s.jsx)("div",{className:"flex flex-wrap gap-2",children:["Recent","Popular","Following","My Posts"].map(e=>(0,s.jsx)(f.Badge,{variant:u===e?"default":"secondary",className:"cursor-pointer",onClick:()=>v(e),children:e},e))}),(0,s.jsxs)(B.Tabs,{defaultValue:"posts",className:"space-y-4",children:[(0,s.jsxs)(B.TabsList,{className:"grid w-full grid-cols-4",children:[(0,s.jsx)(B.TabsTrigger,{value:"posts",children:"Posts"}),(0,s.jsx)(B.TabsTrigger,{value:"friends",children:"Friends"}),(0,s.jsx)(B.TabsTrigger,{value:"messages",children:"Messages"}),(0,s.jsx)(B.TabsTrigger,{value:"notifications",children:"Notifications"})]}),(0,s.jsx)(B.TabsContent,{value:"posts",className:"space-y-4",children:(0,s.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,s.jsx)("div",{className:"lg:col-span-2 space-y-4",children:w?b?(0,s.jsxs)("div",{className:"text-center py-12",children:[(0,s.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto mb-4"}),(0,s.jsx)("p",{className:"text-muted-foreground",children:"Loading posts..."})]}):0===T.length?(0,s.jsxs)("div",{className:"text-center py-12",children:[(0,s.jsx)(o.Users,{className:"h-12 w-12 mx-auto mb-4 text-muted-foreground"}),(0,s.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"No posts yet"}),(0,s.jsx)("p",{className:"text-muted-foreground",children:"Be the first to share your thoughts with the community!"})]}):T.map(e=>(0,s.jsx)("div",{children:(0,s.jsx)(r.CommunityPost,{post:e,authorName:e.user?.full_name||e.user?.username||"Unknown",authorAvatar:e.user?.avatar_url})},e.id)):(0,s.jsxs)("div",{className:"text-center py-12",children:[(0,s.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto mb-4"}),(0,s.jsx)("p",{className:"text-muted-foreground",children:"Loading..."})]})}),(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)(n.Card,{children:[(0,s.jsx)(n.CardHeader,{children:(0,s.jsx)(n.CardTitle,{className:"text-lg",children:"Community Stats"})}),(0,s.jsx)(n.CardContent,{className:"space-y-3",children:(0,s.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("span",{children:"Members"}),(0,s.jsx)("span",{className:"font-medium",children:"1"})]}),(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("span",{children:"Online Now"}),(0,s.jsx)("span",{className:"font-medium",children:"0"})]}),(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("span",{children:"Posts Today"}),(0,s.jsx)("span",{className:"font-medium",children:"0"})]}),(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("span",{children:"Prayers Shared"}),(0,s.jsx)("span",{className:"font-medium",children:"0"})]})]})})]}),(0,s.jsxs)(n.Card,{children:[(0,s.jsx)(n.CardHeader,{children:(0,s.jsx)(n.CardTitle,{className:"text-lg",children:"Trending Topics"})}),(0,s.jsx)(n.CardContent,{className:"space-y-2",children:["#Prayer","#YouthMinistry","#BibleStudy","#Faith","#Community"].map(e=>(0,s.jsxs)("div",{className:"flex items-center justify-between p-2 rounded hover:bg-muted cursor-pointer",children:[(0,s.jsx)("span",{className:"text-sm font-medium",children:e}),(0,s.jsx)(f.Badge,{variant:"secondary",className:"text-xs",children:Math.floor(50*Math.random())+10})]},e))})]})]})]})}),(0,s.jsx)(B.TabsContent,{value:"friends",children:(0,s.jsx)(p,{})}),(0,s.jsx)(B.TabsContent,{value:"messages",children:(0,s.jsx)(k,{})}),(0,s.jsx)(B.TabsContent,{value:"notifications",children:(0,s.jsxs)(n.Card,{children:[(0,s.jsx)(n.CardHeader,{children:(0,s.jsx)(n.CardTitle,{children:"Notifications"})}),(0,s.jsx)(n.CardContent,{children:(0,s.jsxs)("div",{className:"text-center py-12",children:[(0,s.jsx)(z.Bell,{className:"h-12 w-12 mx-auto mb-4 text-muted-foreground"}),(0,s.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"No new notifications"}),(0,s.jsx)("p",{className:"text-muted-foreground",children:"You're all caught up! Check back later for updates."})]})})]})})]})]})})}e.s(["default",()=>R],39584)}]);