module.exports=[41675,a=>{"use strict";let b=(0,a.i(70106).default)("calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);a.s(["Calendar",()=>b],41675)},46872,a=>{"use strict";var b=a.i(72131);function c(a){let c=b.useRef(a);return b.useEffect(()=>{c.current=a}),b.useMemo(()=>(...a)=>c.current?.(...a),[])}a.s(["useCallbackRef",()=>c])},72752,a=>{"use strict";var b=a.i(72131),c=globalThis?.document?b.useLayoutEffect:()=>{};a.s(["useLayoutEffect",()=>c])},35112,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored["react-ssr"].ReactDOM},56704,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/work-async-storage.external.js",()=>require("next/dist/server/app-render/work-async-storage.external.js"))},32319,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/work-unit-async-storage.external.js",()=>require("next/dist/server/app-render/work-unit-async-storage.external.js"))},20635,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/action-async-storage.external.js",()=>require("next/dist/server/app-render/action-async-storage.external.js"))},9270,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored.contexts.AppRouterContext},36313,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored.contexts.HooksClientContext},18341,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored.contexts.ServerInsertedHtml},38783,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored["react-ssr"].ReactServerDOMTurbopackClient},91119,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(68114);let e=c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("div",{ref:e,className:(0,d.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",a),...c}));e.displayName="Card";let f=c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("div",{ref:e,className:(0,d.cn)("flex flex-col space-y-1.5 p-6",a),...c}));f.displayName="CardHeader";let g=c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("h3",{ref:e,className:(0,d.cn)("text-2xl font-semibold leading-none tracking-tight",a),...c}));g.displayName="CardTitle";let h=c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("p",{ref:e,className:(0,d.cn)("text-sm text-muted-foreground",a),...c}));h.displayName="CardDescription";let i=c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("div",{ref:e,className:(0,d.cn)("p-6 pt-0",a),...c}));i.displayName="CardContent",c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("div",{ref:e,className:(0,d.cn)("flex items-center p-6 pt-0",a),...c})).displayName="CardFooter",a.s(["Card",()=>e,"CardContent",()=>i,"CardDescription",()=>h,"CardHeader",()=>f,"CardTitle",()=>g])},30553,a=>{"use strict";var b=a.i(72131);a.i(35112);var c=a.i(11011),d=a.i(87924),e=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"].reduce((a,e)=>{let f=(0,c.createSlot)(`Primitive.${e}`),g=b.forwardRef((a,b)=>{let{asChild:c,...g}=a;return(0,d.jsx)(c?f:e,{...g,ref:b})});return g.displayName=`Primitive.${e}`,{...a,[e]:g}},{});a.s(["Primitive",()=>e])},86304,a=>{"use strict";var b=a.i(87924),c=a.i(187),d=a.i(68114);let e=(0,c.cva)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function f({className:a,variant:c,...f}){return(0,b.jsx)("div",{className:(0,d.cn)(e({variant:c}),a),...f})}a.s(["Badge",()=>f])},75764,(a,b,c)=>{"use strict";var d=a.r(72131);d.useState,d.useEffect,d.useLayoutEffect,d.useDebugValue,c.useSyncExternalStore=void 0!==d.useSyncExternalStore?d.useSyncExternalStore:function(a,b){return b()}},59734,(a,b,c)=>{"use strict";b.exports=a.r(75764)},72233,76472,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(50104),e=a.i(46872),f=a.i(72752),g=a.i(30553),h=a.i(59734);function i(){return()=>{}}var j="Avatar",[k,l]=(0,d.createContextScope)(j),[m,n]=k(j),o=c.forwardRef((a,d)=>{let{__scopeAvatar:e,...f}=a,[h,i]=c.useState("idle");return(0,b.jsx)(m,{scope:e,imageLoadingStatus:h,onImageLoadingStatusChange:i,children:(0,b.jsx)(g.Primitive.span,{...f,ref:d})})});o.displayName=j;var p="AvatarImage",q=c.forwardRef((a,d)=>{let{__scopeAvatar:j,src:k,onLoadingStatusChange:l=()=>{},...m}=a,o=n(p,j),q=function(a,{referrerPolicy:b,crossOrigin:d}){let e=(0,h.useSyncExternalStore)(i,()=>!0,()=>!1),g=c.useRef(null),j=e?(g.current||(g.current=new window.Image),g.current):null,[k,l]=c.useState(()=>t(j,a));return(0,f.useLayoutEffect)(()=>{l(t(j,a))},[j,a]),(0,f.useLayoutEffect)(()=>{let a=a=>()=>{l(a)};if(!j)return;let c=a("loaded"),e=a("error");return j.addEventListener("load",c),j.addEventListener("error",e),b&&(j.referrerPolicy=b),"string"==typeof d&&(j.crossOrigin=d),()=>{j.removeEventListener("load",c),j.removeEventListener("error",e)}},[j,d,b]),k}(k,m),r=(0,e.useCallbackRef)(a=>{l(a),o.onImageLoadingStatusChange(a)});return(0,f.useLayoutEffect)(()=>{"idle"!==q&&r(q)},[q,r]),"loaded"===q?(0,b.jsx)(g.Primitive.img,{...m,ref:d,src:k}):null});q.displayName=p;var r="AvatarFallback",s=c.forwardRef((a,d)=>{let{__scopeAvatar:e,delayMs:f,...h}=a,i=n(r,e),[j,k]=c.useState(void 0===f);return c.useEffect(()=>{if(void 0!==f){let a=window.setTimeout(()=>k(!0),f);return()=>window.clearTimeout(a)}},[f]),j&&"loaded"!==i.imageLoadingStatus?(0,b.jsx)(g.Primitive.span,{...h,ref:d}):null});function t(a,b){return a?b?(a.src!==b&&(a.src=b),a.complete&&a.naturalWidth>0?"loaded":"loading"):"error":"idle"}s.displayName=r;var u=a.i(68114);let v=c.forwardRef(({className:a,...c},d)=>(0,b.jsx)(o,{ref:d,className:(0,u.cn)("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",a),...c}));v.displayName=o.displayName;let w=c.forwardRef(({className:a,...c},d)=>(0,b.jsx)(q,{ref:d,className:(0,u.cn)("aspect-square h-full w-full",a),...c}));w.displayName=q.displayName;let x=c.forwardRef(({className:a,...c},d)=>(0,b.jsx)(s,{ref:d,className:(0,u.cn)("flex h-full w-full items-center justify-center rounded-full bg-muted",a),...c}));x.displayName=s.displayName,a.s(["Avatar",()=>v,"AvatarFallback",()=>x,"AvatarImage",()=>w],72233);let y=(0,a.i(70106).default)("heart",[["path",{d:"M2 9.5a5.5 5.5 0 0 1 9.591-3.676.56.56 0 0 0 .818 0A5.49 5.49 0 0 1 22 9.5c0 2.29-1.5 4-3 5.5l-5.492 5.313a2 2 0 0 1-3 .019L5 15c-1.5-1.5-3-3.2-3-5.5",key:"mvr1a0"}]]);a.s(["Heart",()=>y],76472)},29246,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(68114);let e=c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("textarea",{className:(0,d.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",a),ref:e,...c}));e.displayName="Textarea",a.s(["Textarea",()=>e])},67421,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(76472),e=a.i(45222),f=a.i(53569),g=a.i(92759),h=a.i(99570),i=a.i(29246),j=a.i(72233),k=a.i(43897),l=a.i(86130);class m{static instance;static getInstance(){return m.instance||(m.instance=new m),m.instance}async toggleLike(a,b,c){try{let{data:d}=await l.supabaseService.getClient().from("likes").select("id").eq("user_id",c).eq("target_id",a).eq("target_type",b).maybeSingle();if(d)return await l.supabaseService.getClient().from("likes").delete().eq("user_id",c).eq("target_id",a).eq("target_type",b),await this.updateCount(a,b,"likes_count",-1),{liked:!1,count:await this.getCount(a,b,"likes_count")};return await l.supabaseService.getClient().from("likes").insert({user_id:c,target_id:a,target_type:b}),await this.updateCount(a,b,"likes_count",1),{liked:!0,count:await this.getCount(a,b,"likes_count")}}catch(a){throw console.error("Error toggling like:",a),a}}async hasUserLiked(a,b,c){try{let{data:d}=await l.supabaseService.getClient().from("likes").select("id").eq("user_id",c).eq("target_id",a).eq("target_type",b).maybeSingle();return!!d}catch(a){return console.error("Error checking like status:",a),!1}}async addComment(a,b,c,d){try{let{data:e,error:f}=await l.supabaseService.getClient().from("comments").insert({user_id:c,target_id:a,target_type:b,content:d.trim()}).select(`
          *,
          user:users(id, username, full_name, avatar_url)
        `).single();if(f)throw f;return await this.updateCount(a,b,"comments_count",1),e}catch(a){throw console.error("Error adding comment:",a),a}}async getComments(a,b){try{let{data:c,error:d}=await l.supabaseService.getClient().from("comments").select(`
          *,
          user:users(id, username, full_name, avatar_url)
        `).eq("target_id",a).eq("target_type",b).order("created_at",{ascending:!0});if(d)throw d;return c||[]}catch(a){return console.error("Error fetching comments:",a),[]}}async share(a,b,c){try{return await l.supabaseService.getClient().from("shares").insert({user_id:c,target_id:a,target_type:b}),await this.updateCount(a,b,"shares_count",1),{count:await this.getCount(a,b,"shares_count")}}catch(a){throw console.error("Error recording share:",a),a}}async getCount(a,b,c){try{let d="";switch(b){case"post":d="community_posts";break;case"devotional":d="devotionals";break;case"prayer":d="prayer_requests";break;default:return 0}let{data:e}=await l.supabaseService.getClient().from(d).select(c).eq("id",a).single();return e?.[c]||0}catch(a){return console.error("Error getting count:",a),0}}async updateCount(a,b,c,d){try{let e="";switch(b){case"post":e="community_posts";break;case"devotional":e="devotionals";break;case"prayer":e="prayer_requests";break;default:return}let{error:f}=await l.supabaseService.getClient().rpc("increment_count",{table_name:e,record_id:a,column_name:c,increment_value:d});if(f){let{data:b}=await l.supabaseService.getClient().from(e).select(c).eq("id",a).single();if(b){let f=Math.max(0,(b[c]||0)+d);await l.supabaseService.getClient().from(e).update({[c]:f}).eq("id",a)}}}catch(a){console.error("Error updating count:",a)}}async getUserSocialActivity(a){try{let[b,c,d]=await Promise.all([l.supabaseService.getClient().from("likes").select(`
            *,
            target:community_posts(id, content, created_at)
          `).eq("user_id",a).order("created_at",{ascending:!1}).limit(10),l.supabaseService.getClient().from("comments").select(`
            *,
            target:community_posts(id, content, created_at)
          `).eq("user_id",a).order("created_at",{ascending:!1}).limit(10),l.supabaseService.getClient().from("shares").select(`
            *,
            target:community_posts(id, content, created_at)
          `).eq("user_id",a).order("created_at",{ascending:!1}).limit(10)]);return{likes:b.data||[],comments:c.data||[],shares:d.data||[]}}catch(a){return console.error("Error fetching user social activity:",a),{likes:[],comments:[],shares:[]}}}}let n=m.getInstance();var o=a.i(68114);function p({targetId:a,targetType:l,initialLikes:m=0,initialComments:p=0,initialShares:q=0,showComments:r=!0,className:s=""}){let{user:t}=(0,k.useAuth)(),[u,v]=(0,c.useState)(!1),[w,x]=(0,c.useState)(m),[y,z]=(0,c.useState)(p),[A,B]=(0,c.useState)(q),[C,D]=(0,c.useState)(!1),[E,F]=(0,c.useState)(!1),[G,H]=(0,c.useState)(!1),[I,J]=(0,c.useState)([]),[K,L]=(0,c.useState)(!1),[M,N]=(0,c.useState)(""),[O,P]=(0,c.useState)(!1);(0,c.useEffect)(()=>{v(!0)},[]),(0,c.useEffect)(()=>{t&&u&&n.hasUserLiked(a,l,t.id).then(D)},[a,l,t,u]),(0,c.useEffect)(()=>{K&&r&&u&&Q()},[K,a,l,r,u]);let Q=async()=>{try{let b=await n.getComments(a,l);J(b),z(b.length)}catch(a){console.error("Error loading comments:",a)}},R=async()=>{if(!t||E||!u)return;F(!0);let b=!C,c=b?w+1:Math.max(0,w-1);D(b),x(c);try{let b=await n.toggleLike(a,l,t.id);x(b.count),D(b.liked)}catch(a){console.error("Error toggling like:",a),D(!b),x(w)}finally{F(!1)}},S=async()=>{if(t&&!G&&u){H(!0);try{let b=await n.share(a,l,t.id);B(b.count),navigator.share&&await navigator.share({title:`Check out this ${l}`,text:`Found this amazing ${l} on Journey!`,url:window.location.href})}catch(a){console.error("Error sharing:",a)}finally{H(!1)}}},T=async()=>{if(t&&M.trim()&&!O&&u){P(!0);try{let b=await n.addComment(a,l,t.id,M);J([b,...I]),z(a=>a+1),N("")}catch(a){console.error("Error adding comment:",a)}finally{P(!1)}}};return(0,b.jsxs)("div",{className:`space-y-4 ${s}`,children:[(0,b.jsx)("div",{className:"flex items-center justify-between pt-4 border-t",children:(0,b.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,b.jsxs)(h.Button,{variant:"ghost",size:"sm",className:`text-muted-foreground hover:text-red-500 transition-colors ${C?"text-red-500":""}`,onClick:R,disabled:!t||E,children:[(0,b.jsx)(d.Heart,{className:`h-4 w-4 mr-1 ${C?"fill-current":""}`}),w]}),r&&(0,b.jsxs)(h.Button,{variant:"ghost",size:"sm",className:"text-muted-foreground hover:text-blue-500 transition-colors",onClick:()=>L(!K),children:[(0,b.jsx)(e.MessageCircle,{className:"h-4 w-4 mr-1"}),y]}),(0,b.jsxs)(h.Button,{variant:"ghost",size:"sm",className:"text-muted-foreground hover:text-green-500 transition-colors",onClick:S,disabled:!t||G,children:[(0,b.jsx)(f.Share2,{className:"h-4 w-4 mr-1"}),A]})]})}),r&&K&&(0,b.jsxs)("div",{className:"space-y-4 border-t pt-4",children:[t&&(0,b.jsxs)("div",{className:"flex space-x-3",children:[(0,b.jsxs)(j.Avatar,{className:"h-8 w-8",children:[(0,b.jsx)(j.AvatarImage,{src:t.user_metadata?.avatar_url}),(0,b.jsx)(j.AvatarFallback,{children:t.email?.charAt(0)})]}),(0,b.jsxs)("div",{className:"flex-1 space-y-2",children:[(0,b.jsx)(i.Textarea,{placeholder:"Share your thoughts...",value:M,onChange:a=>N(a.target.value),className:"min-h-[60px] resize-none"}),(0,b.jsx)("div",{className:"flex justify-end",children:(0,b.jsxs)(h.Button,{size:"sm",onClick:T,disabled:!M.trim()||O,children:[(0,b.jsx)(g.Send,{className:"h-4 w-4 mr-1"}),O?"Posting...":"Post"]})})]})]}),(0,b.jsx)("div",{className:"space-y-3",children:0===I.length?(0,b.jsx)("div",{className:"text-center py-4 text-muted-foreground",children:"No comments yet. Be the first to share your thoughts!"}):I.map(a=>(0,b.jsxs)("div",{className:"flex space-x-3",children:[(0,b.jsxs)(j.Avatar,{className:"h-8 w-8",children:[(0,b.jsx)(j.AvatarImage,{src:a.user?.avatar_url}),(0,b.jsx)(j.AvatarFallback,{children:a.user?.full_name?.charAt(0)||a.user?.username?.charAt(0)||"U"})]}),(0,b.jsxs)("div",{className:"flex-1 space-y-1",children:[(0,b.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,b.jsx)("span",{className:"font-medium text-sm",children:a.user?.full_name||a.user?.username||"Anonymous"}),(0,b.jsx)("span",{className:"text-xs text-muted-foreground",children:(0,o.formatTimeAgo)(new Date(a.created_at))})]}),(0,b.jsx)("p",{className:"text-sm text-gray-700",children:a.content})]})]},a.id))})]})]})}a.s(["SocialInteraction",()=>p],67421)}];

//# sourceMappingURL=%5Broot-of-the-server%5D__4f0dada4._.js.map